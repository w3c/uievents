<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>UI Events Algorithms</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in § N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *     -> ins/del.c### for candidate and proposed changes (amendments)
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *   - .correction for "candidate corrections"       (div, aside, details, section)
 *   - .addition   for "candidate additions"         (div, aside, details, section)
 *   - .correction.proposed for "proposed corrections" (div, aside, details, section)
 *   - .addition.proposed   for "proposed additions"   (div, aside, details, section)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Outdated warning for old specs
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/* color variables included separately for reliability */

/******************************************************************************/
/*                                    Body                                    */
/******************************************************************************/

	html {
	}

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;			  /* limit line length to 50em for readability   */
		margin: 0 auto;				/* center text within page                    */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag    */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		color: black;
		color: var(--text);
		background: white top left fixed no-repeat;
		background: var(--bg) top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em; }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border: solid var(--logo-bg);
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		background: var(--logo-bg);
		color: white;
		color: var(--logo-text);
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		background: var(--logo-active-bg);
		border-color: #c00;
		border-color: var(--logo-active-bg);
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small; }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 3;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;

			color: #707070;
			color: var(--tocnav-normal-text);
			background: white;
			background: var(--tocnav-normal-bg);
		}
		#toc-nav > a:hover,
		#toc-nav > a:focus {
			color: black;
			color: var(--tocnav-hover-text);
			background: #f8f8f8;
			background: var(--tocnav-hover-bg);
		}
		#toc-nav > a:active {
			color: #c00;
			color: var(--tocnav-active-text);
			background: white;
			background: var(--tocnav-active-bg);
		}

		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;	/* Inherit the font family. */
		line-height: 1.2;		/* Keep wrapped headings compact */
		hyphens: manual;		/* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		color: var(--heading-text);
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#profile-and-date {
		/* #profile-and-date is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > :not(.head) + hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		color: black;
		color: var(--hr-text);
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	border-left: 0.5em solid #DEF;
	border-left: 0.5em solid var(--algo-border);
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	 padding: .5em;
	 border: thin solid #ddd;
	 border: thin solid var(--algo-border);
	 border-radius: .5em;
	 margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	 margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	 margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	margin-left: -2em;
	}
	dl.switch {
	padding-left: 2em;
	}
	dl.switch > dt {
	text-indent: -1.5em;
	margin-top: 1em;
	}
	dl.switch > dt + dt {
	margin-top: 0;
	}
	dl.switch > dt::before {
	content: '\21AA';
	padding: 0 0.5em 0 0;
	display: inline-block;
	width: 1em;
	text-align: right;
	line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del {
		color: #aa0000;
		color: var(--del-text);
		background: transparent;
		background: var(--del-bg);
		text-decoration: line-through;
	}
	ins {
		color: #006100;
		color: var(--ins-text);
		background: transparent;
		background: var(--ins-bg);
		text-decoration: underline;
	}

	/* for amendments (candidate/proposed changes) */

	.amendment ins, .correction ins, .addition ins,
	ins[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment del, .correction del, .addition del,
	del[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment.proposed ins, .correction.proposed ins, .addition.proposed ins,
	ins[class^=c].proposed {
		text-decoration-style: double;
	}
	.amendment.proposed del, .correction.proposed del, .addition.proposed del,
	del[class^=c].proposed {
		text-decoration-style: double;
	}

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		hyphens: none;
		text-transform: none;
		text-align: left;
		text-align: start;
		font-variant: normal;
		orphans: 3;
		widows: 3;
		page-break-before: avoid;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

	/* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		color: var(--a-normal-text);
		text-decoration: underline #707070;
		text-decoration: underline var(--a-normal-underline);
		text-decoration-skip-ink: none;
	}
	a:visited {
		color: #034575;
		color: var(--a-visited-text);
		text-decoration-color: #bbb;
		text-decoration-color: var(--a-visited-underline);
	}

	/* Indicate interaction with the link */
	a[href]:focus,
	a[href]:hover {
		text-decoration-thickness: 2px;
	}
	a[href]:active {
		color: #c00;
		color: var(--a-active-text);
		text-decoration-color: #c00;
		text-decoration-color: var(--a-active-underline);
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	img, svg {
		/* Intentionally not color-scheme aware. */
		background: white;
	}

	/* For autogen numbers, add
	  .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,	.sidefigure img,	figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
		height: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em;
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em; }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote,
	.amendment, .correction, .addition {
		margin: 1em auto;
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	blockquote > :first-child,
	.note  > p:first-child,
	.issue > p:first-child,
	.amendment > p:first-child,
	.correction > p:first-child,
	.addition > p:first-child {
		margin-top: 0;
	}
	blockquote > :last-child,
	.note  > p:last-child,
	.issue > p:last-child,
	.amendment > p:last-child,
	.correction > p:last-child,
	.addition > p:last-child {
		margin-bottom: 0;
	}


	.issue::before, .issue > .marker,
	.example::before, .example > .marker,
	.note::before, .note > .marker,
	details.note > summary > .marker,
	.amendment::before, .amendment > .marker,
	details.amendment > summary > .marker,
	.addition::before, .addition > .marker,
	addition.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	correction.amendment > summary > .marker
	{
		text-transform: uppercase;
		padding-right: 1em;
	}

	.example::before, .example > .marker {
		display: block;
		padding-right: 0em;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
		border-color: var(--blockquote-border);
		background: transparent;
		background: var(--blockquote-bg);
		color: currentcolor;
		color: var(--blockquote-text);
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #e05252;
		border-color: var(--issue-border);
		background: #fbe9e9;
		background: var(--issue-bg);
		color: black;
		color: var(--issue-text);
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		color: #831616;
		color: var(--issueheading-text);
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	  or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #e0cb52;
		border-color: var(--example-border);
		background: #fcfaee;
		background: var(--example-bg);
		color: black;
		color: var(--example-text);
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #574b0f;
		color: var(--exampleheading-text);
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	  or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52e052;
		border-color: var(--note-border);
		background: #e9fbe9;
		background: var(--note-bg);
		color: black;
		color: var(--note-text);
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary {
		color: hsl(120, 70%, 30%);
		color: var(--noteheading-text);
	}
	/* Add .note::before { content: "Note "; } for autogen label,
	  or use class="marker" to mark up the label in source. */

	details.note[open] > summary {
		border-bottom: 1px silver solid;
		border-bottom: 1px var(--notesummary-underline) solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		border-color: var(--assertion-border);
		background: #EEE;
		background: var(--assertion-bg);
		color: black;
		color: var(--assertion-text);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-color: var(--advisement-border);
		border-style: none solid;
		background: #fec;
		background: var(--advisement-bg);
		color: black;
		color: var(--advisement-text);
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement::before, .advisement > .marker {
		color: #b35f00;
		color: var(--advisementheading-text);
	}

/** Amendment Box *************************************************************/

	.amendment, .correction, .addition {
		border-color: #330099;
		border-color: var(--amendment-border);
		background: #F5F0FF;
		background: var(--amendment-bg);
		color: black;
		color: var(--amendment-text);
	}
	.amendment.proposed, .correction.proposed, .addition.proposed {
		border-style: solid;
		border-block-width: 0.25em;
	}
	.amendment::before, .amendment > .marker,
	details.amendment > summary::before, details.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	details.correction > summary::before, details.correction > summary > .marker,
	.addition::before, .addition > .marker,
	details.addition > summary::before, details.addition > summary > .marker {
		color: #220066;
		color: var(--amendmentheading-text);
	}
	.amendment.proposed::before, .amendment.proposed > .marker,
	details.amendment.proposed > summary::before, details.amendment.proposed > summary > .marker,
	.correction.proposed::before, .correction.proposed > .marker,
	details.correction.proposed > summary::before, details.correction.proposed > summary > .marker,
	.addition.proposed::before, .addition.proposed > .marker,
	details.addition.proposed > summary::before, details.addition.proposed > summary > .marker {
		font-weight: bold;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: hsla(40,100%,50%,0.95);
		background: var(--warning-bg);
		color: black;
		color: var(--warning-text);
		padding: .75em 1em;
		border: red;
		border: var(--warning-border);
		border-style: solid none;
		box-shadow: 0 2px 8px black;
		text-align: center;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 0;
		right: 0;
		bottom: 2em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #def;
		background: var(--def-bg);
		margin: 1.2em 0;
		border-left: 0.5em solid #8ccbf2;
		border-left: 0.5em solid var(--def-border);
		color: black;
		color: var(--def-text);
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
		border-bottom: 1px solid var(--defrow-border);
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def td.footnote {
		padding-top: 0.6em;
	}
	table.def td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		<table class="data"> highlights structural relationships in a table
		when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		Use class="complex data" for particularly complicated tables --
		(This will draw more lines: busier, but clearer.)

		Use class="long" on table cells with paragraph-like contents
		(This will adjust text alignment accordingly.)
		Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-color: var(--datacell-border);
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		border-top: 1px solid var(--datacell-border);
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		border: 1px solid var(--datacell-border);
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
		vertical-align: baseline;
		text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding: 0.1rem 1px 0;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Switch to using border-bottom for underlines */
		text-decoration: none;
		border-bottom: 1px solid;
		/* Reverse color scheme */
		color: black;
		color: var(--toclink-text);
		border-color: #3980b5;
		border-color: var(--toclink-underline);
	}
	.toc a:visited {
		color: black;
		color: var(--toclink-visited-text);
		border-color: #054572;
		border-color: var(--toclink-visited-underline);
	}
	.toc a:focus,
	.toc a:hover {
		background: rgba(75%, 75%, 75%, .25);
		background: var(--a-hover-bg);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
	}
	.toc {
		line-height: 1.1em;
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li			{ font-weight: bold;   }
	.toc > li li		 { font-weight: normal; }
	.toc > li li li	  { font-size:   95%;	}
	.toc > li li li li	{ font-size:   90%;	}
	.toc > li li li li li { font-size:   85%;	}

	/* @supports not (display:grid) { */
		.toc > li			{ margin: 1.5rem 0;	}
		.toc > li li		 { margin: 0.3rem 0;	}
		.toc > li li li	  { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}
		.toc > li li li li .secno { font-size: 85%; }
		.toc > li li li li li .secno { font-size: 100%; }

		.toc li {
			clear: both;
		}

		:not(li) > .toc			 { margin-left:  5rem; }
		.toc .secno				 { margin-left: -5rem; }
		.toc > li li li .secno	  { margin-left: -7rem; }
		.toc > li li li li .secno	{ margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc			 { margin-left:  4rem; }
			.toc .secno				 { margin-left: -4rem; }
			.toc > li li li			 { margin-left:  1rem; }
			.toc > li li li .secno	  { margin-left: -5rem; }
			.toc > li li li li .secno	{ margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
		/* Loosen it on wide screens */
		@media screen and (min-width: 78em) {
			body:not(.toc-inline) :not(li) > .toc			 { margin-left:  4rem; }
			body:not(.toc-inline) .toc .secno				 { margin-left: -4rem; }
			body:not(.toc-inline) .toc > li li li			 { margin-left:  1rem; }
			body:not(.toc-inline) .toc > li li li .secno	  { margin-left: -5rem; }
			body:not(.toc-inline) .toc > li li li li .secno	{ margin-left: -6rem; }
			body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	/* } */

	@supports (display:grid) and (display:contents) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			  comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
			border-bottom: 3px solid transparent;
			margin-bottom: -3px;
		}
		#toc .content:hover,
		#toc .content:focus {
			background: rgba(75%, 75%, 75%, .25);
			background: var(--a-hover-bg);
			border-bottom-color: #054572;
			border-bottom-color: var(--toclink-underline);
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index	  { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li	{ margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em; }
	ul.index dl	{ margin-top: 0; }
	ul.index dt	{ margin: .2em 0 .2em 20px;}
	ul.index dd	{ margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li a + span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
			color: var(--indexinfo-text);
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		color: black;
		color: var(--indextable-hover-text);
		background: #f7f8f9;
		background: var(--indextable-hover-bg);
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/** Outdated warning **********************************************************/

.outdated-spec {
	color: black;
	color: var(--outdatedspec-text);
	background-color: rgba(0,0,0,0.5);
	background-color: var(--outdatedspec-bg);
}

.outdated-warning {
	position: fixed;
	bottom: 50%;
	left: 0;
	right: 0;
	margin: 0 auto;
	width: 50%;
	background: maroon;
	background: var(--outdated-bg);
	color: white;
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	position: absolute;
	top: 0;
	right:0;
	margin: 0;
	border: 0;
	padding: 0.25em 0.5em;
	background: transparent;
	color: white;
	color: var(--outdated-text);
	font:1em sans-serif;
	text-align:center;
}

.outdated-warning span {
	display: block;
}

.outdated-collapsed {
	bottom: 0;
	border-radius: 0;
	width: 100%;
	padding: 0;
}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}

		.outdated-warning {
			position: absolute;
			border-style: solid;
			border-color: red;
		}

		.outdated-warning input {
			display: none;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge {
		/* Magic to create good item positioning:
		  "content column" is 50ems wide at max; less on smaller screens.
		  Extra space (after ToC + content) is empty on the right.

		  1. When item < content column, centers item in column.
		  2. When content < item < available, left-aligns.
		  3. When item > available, fills available + scroll bar.
		*/
		display: grid;
		grid-template-columns: minmax(0, 50em);
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			* http://lea.verou.me/2012/04/background-attachment-local/
			*
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
						top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
						top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version 4416b18d5, updated Tue Jan 2 15:52:39 2024 -0800" name="generator">
  <meta content="f36ff37adac5bbbfa7bcd8b1b097dad5479cef2f" name="revision">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-idl-highlighting */
pre.idl.highlight {
    background: var(--borderedblock-bg, var(--def-bg));
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-var-click-highlighting */
/*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)
*/
[data-algorithm] var { cursor: pointer; }
var[data-var-color="0"] { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
var[data-var-color="1"] { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
var[data-var-color="2"] { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
var[data-var-color="3"] { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
var[data-var-color="4"] { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
var[data-var-color="5"] { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
var[data-var-color="6"] { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1>UI Events Algorithms</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="profile-and-date"><span class="content">A Collection of Interesting Ideas, <time class="dt-updated" datetime="2024-02-02">2 February 2024</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/w3c/uievents/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:garykac@google.com">Gary Kacmarcik</a> (<span class="p-org org">Google</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://creativecommons.org/publicdomain/zero/1.0/" rel="license"><img alt="CC0" height="15" src="https://licensebuttons.net/p/zero/1.0/80x15.png" width="80"></a> To the extent possible under law, the editors have waived all copyright
and related or neighboring rights to this work.
In addition, as of 2 February 2024,
the editors have made this specification available under the <a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0" rel="license">Open Web Foundation Agreement Version 1.0</a>,
which is available at http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.
Parts of this work may be from another specification document.  If so, those parts are instead covered by the license of that specification document. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This document attempts to describe, in an algorithmic manner, how UIEvents
should be handled by User Agents. Because this functionality has been shipping
in UAs for many years, the primary goal is to document the existing behaviors
and identify areas where implementations disagree. The intent is to fold this
information into the main UIEvents spec (and other specs) once there is
consensus that this process described here is adequate.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Why?</span></a>
    <li>
     <a href="#native-os"><span class="secno">2</span> <span class="content">Native OS Requirements</span></a>
     <ol class="toc">
      <li><a href="#req-mouse"><span class="secno">2.1</span> <span class="content">MouseEvent Requirements</span></a>
      <li><a href="#req-touch"><span class="secno">2.2</span> <span class="content">PointerEvent Requirements</span></a>
      <li><a href="#req-keyboard"><span class="secno">2.3</span> <span class="content">KeyboardEvent Requirements</span></a>
      <li><a href="#req-ime"><span class="secno">2.4</span> <span class="content">IME Requirements</span></a>
      <li>
       <a href="#native-entry-points"><span class="secno">2.5</span> <span class="content">Native Entry Points</span></a>
       <ol class="toc">
        <li><a href="#native-mouse"><span class="secno">2.5.1</span> <span class="content">Mouse</span></a>
        <li><a href="#native-touch"><span class="secno">2.5.2</span> <span class="content">Touch</span></a>
        <li><a href="#native-keyboard"><span class="secno">2.5.3</span> <span class="content">Keyboard</span></a>
        <li><a href="#native-clipboard"><span class="secno">2.5.4</span> <span class="content">Clipboard</span></a>
       </ol>
     </ol>
    <li>
     <a href="#event"><span class="secno">3</span> <span class="content">Event</span></a>
     <ol class="toc">
      <li><a href="#event-interface"><span class="secno">3.1</span> <span class="content">Event Interface</span></a>
      <li><a href="#initialize an event"><span class="secno">3.2</span> <span class="content"><span>initialize an Event</span></span></a>
     </ol>
    <li>
     <a href="#ui event"><span class="secno">4</span> <span class="content">UI Event</span></a>
     <ol class="toc">
      <li><a href="#uievent-interface"><span class="secno">4.1</span> <span class="content">UIEvent Interface</span></a>
      <li><a href="#initialize a uievent"><span class="secno">4.2</span> <span class="content"><span>initialize a UIEvent</span></span></a>
     </ol>
    <li><a href="#focus event"><span class="secno">5</span> <span class="content">Focus Event</span></a>
    <li>
     <a href="#mouse event"><span class="secno">6</span> <span class="content">Mouse Event</span></a>
     <ol class="toc">
      <li><a href="#mouseevent-interface"><span class="secno">6.1</span> <span class="content">MouseEvent Interface</span></a>
      <li>
       <a href="#mouseevent-global-state"><span class="secno">6.2</span> <span class="content">Global State for MouseEvent</span></a>
       <ol class="toc">
        <li><a href="#mouseevent-global-ua"><span class="secno">6.2.1</span> <span class="content">User Agent-Level State</span></a>
        <li><a href="#mouseevent-global-window"><span class="secno">6.2.2</span> <span class="content">Window-Level State</span></a>
       </ol>
      <li><a href="#initialize a mouseevent"><span class="secno">6.3</span> <span class="content"><span>initialize a MouseEvent</span></span></a>
      <li><a href="#create a mouseevent"><span class="secno">6.4</span> <span class="content"><span>create a MouseEvent</span></span></a>
      <li><a href="#calculate mouseevent button attribute"><span class="secno">6.5</span> <span class="content"><span>calculate MouseEvent button attribute</span></span></a>
      <li><a href="#set mouseevent attributes from native"><span class="secno">6.6</span> <span class="content"><span>set MouseEvent attributes from native</span></span></a>
      <li><a href="#handle native mouse down"><span class="secno">6.7</span> <span class="content"><span>handle native mouse down</span></span></a>
      <li><a href="#handle native mouse up"><span class="secno">6.8</span> <span class="content"><span>handle native mouse up</span></span></a>
      <li><a href="#handle native mouse click"><span class="secno">6.9</span> <span class="content"><span>handle native mouse click</span></span></a>
      <li><a href="#send click event"><span class="secno">6.10</span> <span class="content"><span>send click event</span></span></a>
      <li><a href="#handle native mouse double click"><span class="secno">6.11</span> <span class="content"><span>handle native mouse double click</span></span></a>
      <li><a href="#handle native mouse move"><span class="secno">6.12</span> <span class="content"><span>handle native mouse move</span></span></a>
      <li><a href="#maybe show context menu"><span class="secno">6.13</span> <span class="content"><span>maybe show context menu</span></span></a>
     </ol>
    <li><a href="#wheel event"><span class="secno">7</span> <span class="content">Wheel Event</span></a>
    <li>
     <a href="#input event"><span class="secno">8</span> <span class="content">Input Event</span></a>
     <ol class="toc">
      <li><a href="#initialize an Inputevent"><span class="secno">8.1</span> <span class="content"><span>initialize an InputEvent</span></span></a>
      <li><a href="#create an inputevent"><span class="secno">8.2</span> <span class="content"><span>create an InputEvent</span></span></a>
      <li><a href="#fire key input events"><span class="secno">8.3</span> <span class="content"><span>fire key input events</span></span></a>
      <li><a href="#fire an inputevent"><span class="secno">8.4</span> <span class="content"><span>fire an InputEvent</span></span></a>
     </ol>
    <li>
     <a href="#textevent"><span class="secno">9</span> <span class="content">Text Event</span></a>
     <ol class="toc">
      <li><a href="#textevent-interface"><span class="secno">9.1</span> <span class="content">TextEvent Interface</span></a>
      <li><a href="#initialize-a-textevent"><span class="secno">9.2</span> <span class="content"><span>initialize a TextEvent</span></span></a>
      <li><a href="#create-a-textevent"><span class="secno">9.3</span> <span class="content"><span>create a TextEvent</span></span></a>
      <li><a href="#fire-a-textevent"><span class="secno">9.4</span> <span class="content"><span>fire a TextEvent</span></span></a>
     </ol>
    <li>
     <a href="#keyboard event"><span class="secno">10</span> <span class="content">Keyboard Event</span></a>
     <ol class="toc">
      <li><a href="#keyboardevent-interface"><span class="secno">10.1</span> <span class="content">KeyboardEvent Interface</span></a>
      <li>
       <a href="#keyboardevent-global-state"><span class="secno">10.2</span> <span class="content">Global State for KeyboardEvent</span></a>
       <ol class="toc">
        <li><a href="#keyboardevent-global-ua"><span class="secno">10.2.1</span> <span class="content">User Agent-Level State</span></a>
        <li><a href="#keyboardevent-global-window"><span class="secno">10.2.2</span> <span class="content">Window-Level State</span></a>
       </ol>
      <li><a href="#initialize a keyboardevent"><span class="secno">10.3</span> <span class="content"><span>initialize a KeyboardEvent</span></span></a>
      <li><a href="#create a keyboardevent"><span class="secno">10.4</span> <span class="content"><span>create a KeyboardEvent</span></span></a>
      <li><a href="#set event modifiers"><span class="secno">10.5</span> <span class="content"><span>set event modifiers</span></span></a>
      <li><a href="#set keyboardevent attributes"><span class="secno">10.6</span> <span class="content"><span>set KeyboardEvent attributes</span></span></a>
      <li><a href="#calculate key locationinitialize a keyboardevent"><span class="secno">10.7</span> <span class="content"><span>calculate key location</span></span></a>
      <li><a href="#get modifier state"><span class="secno">10.8</span> <span class="content"><span>get modifier state</span></span></a>
      <li><a href="#handle pre browser key"><span class="secno">10.9</span> <span class="content"><span>handle pre browser key</span></span></a>
      <li><a href="#handle post browser key"><span class="secno">10.10</span> <span class="content"><span>handle post browser key</span></span></a>
      <li><a href="#handle native key down"><span class="secno">10.11</span> <span class="content"><span>handle native key down</span></span></a>
      <li><a href="#handle native key up"><span class="secno">10.12</span> <span class="content"><span>handle native key up</span></span></a>
      <li><a href="#handle native key press"><span class="secno">10.13</span> <span class="content"><span>handle native key press</span></span></a>
     </ol>
    <li>
     <a href="#composition event"><span class="secno">11</span> <span class="content">Composition Event</span></a>
     <ol class="toc">
      <li>
       <a href="#compositionevent-global-state"><span class="secno">11.1</span> <span class="content">Global State for CompositionEvent</span></a>
       <ol class="toc">
        <li><a href="#compositionevent-global-window"><span class="secno">11.1.1</span> <span class="content">Window-Level State</span></a>
       </ol>
      <li><a href="#initialize a compositionevent"><span class="secno">11.2</span> <span class="content"><span>initialize a CompositionEvent</span></span></a>
      <li><a href="#create a compositionevent"><span class="secno">11.3</span> <span class="content"><span>create a CompositionEvent</span></span></a>
      <li><a href="#fire a compositionevent"><span class="secno">11.4</span> <span class="content"><span>fire a CompositionEvent</span></span></a>
      <li><a href="#enter composition mode"><span class="secno">11.5</span> <span class="content"><span>enter composition mode</span></span></a>
      <li><a href="#exit composition mode"><span class="secno">11.6</span> <span class="content"><span>exit composition mode</span></span></a>
      <li><a href="#handle composition key"><span class="secno">11.7</span> <span class="content"><span>handle composition key</span></span></a>
      <li><a href="#begin composition"><span class="secno">11.8</span> <span class="content"><span>begin composition</span></span></a>
      <li><a href="#end composition"><span class="secno">11.9</span> <span class="content"><span>end composition</span></span></a>
     </ol>
    <li>
     <a href="#pointer event"><span class="secno">12</span> <span class="content">Pointer Event</span></a>
     <ol class="toc">
      <li><a href="#initialize a pointerevent"><span class="secno">12.1</span> <span class="content"><span>initialize a PointerEvent</span></span></a>
      <li><a href="#create a pointerevent"><span class="secno">12.2</span> <span class="content"><span>create a PointerEvent</span></span></a>
      <li><a href="#create pointerevent from mouseevent"><span class="secno">12.3</span> <span class="content"><span>create PointerEvent from MouseEvent</span></span></a>
      <li><a href="#maybe send pointerout event"><span class="secno">12.4</span> <span class="content"><span>maybe send pointerout event</span></span></a>
      <li><a href="#maybe send pointerleave event"><span class="secno">12.5</span> <span class="content"><span>maybe send pointerleave event</span></span></a>
      <li><a href="#maybe send pointerover event"><span class="secno">12.6</span> <span class="content"><span>maybe send pointerover event</span></span></a>
      <li><a href="#maybe send pointerenter event"><span class="secno">12.7</span> <span class="content"><span>maybe send pointerenter event</span></span></a>
      <li><a href="#maybe send pointermove event"><span class="secno">12.8</span> <span class="content"><span>maybe send pointermove event</span></span></a>
      <li><a href="#maybe send pointerdown event"><span class="secno">12.9</span> <span class="content"><span>maybe send pointerdown event</span></span></a>
      <li><a href="#maybe send pointerup event"><span class="secno">12.10</span> <span class="content"><span>maybe send pointerup event</span></span></a>
     </ol>
    <li>
     <a href="#pointer lock"><span class="secno">13</span> <span class="content">Pointer Lock</span></a>
     <ol class="toc">
      <li><a href="#pointerlock-interface"><span class="secno">13.1</span> <span class="content">MouseEvent Interface Extension</span></a>
      <li>
       <a href="#pointer-lock-global-state"><span class="secno">13.2</span> <span class="content">Global State for PointerLock</span></a>
       <ol class="toc">
        <li><a href="#pointer-lock-global-window"><span class="secno">13.2.1</span> <span class="content">Window-Level State</span></a>
       </ol>
      <li><a href="#initialize pointerlock attributes for mouseevent"><span class="secno">13.3</span> <span class="content"><span>initialize PointerLock attributes for MouseEvent</span></span></a>
      <li><a href="#set pointerlock attributes for mousemove"><span class="secno">13.4</span> <span class="content"><span>set PointerLock attributes for mousemove</span></span></a>
     </ol>
    <li>
     <a href="#keyboard lock"><span class="secno">14</span> <span class="content">Keyboard Lock</span></a>
     <ol class="toc">
      <li>
       <a href="#keyboard-lock-global-state"><span class="secno">14.1</span> <span class="content">Global State for Keyboard Lock</span></a>
       <ol class="toc">
        <li><a href="#keyboard-lock-global-ua"><span class="secno">14.1.1</span> <span class="content">User Agent-Level State</span></a>
        <li><a href="#keyboard-lock-global-window"><span class="secno">14.1.2</span> <span class="content">Window-Level State</span></a>
       </ol>
      <li><a href="#keyboard lock is enabled"><span class="secno">14.2</span> <span class="content"><span>Keyboard Lock is enabled</span></span></a>
     </ol>
    <li>
     <a href="#core dom"><span class="secno">15</span> <span class="content">Core DOM</span></a>
     <ol class="toc">
      <li><a href="#hit test"><span class="secno">15.1</span> <span class="content"><span>hit test</span></span></a>
      <li><a href="#calculate dom path"><span class="secno">15.2</span> <span class="content"><span>calculate DOM path</span></span></a>
     </ol>
    <li>
     <a href="#cssom"><span class="secno">16</span> <span class="content">CSSOM</span></a>
     <ol class="toc">
      <li><a href="#initialize cssom attributes for mouseevent"><span class="secno">16.1</span> <span class="content"><span>initialize CSSOM attributes for MouseEvent</span></span></a>
     </ol>
    <li>
     <a href="#clipboard"><span class="secno">17</span> <span class="content">Clipboard</span></a>
     <ol class="toc">
      <li><a href="#handle native cut"><span class="secno">17.1</span> <span class="content"><span>handle native cut</span></span></a>
      <li><a href="#handle native copy"><span class="secno">17.2</span> <span class="content"><span>handle native copy</span></span></a>
      <li><a href="#handle native paste"><span class="secno">17.3</span> <span class="content"><span>handle native paste</span></span></a>
     </ol>
    <li><a href="#acknowledgementsclipboard"><span class="secno">18</span> <span class="content">Acknowledgements</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Why?</span><a class="self-link" href="#intro"></a></h2>
    <p>The description of events in the current UIEvents spec is woefully underspecified.
This has led to different User Agents (UAs) implementing the same feature with
different behaviors.</p>
    <p>The intent with this document is to:</p>
    <ul>
     <li data-md>
      <p>Describe the current behaviors that are shared by existing UAs</p>
     <li data-md>
      <p>Identify behaviors where they differ</p>
     <li data-md>
      <p>Initiate discussions to resolve the differences</p>
    </ul>
    <p>Part of this process will necessarily require that we describe processes that
rightfully belong in other specifications (e.g., Pointer Events or Input Events).
The intent is to eventually move those portions into their appropriate home,
but they are kept here while drafting this document to make it easier to discuss.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="native-os"><span class="secno">2. </span><span class="content">Native OS Requirements</span><a class="self-link" href="#native-os"></a></h2>
    <p>The following is the set of assumptions that this specification makes about the
underlying native operating system. It is expected that the native OS will
provide these basic services for the UA.</p>
    <p>In the event that the native OS does not provide these services, then the
UA will need to implement them.</p>
    <h3 class="heading settled" data-level="2.1" id="req-mouse"><span class="secno">2.1. </span><span class="content">MouseEvent Requirements</span><a class="self-link" href="#req-mouse"></a></h3>
    <p>The native OS platform will provide:</p>
    <ul>
     <li data-md>
      <p>An event when the mouse is moved</p>
     <li data-md>
      <p>An event when a mouse button is pressed</p>
     <li data-md>
      <p>An event when a mouse button is released</p>
     <li data-md>
      <p>A way to identify when a mouse button press should be interpreted as a "click"</p>
      <ul>
       <li data-md>
        <p>For example, as a flag or as a separate event</p>
       <li data-md>
        <p>If a separate "click" event is fired, then the native OS will fire it
immediately after the corresponding "mouse up" event, with no
intervening mouse-related events</p>
      </ul>
     <li data-md>
      <p>A way to identify when a mouse click is a "double click"</p>
    </ul>
    <p>For these events, the OS will be able to provide the following info:</p>
    <ul>
     <li data-md>
      <p>The x,y mouse coordinates relative to the native OS desktop</p>
     <li data-md>
      <p>The x,y mouse coordinates relative to the UA’s window viewport</p>
     <li data-md>
      <p>Which keyboard modifiers are currently being held</p>
    </ul>
    <h3 class="heading settled" data-level="2.2" id="req-touch"><span class="secno">2.2. </span><span class="content">PointerEvent Requirements</span><a class="self-link" href="#req-touch"></a></h3>
    <p>TODO: Specify native requirements here.</p>
    <h3 class="heading settled" data-level="2.3" id="req-keyboard"><span class="secno">2.3. </span><span class="content">KeyboardEvent Requirements</span><a class="self-link" href="#req-keyboard"></a></h3>
    <p>The native OS platform will provide:</p>
    <ul>
     <li data-md>
      <p>An event when a key is pressed</p>
      <p class="note" role="note"><span class="marker">Note:</span> On Windows: WM_KEYDOWN, WM_SYSKEYDOWN</p>
      <p class="note" role="note"><span class="marker">Note:</span> On macOS: NSKeyDown, NSFlagsChanged (for modifiers without other keys)</p>
     <li data-md>
      <p>An event when a key is released</p>
      <p class="note" role="note"><span class="marker">Note:</span> On Windows: WM_KEYUP, WM_SYSKEYUP</p>
      <p class="note" role="note"><span class="marker">Note:</span> On macOS: NSKeyUp, NSFlagsChanged (for modifiers without other keys)</p>
     <li data-md>
      <p>An event when a character should be generated as a result of a keypress</p>
      <ul>
       <li data-md>
        <p>This may be a separate event, or it may be combined with the keydown event</p>
        <ul>
         <li data-md>
          <p>If a separate event, then there are no intervening key events between keydown and char</p>
        </ul>
      </ul>
      <p class="note" role="note"><span class="marker">Note:</span> On Windows: WM_CHAR, WM_SYSCHAR</p>
      <p class="note" role="note"><span class="marker">Note:</span> On macOS: Combined with keydown</p>
     <li data-md>
      <p>An event when text should be inserted</p>
      <ul>
       <li data-md>
        <p>These are commonly used for alternate input devices like chordal keyboards or speech input</p>
       <li data-md>
        <p>This may be the same event as for when a key is pressed</p>
      </ul>
      <p class="note" role="note"><span class="marker">Note:</span> On Windows: WM_CHAR (without associated keydown/keyup)
Note: On macOS: NSTextInputClient with insertText</p>
     <li data-md>
      <p>A way to identify key events that are "repeat"s from the key being held down</p>
      <ul>
       <li data-md>
        <p>The platform will maintain a key repeat threshold</p>
      </ul>
     <li data-md>
      <p>A way to identify the modifier keys that are held in combination with a key press</p>
      <ul>
       <li data-md>
        <p>Either via flags in the messages, or via a separate call</p>
      </ul>
      <p class="note" role="note"><span class="marker">Note:</span> On Windows: included with WM_ messages</p>
      <p class="note" role="note"><span class="marker">Note:</span> On macOS: included with NSKey messages and NSFlagChanged</p>
      <p class="note" role="note"><span class="marker">Note:</span> On Linux (GTK): not provided with messages. need to request separately</p>
    </ul>
    <h3 class="heading settled" data-level="2.4" id="req-ime"><span class="secno">2.4. </span><span class="content">IME Requirements</span><a class="self-link" href="#req-ime"></a></h3>
    <p class="issue" id="issue-39f24517"><a class="self-link" href="#issue-39f24517"></a> IMEs differ wildly on different platforms, and often have different capabilities
(such as whether or not they can be "canceled") even on the same platform.
What is the common set of requirements that we can rely on?</p>
    <p class="issue" id="issue-dba77cfe"><a class="self-link" href="#issue-dba77cfe"></a> For example, on Windows, Win+'.' opens an emoji window that will generate
composition events. But there is not indication from the OS that composition
is about to take place. A similar problem exists with "shape writing" using the
virtual keyboard.</p>
    <h3 class="heading settled" data-level="2.5" id="native-entry-points"><span class="secno">2.5. </span><span class="content">Native Entry Points</span><a class="self-link" href="#native-entry-points"></a></h3>
    <h4 class="heading settled" data-level="2.5.1" id="native-mouse"><span class="secno">2.5.1. </span><span class="content">Mouse</span><a class="self-link" href="#native-mouse"></a></h4>
    <ul>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-native-mouse-down" id="ref-for-handle-native-mouse-down">handle native mouse down</a></p>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-native-mouse-up" id="ref-for-handle-native-mouse-up">handle native mouse up</a></p>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-native-mouse-click" id="ref-for-handle-native-mouse-click">handle native mouse click</a></p>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-native-mouse-double-click" id="ref-for-handle-native-mouse-double-click">handle native mouse double click</a></p>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-native-mouse-move" id="ref-for-handle-native-mouse-move">handle native mouse move</a></p>
    </ul>
    <h4 class="heading settled" data-level="2.5.2" id="native-touch"><span class="secno">2.5.2. </span><span class="content">Touch</span><a class="self-link" href="#native-touch"></a></h4>
    <p>TODO: Include native touch events and resolve with native mouse events. How do these two
event types interact on the common platforms? When are mouse events generated from
touch events?</p>
    <h4 class="heading settled" data-level="2.5.3" id="native-keyboard"><span class="secno">2.5.3. </span><span class="content">Keyboard</span><a class="self-link" href="#native-keyboard"></a></h4>
    <ul>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-native-key-down" id="ref-for-handle-native-key-down">handle native key down</a></p>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-native-key-press" id="ref-for-handle-native-key-press">handle native key press</a></p>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-native-key-up" id="ref-for-handle-native-key-up">handle native key up</a></p>
    </ul>
    <h4 class="heading settled" data-level="2.5.4" id="native-clipboard"><span class="secno">2.5.4. </span><span class="content">Clipboard</span><a class="self-link" href="#native-clipboard"></a></h4>
    <ul>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-native-cut" id="ref-for-handle-native-cut">handle native cut</a></p>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-native-copy" id="ref-for-handle-native-copy">handle native copy</a></p>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-native-paste" id="ref-for-handle-native-paste">handle native paste</a></p>
    </ul>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="event"><span class="secno">3. </span><span class="content">Event</span><a class="self-link" href="#event"></a></h2>
    <p class="issue" id="issue-a52634a8"><a class="self-link" href="#issue-a52634a8"></a> Move to/merge with <a data-link-type="biblio" href="#biblio-dom" title="DOM Standard">[DOM]</a> spec <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event">Event</a></code> interface.</p>
    <h3 class="heading settled" data-level="3.1" id="event-interface"><span class="secno">3.1. </span><span class="content">Event Interface</span><a class="self-link" href="#event-interface"></a></h3>
    <p>A <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event①">Event</a></code> has the following additional internal state:</p>
    <dl>
     <li>
      <dfn class="dfn-paneled" data-dfn-for="UIEvent" data-dfn-type="dfn" data-noexport id="uievent-due-to-user-interaction-flag">due to user interaction flag</dfn> 
      <p class="issue" id="issue-8b668288"><a class="self-link" href="#issue-8b668288"></a> This is a proposal.
    See <a href="https://github.com/w3c/uievents/issues/270">uievents/270</a></p>
    </dl>
    <div class="algorithm" data-algorithm="initialize-an-event">
     <h3 class="heading settled" data-level="3.2" id="initialize an event"><span class="secno">3.2. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="initialize-an-event">initialize an Event</dfn></span><a class="self-link" href="#initialize%20an%20event"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event②">Event</a></code> to initialize</p>
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p>For reference, see <a href="https://dom.spec.whatwg.org/#concept-event-initialize">initialize an event</a>, <a href="https://dom.spec.whatwg.org/#stop-propagation-flag" id="71fe70a20">list of event flags</a>.</p>
     <ol>
      <li data-md>
       <p>Initialize the following public attributes</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type" id="ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type">type</a></code> = <var>eventType</var></p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-target" id="ref-for-dom-event-target">target</a></code> = <var>eventTarget</var></p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-currenttarget" id="ref-for-dom-event-currenttarget">currentTarget</a></code> = null (This will be set appropriately during dispatch)</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-eventphase" id="ref-for-dom-event-eventphase">eventPhase</a></code> = <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-none" id="ref-for-dom-event-none">NONE</a></code> (This will be set appropriately during dispatch)</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles" id="ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles">bubbles</a></code> = true</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable" id="ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable">cancelable</a></code> = true</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-defaultprevented" id="ref-for-dom-event-defaultprevented">defaultPrevented</a></code> = false</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-composed" id="ref-for-dom-event-composed">composed</a></code> = false  // See COMPAT note for mouseenter and mouseleave</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-istrusted" id="ref-for-dom-event-istrusted">isTrusted</a></code> = false</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-timestamp" id="ref-for-dom-event-timestamp">timeStamp</a></code> = Number of milliseconds relative to the time origin</p>
       </ol>
      <li data-md>
       <p>Initialize the following historical attributes</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>.srcElement = <var>eventTarget</var></p>
        <li data-md>
         <p>Set <var>event</var>.cancelBubble = alias for stopPropagation</p>
        <li data-md>
         <p>Set <var>event</var>.returnValue = alias for !canceled_flag</p>
       </ol>
      <li data-md>
       <p>Initialize the following internal state</p>
       <ol>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#stop-propagation-flag" id="ref-for-stop-propagation-flag">stop propagation flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#stop-immediate-propagation-flag" id="ref-for-stop-immediate-propagation-flag">stop immediate propagation flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#canceled-flag" id="ref-for-canceled-flag">canceled flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#in-passive-listener-flag" id="ref-for-in-passive-listener-flag">in passive listener flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#composed-flag" id="ref-for-composed-flag">composed flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#initialized-flag" id="ref-for-initialized-flag">initialized flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#dispatch-flag" id="ref-for-dispatch-flag">dispatch flag</a></p>
       </ol>
      <li data-md>
       <p>Initialize the following proposed internal state</p>
       <ol>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="#uievent-due-to-user-interaction-flag" id="ref-for-uievent-due-to-user-interaction-flag">due to user interaction flag</a></p>
       </ol>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="ui event"><span class="secno">4. </span><span class="content">UI Event</span><a class="self-link" href="#ui%20event"></a></h2>
    <h3 class="heading settled" data-level="4.1" id="uievent-interface"><span class="secno">4.1. </span><span class="content">UIEvent Interface</span><a class="self-link" href="#uievent-interface"></a></h3>
    <p>A <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#uievent" id="ref-for-uievent">UIEvent</a></code> has the following:</p>
    <dl>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="UIEvent" data-dfn-type="attribute" data-export id="dom-uievent-view"><code>view</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="UIEvent" data-dfn-type="attribute" data-export id="dom-uievent-detail"><code>detail</code></dfn>
    </dl>
    <p>Along with the following historical attribute:</p>
    <dl>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-which"><code>which</code></dfn>
    </dl>
    <p class="issue" id="issue-21d6f045"><a class="self-link" href="#issue-21d6f045"></a> Add definition for UIEventInit</p>
    <div class="algorithm" data-algorithm="initialize-a-uievent">
     <h3 class="heading settled" data-level="4.2" id="initialize a uievent"><span class="secno">4.2. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="initialize-a-uievent">initialize a UIEvent</dfn></span><a class="self-link" href="#initialize%20a%20uievent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#uievent" id="ref-for-uievent①">UIEvent</a></code> to initialize</p>
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-an-event" id="ref-for-initialize-an-event">Initialize an Event</a> with <var>event</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Initialize the following public attributes</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-uievent-view" id="ref-for-dom-uievent-view">view</a></code> = the <var>eventTarget</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document">node document</a>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window">Window</a></code> object</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-uievent-detail" id="ref-for-dom-uievent-detail">detail</a></code> = 0</p>
       </ol>
      <li data-md>
       <p>Initialize the following historical attributes</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-which" id="ref-for-dom-keyboardevent-which">which</a></code> = 0  (used by both <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent">MouseEvent</a></code> and <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#keyboardevent" id="ref-for-keyboardevent">KeyboardEvent</a></code>)</p>
       </ol>
      <li data-md>
       <p>If this event is the result of user interaction, then</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>’s <a data-link-type="dfn" href="#uievent-due-to-user-interaction-flag" id="ref-for-uievent-due-to-user-interaction-flag①">due to user interaction flag</a></p>
         <p class="note" role="note"><span class="marker">Note:</span> See <a href="https://github.com/w3c/uievents/issues/270">uievents/270</a></p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-istrusted" id="ref-for-dom-event-istrusted①">isTrusted</a></code> = false</p>
       </ol>
     </ol>
    </div>
    <p class="issue" id="issue-af4b830f"><a class="self-link" href="#issue-af4b830f"></a> Event firing for load, unload, abort, error, select. Should those be covered here
or are they handled elsewhere already?</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="focus event"><span class="secno">5. </span><span class="content">Focus Event</span><a class="self-link" href="#focus%20event"></a></h2>
    <p class="issue" id="issue-b7b1e314"><a class="self-link" href="#issue-b7b1e314"></a> TODO</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="6" id="mouse event"><span class="secno">6. </span><span class="content">Mouse Event</span><a class="self-link" href="#mouse%20event"></a></h2>
    <h3 class="heading settled" data-level="6.1" id="mouseevent-interface"><span class="secno">6.1. </span><span class="content">MouseEvent Interface</span><a class="self-link" href="#mouseevent-interface"></a></h3>
    <p>A <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent①">MouseEvent</a></code> has the following:</p>
    <dl>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-screenx"><code>screenX</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-screeny"><code>screenY</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-clientx"><code>clientX</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-clienty"><code>clientY</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-ctrlkey"><code>ctrlKey</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-shiftkey"><code>shiftKey</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-altkey"><code>altKey</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-metakey"><code>metaKey</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-button"><code>button</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-buttons"><code>buttons</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-relatedtarget"><code>relatedTarget</code></dfn>
     <li>getModifierState(keyArg)
    </dl>
    <h3 class="heading settled" data-level="6.2" id="mouseevent-global-state"><span class="secno">6.2. </span><span class="content">Global State for MouseEvent</span><a class="self-link" href="#mouseevent-global-state"></a></h3>
    <h4 class="heading settled" data-level="6.2.1" id="mouseevent-global-ua"><span class="secno">6.2.1. </span><span class="content">User Agent-Level State</span><a class="self-link" href="#mouseevent-global-ua"></a></h4>
    <p>The UA must maintain the following values that are shared for the entire
    User Agent.</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="mouse-button-bitmask">mouse button bitmask</dfn> that tracks the current state of the
    mouse buttons.</p>
    <h4 class="heading settled" data-level="6.2.2" id="mouseevent-global-window"><span class="secno">6.2.2. </span><span class="content">Window-Level State</span><a class="self-link" href="#mouseevent-global-window"></a></h4>
    <p>The UA must maintain the following values that are shared for the Window.</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="last-mouse-element">last mouse element</dfn> value (initially undefined) that keeps track
    of the last <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element">Element</a></code> that we sent a MouseEvent to.</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="last-mouse-dom-path">last mouse DOM path</dfn> value (initially empty) that contains a snapshot
    of the ancestors <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element①">Element</a></code>s of the <a data-link-type="dfn" href="#last-mouse-element" id="ref-for-last-mouse-element">last mouse element</a> when the most recent mouse
    event was sent.</p>
    <div class="algorithm" data-algorithm="initialize-a-mouseevent">
     <h3 class="heading settled" data-level="6.3" id="initialize a mouseevent"><span class="secno">6.3. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="initialize-a-mouseevent">initialize a MouseEvent</dfn></span><a class="self-link" href="#initialize%20a%20mouseevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent②">MouseEvent</a></code> to initialize</p>
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget②">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-uievent" id="ref-for-initialize-a-uievent">Initialize a UIEvent</a> with <var>event</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Initialize the following public attributes</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-screenx" id="ref-for-dom-mouseevent-screenx">screenX</a></code> = the x-coordinate of the position where the event occurred
relative to the origin of the desktop</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-screeny" id="ref-for-dom-mouseevent-screeny">screenY</a></code> = the y-coordinate of the position where the event occurred
relative to the origin of the desktop</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-clientx" id="ref-for-dom-mouseevent-clientx">clientX</a></code> = the x-coordinate of the position where the event occurred
relative to the origin of the viewport</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-clienty" id="ref-for-dom-mouseevent-clienty">clientY</a></code> = the y-coordinate of the position where the event occurred
relative to the origin of the <a data-link-type="dfn" href="https://www.w3.org/TR/CSS2/visuren.html#viewport" id="ref-for-viewport">viewport</a></p>
        <li data-md>
         <p><a data-link-type="dfn" href="#set-event-modifiers" id="ref-for-set-event-modifiers">Set event modifiers</a> with <var>event</var></p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-button" id="ref-for-dom-mouseevent-button">button</a></code> = 0</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-buttons" id="ref-for-dom-mouseevent-buttons">buttons</a></code> = <a data-link-type="dfn" href="#mouse-button-bitmask" id="ref-for-mouse-button-bitmask">mouse button bitmask</a></p>
       </ol>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-pointerlock-attributes-for-mouseevent" id="ref-for-initialize-pointerlock-attributes-for-mouseevent">Initialize PointerLock attributes for MouseEvent</a> with <var>event</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-cssom-attributes-for-mouseevent" id="ref-for-initialize-cssom-attributes-for-mouseevent">Initialize CSSOM attributes for MouseEvent</a> with <var>event</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="create-a-mouseevent">
     <h3 class="heading settled" data-level="6.4" id="create a mouseevent"><span class="secno">6.4. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-mouseevent">create a MouseEvent</dfn></span><a class="self-link" href="#create%20a%20mouseevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget③">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>event</var> = the result of <a href="https://dom.spec.whatwg.org/#concept-event-create">creating a new event</a> using <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent③">MouseEvent</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-mouseevent" id="ref-for-initialize-a-mouseevent">Initialize a MouseEvent</a> with <var>event</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Return <var>event</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="calculate-mouseevent-button-attribute">
     <h3 class="heading settled" data-level="6.5" id="calculate mouseevent button attribute"><span class="secno">6.5. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="calculate-mouseevent-button-attribute">calculate MouseEvent button attribute</dfn></span><a class="self-link" href="#calculate%20mouseevent%20button%20attribute"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>mbutton</var>, an ID that identifies a mouse button</p>
      <dt data-md>Output
      <dd data-md>
       <p>A button ID suitable for storing in the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent④">MouseEvent</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-mouseevent-button" id="ref-for-dom-mouseevent-button①">button</a></code> attribute</p>
     </dl>
     <ol>
      <li data-md>
       <p>If <var>mbutton</var> is the primary mouse button, then return 0</p>
      <li data-md>
       <p>If <var>mbutton</var> is the auxiliary (middle)  mouse button, then return 1</p>
      <li data-md>
       <p>If <var>mbutton</var> is the secondary mouse button, then return 2</p>
      <li data-md>
       <p>If <var>mbutton</var> is the X1 (back) button, then return 3</p>
      <li data-md>
       <p>If <var>mbutton</var> is the X2 (forward) button, then return 4</p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="set-mouseevent-attributes-from-native">
     <h3 class="heading settled" data-level="6.6" id="set mouseevent attributes from native"><span class="secno">6.6. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="set-mouseevent-attributes-from-native">set MouseEvent attributes from native</dfn></span><a class="self-link" href="#set%20mouseevent%20attributes%20from%20native"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent⑤">MouseEvent</a></code> to initialize</p>
      <dd data-md>
       <p><var>native</var>, the native mouse event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="issue" id="issue-b7b1e314①"><a class="self-link" href="#issue-b7b1e314①"></a> TODO</p>
     <ol>
      <li data-md>
       <p>If <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type" id="ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type①">type</a></code> is one of [ mousedown, mouseup ], then</p>
       <ol>
        <li data-md>
         <p>Let <var>mbutton</var> be an ID from <var>native</var> that identifies which mouse button was pressed</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-button" id="ref-for-dom-mouseevent-button②">button</a></code> = <a data-link-type="dfn" href="#calculate-mouseevent-button-attribute" id="ref-for-calculate-mouseevent-button-attribute">calculate MouseEvent button attribute</a> with <var>mbutton</var></p>
       </ol>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-native-mouse-down">
     <h3 class="heading settled" data-level="6.7" id="handle native mouse down"><span class="secno">6.7. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-native-mouse-down">handle native mouse down</dfn></span><a class="self-link" href="#handle%20native%20mouse%20down"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>native</var>, the native mousedown</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>mbutton</var> be an ID from <var>native</var> that identifies which mouse button was pressed</p>
      <li data-md>
       <p>Update the <a data-link-type="dfn" href="#mouse-button-bitmask" id="ref-for-mouse-button-bitmask①">mouse button bitmask</a> as follows:</p>
       <ol>
        <li data-md>
         <p>If <var>mbutton</var> is the primary mouse button, then set the 0x01 bit</p>
        <li data-md>
         <p>If <var>mbutton</var> is the secondary mouse button, then set the 0x02 bit</p>
        <li data-md>
         <p>If <var>mbutton</var> is the auxiliary (middle) mouse button, then set the 0x04 bit</p>
       </ol>
       <p class="issue" id="issue-e1271e39"><a class="self-link" href="#issue-e1271e39"></a> Other buttons can be added starting with 0x08</p>
      <li data-md>
       <p>Let <var>target</var> = <a data-link-type="dfn" href="#hit-test" id="ref-for-hit-test">hit test</a> with viewport-relative coordinates from <var>native</var></p>
      <li data-md>
       <p>Let <var>event</var> = <a data-link-type="dfn" href="#create-a-mouseevent" id="ref-for-create-a-mouseevent">create a MouseEvent</a> with "mousedown", <var>target</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#set-mouseevent-attributes-from-native" id="ref-for-set-mouseevent-attributes-from-native">Set MouseEvent attributes from native</a> with <var>native</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#maybe-send-pointerdown-event" id="ref-for-maybe-send-pointerdown-event">Maybe send pointerdown event</a> with <var>event</var></p>
      <li data-md>
       <p>Let <var>result</var> = <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch">dispatch</a> <var>event</var> at <var>target</var></p>
      <li data-md>
       <p>If <var>result</var> is true and <var>target</var> is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/#focusable-area" id="ref-for-focusable-area">focusable area</a> that is <a data-link-type="dfn" href="https://html.spec.whatwg.org/#click-focusable" id="ref-for-click-focusable">click focusable</a>, then</p>
       <ol>
        <li data-md>
         <p>Run the <a data-link-type="dfn" href="https://html.spec.whatwg.org/#focusing-steps" id="ref-for-focusing-steps">focusing steps</a> at <var>target</var></p>
       </ol>
      <li data-md>
       <p>if <var>mbutton</var> is the secondary mouse button, then</p>
       <ol>
        <li data-md>
         <p><a data-link-type="dfn" href="#maybe-show-context-menu" id="ref-for-maybe-show-context-menu">Maybe show context menu</a> with <var>native</var>, <var>target</var></p>
       </ol>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-native-mouse-up">
     <h3 class="heading settled" data-level="6.8" id="handle native mouse up"><span class="secno">6.8. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-native-mouse-up">handle native mouse up</dfn></span><a class="self-link" href="#handle%20native%20mouse%20up"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>native</var>, the native mouseup</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="note" role="note"><span class="marker">Note:</span> Other mouse events can occur between the mousedown and mouseup.</p>
     <ol>
      <li data-md>
       <p>Let <var>mbutton</var> be an ID from <var>native</var> that identifies which mouse button was pressed</p>
      <li data-md>
       <p>Update the <a data-link-type="dfn" href="#mouse-button-bitmask" id="ref-for-mouse-button-bitmask②">mouse button bitmask</a> as follows:</p>
       <ol>
        <li data-md>
         <p>If <var>mbutton</var> is the primary mouse button, then clear the 0x01 bit</p>
        <li data-md>
         <p>If <var>mbutton</var> is the secondary mouse button, then clear the 0x02 bit</p>
        <li data-md>
         <p>If <var>mbutton</var> is the auxiliary (middle) mouse button, then clear the 0x04 bit</p>
       </ol>
      <li data-md>
       <p>Let <var>target</var> = <a data-link-type="dfn" href="#hit-test" id="ref-for-hit-test①">hit test</a> with viewport-relative coordinates from <var>native</var></p>
      <li data-md>
       <p>Let <var>event</var> = <a data-link-type="dfn" href="#create-a-mouseevent" id="ref-for-create-a-mouseevent①">create a MouseEvent</a> with "mouseup", <var>target</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#set-mouseevent-attributes-from-native" id="ref-for-set-mouseevent-attributes-from-native①">Set MouseEvent attributes from native</a> with <var>native</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#maybe-send-pointerup-event" id="ref-for-maybe-send-pointerup-event">Maybe send pointerup event</a> with <var>event</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①">dispatch</a> <var>event</var> at <var>target</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-native-mouse-click">
     <h3 class="heading settled" data-level="6.9" id="handle native mouse click"><span class="secno">6.9. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-native-mouse-click">handle native mouse click</dfn></span><a class="self-link" href="#handle%20native%20mouse%20click"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>native</var>, the native mouse click</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="note" role="note"><span class="marker">Note:</span> The platform should call this immediately after <a data-link-type="dfn" href="#handle-native-mouse-up" id="ref-for-handle-native-mouse-up①">handle native mouse up</a> for
    mouseups that generate clicks.</p>
     <ol>
      <li data-md>
       <p>Let <var>target</var> = <a data-link-type="dfn" href="#hit-test" id="ref-for-hit-test②">hit test</a> with viewport-relative coordinates from <var>native</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#send-click-event" id="ref-for-send-click-event">Send click event</a> with <var>native</var> and <var>target</var>.</p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="send-click-event">
     <h3 class="heading settled" data-level="6.10" id="send click event"><span class="secno">6.10. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="send-click-event">send click event</dfn></span><a class="self-link" href="#send%20click%20event"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>native</var>, the native mousedown</p>
      <dd data-md>
       <p><var>target</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget④">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>mbutton</var> = 1  (primary mouse button by default)</p>
      <li data-md>
       <p>If <var>native</var> is valid, then</p>
       <ol>
        <li data-md>
         <p>Let <var>mbutton</var> be an ID from <var>native</var> that identifies which mouse button was pressed</p>
       </ol>
      <li data-md>
       <p>Let <var>eventType</var> = "auxclick"</p>
      <li data-md>
       <p>If <var>mbutton</var> is the primary mouse button, then</p>
       <ol>
        <li data-md>
         <p>Set <var>eventType</var> = "click"</p>
       </ol>
      <li data-md>
       <p>Let <var>event</var> = <a data-link-type="dfn" href="#create-a-pointerevent" id="ref-for-create-a-pointerevent">create a PointerEvent</a> with <var>eventType</var> and <var>target</var></p>
      <li data-md>
       <p>If <var>native</var> is valid, then</p>
       <ol>
        <li data-md>
         <p><a data-link-type="dfn" href="#set-mouseevent-attributes-from-native" id="ref-for-set-mouseevent-attributes-from-native②">Set MouseEvent attributes from native</a> with <var>event</var>, <var>native</var></p>
        <li data-md>
         <p>If <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-screenx" id="ref-for-dom-mouseevent-screenx①">screenX</a></code> is not an integer value, then round it.</p>
        <li data-md>
         <p>If <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-screeny" id="ref-for-dom-mouseevent-screeny①">screenY</a></code> is not an integer value, then round it.</p>
       </ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch②">dispatch</a> <var>event</var> at <var>target</var></p>
     </ol>
     <p class="note" role="note"><span class="marker">Note:</span> See <a href="https://github.com/w3c/pointerevents/issues/100">pointerevents/100</a> for info about browsers using PointerEvents and rounded coordinates.</p>
     <p class="note" role="note"><span class="marker">Note:</span> Any "default action" is handled during dispatch by triggering the <a href="https://dom.spec.whatwg.org/#eventtarget-activation-behavior">activation behavior</a> algorithm for the target. So there is no need for handle that here.
    However, need to verify that the existing spec handles disabled/css-pointer-events/inert/...</p>
     <p class="note" role="note"><span class="marker">Note:</span> To handle `HTMLelement.click()`, call this algorithm with <var>native</var> = null and <var>target</var> = `HTMLelement`.</p>
     <p class="note" role="note"><span class="marker">Note:</span> To handle keyboard-initiated clicks, call this algorithm with <var>native</var> = null and <var>target</var> = currently focused element.</p>
    </div>
    <div class="algorithm" data-algorithm="handle-native-mouse-double-click">
     <h3 class="heading settled" data-level="6.11" id="handle native mouse double click"><span class="secno">6.11. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-native-mouse-double-click">handle native mouse double click</dfn></span><a class="self-link" href="#handle%20native%20mouse%20double%20click"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>native</var>, the native mouse double click</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="note" role="note"><span class="marker">Note:</span> This should be called immediately after handle native mouse click for
    mouse clicks that generate double clicks.</p>
     <ol>
      <li data-md>
       <p>Let <var>mbutton</var> be an ID from <var>native</var> that identifies which mouse button was pressed</p>
      <li data-md>
       <p>If <var>mbutton</var> is not the primary mouse button, then return</p>
      <li data-md>
       <p>Let <var>target</var> = <a data-link-type="dfn" href="#hit-test" id="ref-for-hit-test③">hit test</a> with viewport-relative coordinates from <var>native</var></p>
      <li data-md>
       <p>Let <var>event</var> = <a data-link-type="dfn" href="#create-a-pointerevent" id="ref-for-create-a-pointerevent①">create a PointerEvent</a> with "dblclick" and <var>target</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#set-mouseevent-attributes-from-native" id="ref-for-set-mouseevent-attributes-from-native③">Set MouseEvent attributes from native</a> with <var>event</var>, <var>native</var></p>
      <li data-md>
       <p>If <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-screenx" id="ref-for-dom-mouseevent-screenx②">screenX</a></code> is not an integer value, then round it.</p>
      <li data-md>
       <p>If <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-screeny" id="ref-for-dom-mouseevent-screeny②">screenY</a></code> is not an integer value, then round it.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch③">dispatch</a> <var>event</var> at <var>target</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-native-mouse-move">
     <h3 class="heading settled" data-level="6.12" id="handle native mouse move"><span class="secno">6.12. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-native-mouse-move">handle native mouse move</dfn></span><a class="self-link" href="#handle%20native%20mouse%20move"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>native</var>, the native mouse move</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="issue" id="issue-5a61aefb"><a class="self-link" href="#issue-5a61aefb"></a> This algorithm makes assumptions about the dispatch of PointerEvents because they
    are not currently specified explicitly. Once <a href="https://github.com/w3c/pointerevents/issues/285">pointerevents/285</a> is resolved
    this may need to be updated.</p>
     <ol>
      <li data-md>
       <p>Let <var>target</var> = <a data-link-type="dfn" href="#hit-test" id="ref-for-hit-test④">hit test</a> with viewport-relative coordinates from <var>native</var></p>
      <li data-md>
       <p>Let <var>targetDomPath</var> = <a data-link-type="dfn" href="#calculate-dom-path" id="ref-for-calculate-dom-path">calculate DOM path</a></p>
      <li data-md>
       <p>Generate events for leaving the current element:</p>
       <ol>
        <li data-md>
         <p>If <a data-link-type="dfn" href="#last-mouse-element" id="ref-for-last-mouse-element①">last mouse element</a> is defined and not equal to <var>target</var>, then</p>
         <ol>
          <li data-md>
           <p>Let <var>mouseout</var> = <a data-link-type="dfn" href="#create-a-mouseevent" id="ref-for-create-a-mouseevent②">create a MouseEvent</a> with "mouseout" and <a data-link-type="dfn" href="#last-mouse-element" id="ref-for-last-mouse-element②">last mouse element</a></p>
         </ol>
         <p class="issue" id="issue-6c6e5fe0"><a class="self-link" href="#issue-6c6e5fe0"></a> TODO: Set <var>mouseout</var> attributes from <var>native</var>. +CSSOM attributes</p>
         <ol>
          <li data-md>
           <p><a data-link-type="dfn" href="#maybe-send-pointerout-event" id="ref-for-maybe-send-pointerout-event">Maybe send pointerout event</a> with <var>mouseout</var></p>
          <li data-md>
           <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch④">Dispatch</a> <var>mouseout</var> at <var>target</var></p>
           <p class="issue" id="issue-f864a356"><a class="self-link" href="#issue-f864a356"></a> Verify behavior when canceled (appears to have no effect).</p>
          <li data-md>
           <p>Let <var>leaveElements</var> be a copy of <a data-link-type="dfn" href="#last-mouse-dom-path" id="ref-for-last-mouse-dom-path">last mouse DOM path</a> with all
elements common to <var>targetDomPath</var> removed.</p>
          <li data-md>
           <p>For each <var>element</var> in <var>leaveElements</var>, do</p>
           <p class="issue" id="issue-c3b2625c"><a class="self-link" href="#issue-c3b2625c"></a> Handle case where <var>element</var> has been deleted.
Also case where it has been moved: Should the DOM mutation have triggered
a mouseleave event? Should we sent it now? Should it be dropped?
Need to verify what current browsers do.</p>
           <ol>
            <li data-md>
             <p>Let <var>mouseleave</var> = <a data-link-type="dfn" href="#create-a-mouseevent" id="ref-for-create-a-mouseevent③">create a MouseEvent</a> with "mouseleave" and <var>element</var></p>
            <li data-md>
             <p>Set <var>mouseleave</var>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles" id="ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles①">bubbles</a></code> = false</p>
            <li data-md>
             <p>Set <var>mouseleave</var>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable" id="ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable①">cancelable</a></code> = false</p>
            <li data-md>
             <p>Set <var>mouseleave</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-composed" id="ref-for-dom-event-composed①">composed</a></code> = false</p>
             <p class="issue" id="issue-ab0000b0"><a class="self-link" href="#issue-ab0000b0"></a> Compat: Value of event.composed. Spec says false.
Chrome/Linux = true
Firefox/Linux = false</p>
            <li data-md>
             <p><a data-link-type="dfn" href="#maybe-send-pointerleave-event" id="ref-for-maybe-send-pointerleave-event">Maybe send pointerleave event</a> with <var>mouseleave</var></p>
            <li data-md>
             <p>Let <var>result</var> = <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch⑤">dispatch</a> <var>mouseleave</var> at <var>element</var></p>
           </ol>
         </ol>
       </ol>
      <li data-md>
       <p>Generate events for entering the new element:</p>
       <ol>
        <li data-md>
         <p>If <var>target</var> is not <a data-link-type="dfn" href="#last-mouse-element" id="ref-for-last-mouse-element③">last mouse element</a>, then</p>
         <ol>
          <li data-md>
           <p>Let <var>mouseover</var> = <a data-link-type="dfn" href="#create-a-mouseevent" id="ref-for-create-a-mouseevent④">create a MouseEvent</a> with "mouseover" and <var>target</var></p>
         </ol>
         <p class="issue" id="issue-6c6e5fe0①"><a class="self-link" href="#issue-6c6e5fe0①"></a> TODO: Set <var>mouseout</var> attributes from <var>native</var>. +CSSOM attributes</p>
         <ol>
          <li data-md>
           <p><a data-link-type="dfn" href="#maybe-send-pointerover-event" id="ref-for-maybe-send-pointerover-event">Maybe send pointerover event</a> with <var>mouseover</var></p>
          <li data-md>
           <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch⑥">Dispatch</a> <var>mouseout</var> at <var>target</var></p>
           <p class="issue" id="issue-f864a356①"><a class="self-link" href="#issue-f864a356①"></a> Verify behavior when canceled (appears to have no effect).</p>
          <li data-md>
           <p>Let <var>enterElements</var> be a copy of <var>targetDomPath</var> with all
elements common to <a data-link-type="dfn" href="#last-mouse-dom-path" id="ref-for-last-mouse-dom-path①">last mouse DOM path</a> removed.</p>
          <li data-md>
           <p>For each <var>element</var> in <var>enterElements</var>, do</p>
           <p class="issue" id="issue-9fc42a9a"><a class="self-link" href="#issue-9fc42a9a"></a> Handle case where <var>element</var> has been deleted or moved.</p>
           <ol>
            <li data-md>
             <p>Let <var>mouseenter</var> = <a data-link-type="dfn" href="#create-a-mouseevent" id="ref-for-create-a-mouseevent⑤">create a MouseEvent</a> with "mouseenter" and <var>element</var></p>
            <li data-md>
             <p>Set <var>mouseenter</var>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles" id="ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles②">bubbles</a></code> = false</p>
            <li data-md>
             <p>Set <var>mouseenter</var>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable" id="ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable②">cancelable</a></code> = false</p>
            <li data-md>
             <p>Set <var>mouseenter</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-composed" id="ref-for-dom-event-composed②">composed</a></code> = false</p>
             <p class="issue" id="issue-ab0000b0①"><a class="self-link" href="#issue-ab0000b0①"></a> Compat: Value of event.composed. Spec says false.
Chrome/Linux = true
Firefox/Linux = false</p>
            <li data-md>
             <p><a data-link-type="dfn" href="#maybe-send-pointerenter-event" id="ref-for-maybe-send-pointerenter-event">Maybe send pointerenter event</a> with <var>mouseenter</var></p>
           </ol>
           <p class="issue" id="issue-9a3a918a"><a class="self-link" href="#issue-9a3a918a"></a> Compat for shadow DOM elements
Chrome/Linux fires this event at the element and the shadow root</p>
           <ol>
            <li data-md>
             <p>Let <var>result</var> = <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch⑦">dispatch</a> <var>mouseenter</var> at <var>element</var></p>
           </ol>
          <li data-md>
           <p>Set <a data-link-type="dfn" href="#last-mouse-element" id="ref-for-last-mouse-element④">last mouse element</a> to <var>target</var></p>
          <li data-md>
           <p>Set <a data-link-type="dfn" href="#last-mouse-dom-path" id="ref-for-last-mouse-dom-path②">last mouse DOM path</a> to <var>targetDomPath</var></p>
         </ol>
       </ol>
      <li data-md>
       <p>Let <var>mousemove</var> = <a data-link-type="dfn" href="#create-a-mouseevent" id="ref-for-create-a-mouseevent⑥">create a MouseEvent</a> with "mousemove" and <var>element</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#set-pointerlock-attributes-for-mousemove" id="ref-for-set-pointerlock-attributes-for-mousemove">Set PointerLock attributes for mousemove</a></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#maybe-send-pointermove-event" id="ref-for-maybe-send-pointermove-event">Maybe send pointermove event</a> with <var>mousemove</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch⑧">Dispatch</a> <var>mousemove</var> at <var>element</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="maybe-show-context-menu">
     <h3 class="heading settled" data-level="6.13" id="maybe show context menu"><span class="secno">6.13. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="maybe-show-context-menu">maybe show context menu</dfn></span><a class="self-link" href="#maybe%20show%20context%20menu"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>native</var>, the native mousedown or pointer event</p>
      <dd data-md>
       <p><var>target</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget⑤">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
       <ol>
        <li data-md>
         <p>Let <var>menuevent</var> = <a data-link-type="dfn" href="#create-a-pointerevent" id="ref-for-create-a-pointerevent②">create a PointerEvent</a> with "contextmenu", <var>target</var></p>
        <li data-md>
         <p>If <var>native</var> is valid, then</p>
         <ol>
          <li data-md>
           <p><a data-link-type="dfn" href="#set-mouseevent-attributes-from-native" id="ref-for-set-mouseevent-attributes-from-native④">Set MouseEvent attributes from native</a> with <var>native</var></p>
         </ol>
        <li data-md>
         <p>Let <var>result</var> = <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch⑨">dispatch</a> <var>menuevent</var> at <var>target</var></p>
        <li data-md>
         <p>If <var>result</var> is true, then show the UA context menu</p>
       </ol>
     </dl>
     <p class="note" role="note"><span class="marker">Note:</span> To handle a context menu triggered by the keyboard, call this algorithm with <var>native</var> = null and <var>target</var> = currently focused element.</p>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="7" id="wheel event"><span class="secno">7. </span><span class="content">Wheel Event</span><a class="self-link" href="#wheel%20event"></a></h2>
    <p class="issue" id="issue-b7b1e314②"><a class="self-link" href="#issue-b7b1e314②"></a> TODO</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="8" id="input event"><span class="secno">8. </span><span class="content">Input Event</span><a class="self-link" href="#input%20event"></a></h2>
    <div class="algorithm" data-algorithm="initialize-an-inputevent">
     <h3 class="heading settled" data-level="8.1" id="initialize an Inputevent"><span class="secno">8.1. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="initialize-an-inputevent">initialize an InputEvent</dfn></span><a class="self-link" href="#initialize%20an%20Inputevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>e</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event③">Event</a></code> to initialize</p>
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget⑥">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-uievent" id="ref-for-initialize-a-uievent①">Initialize a UIEvent</a> with <var>e</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Initialize the following public attributes</p>
       <ol>
        <li data-md>
         <p>Set event.data = null</p>
        <li data-md>
         <p>Set event.isComposing = false</p>
        <li data-md>
         <p>Set event.inputType = ""</p>
        <li data-md>
         <p>Set event.composed = true</p>
         <p class="note" role="note"><span class="marker">Note:</span> Setting composed to true matches current UA behavior, but it makes more sense
for this to be false.
See <a href="https://github.com/whatwg/html/issues/5453">whatwg/html/5453</a> for discussion.</p>
       </ol>
      <li data-md>
       <p>Initialize the additional editing attributes from [[Input Events]]</p>
       <p class="issue" id="issue-0a3912f8"><a class="self-link" href="#issue-0a3912f8"></a> Move the following into InputEvents spec
(<a href="https://www.w3.org/TR/input-events-1/">level 1</a> or <a href="https://www.w3.org/TR/input-events-2/">level 2</a>)
since that’s where these attributes are defined.</p>
       <ol>
        <li data-md>
         <p>Set <var>e</var>.dataTransfer = false</p>
        <li data-md>
         <p>Set <var>e</var>.targetRanges = []</p>
       </ol>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="create-an-inputevent">
     <h3 class="heading settled" data-level="8.2" id="create an inputevent"><span class="secno">8.2. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-an-inputevent">create an InputEvent</dfn></span><a class="self-link" href="#create%20an%20inputevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget⑦">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>e</var> = the result of <a href="https://dom.spec.whatwg.org/#concept-event-create">creating a new event</a> using <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#inputevent" id="ref-for-inputevent">InputEvent</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-an-inputevent" id="ref-for-initialize-an-inputevent">Initialize an InputEvent</a> with <var>e</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Return <var>e</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="fire-key-input-events">
     <h3 class="heading settled" data-level="8.3" id="fire key input events"><span class="secno">8.3. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="fire-key-input-events">fire key input events</dfn></span><a class="self-link" href="#fire%20key%20input%20events"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>key</var>, a DOMString containing the string corresponding to the key</p>
      <dd data-md>
       <p><var>target</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget⑧">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>If <a data-link-type="dfn" href="#suppress-key-input-events-flag" id="ref-for-suppress-key-input-events-flag">suppress key input events flag</a> is set, then</p>
       <ol>
        <li data-md>
         <p>Exit (since the keydown was canceled)</p>
       </ol>
     </ol>
     <p class="issue" id="issue-7ecf840c"><a class="self-link" href="#issue-7ecf840c"></a> Handle historical keypress event here. Return if cancelled.</p>
     <ol>
      <li data-md>
       <p>Let <var>inputType</var> = null</p>
      <li data-md>
       <p>Let <var>data</var> = null</p>
     </ol>
     <p class="issue" id="issue-10cc14f1"><a class="self-link" href="#issue-10cc14f1"></a> How much of this can be moved into the [[Input Events]] spec?
    Issue: List more keys here</p>
     <ol>
      <li data-md>
       <p>If <var>key</var> is "Backspace", then <var>inputType</var> = "deleteContentBackward"</p>
      <li data-md>
       <p>If <var>key</var> is "Delete", then <var>inputType</var> = "deleteContentForward"</p>
      <li data-md>
       <p>Otherwise,</p>
       <ol>
        <li data-md>
         <p><var>inputType</var> = "insertText"</p>
        <li data-md>
         <p><var>data</var> = <var>key</var></p>
       </ol>
      <li data-md>
       <p>If <var>inputType</var> is not null, then</p>
       <p class="note" role="note"><span class="marker">Note:</span> Need to verify Firefox behavior.
Can be enabled by changing the "dom.input_events.beforeinput_enabled" pref in "about:config"</p>
       <ol>
        <li data-md>
         <p>Let <var>result</var> = <a data-link-type="dfn" href="#fire-an-inputevent" id="ref-for-fire-an-inputevent">fire an InputEvent</a> with "beforeinput", <var>inputType</var> and <var>data</var></p>
        <li data-md>
         <p>If <var>result</var> is false, then return.</p>
        <li data-md>
         <p>Let <var>textInputData</var> be <var>data</var>.</p>
        <li data-md>
         <p>If <var>inputType</var> is either "insertParagraph" or "insertLineBreak", then set <var>textInputData</var> to "\n".</p>
        <li data-md>
         <p>If <var>inputType</var> is "insertText", then</p>
         <ol>
          <li data-md>
           <p>Set <var>result</var> = <a data-link-type="dfn" href="#fire-a-textevent①" id="ref-for-fire-a-textevent①">fire a TextEvent</a> with "textInput", and <var>textInputData</var></p>
         </ol>
         <p class="note" role="note"><span class="marker">Note:</span> The "textInput" event is obsolete.</p>
         <ol>
          <li data-md>
           <p>If <var>result</var> is false, then return.</p>
         </ol>
       </ol>
       <p class="note" role="note"><span class="marker">Note:</span> Perform DOM update here. Insert key into <var>target</var> element</p>
       <p class="note" role="note"><span class="marker">Note:</span> Compat:
For insertFromPaste, Chrome has data = null, Firefox has data = same as beforeinput.</p>
       <ol>
        <li data-md>
         <p><a data-link-type="dfn" href="#fire-an-inputevent" id="ref-for-fire-an-inputevent①">Fire an InputEvent</a> with "input", <var>inputType</var> and <var>data</var></p>
       </ol>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="fire-an-inputevent">
     <h3 class="heading settled" data-level="8.4" id="fire an inputevent"><span class="secno">8.4. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="fire-an-inputevent">fire an InputEvent</dfn></span><a class="self-link" href="#fire%20an%20inputevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>inputType</var>, a DOMString containing the input event type</p>
      <dd data-md>
       <p><var>data</var>, a DOMString containing event data</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="issue" id="issue-3dc727e9"><a class="self-link" href="#issue-3dc727e9"></a> What about target ranges? Need to add support here.</p>
     <p class="issue" id="issue-616da821"><a class="self-link" href="#issue-616da821"></a> The target for input events should consider focus, but should also ensure that
    the element is editable and being modified.
    Compare: <a data-link-type="dfn" href="#fire-a-compositionevent" id="ref-for-fire-a-compositionevent">fire a compositionevent</a></p>
     <ol>
      <li data-md>
       <p>Let target = <a href="https://html.spec.whatwg.org/#currently-focused-area-of-a-top-level-browsing-context">currently focused area of a top-level browsing context</a></p>
      <li data-md>
       <p>Let <var>event</var> = result of <a data-link-type="dfn" href="#create-an-inputevent" id="ref-for-create-an-inputevent">create an InputEvent</a> with <var>eventType</var>, <var>target</var></p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl">inputType</a></code> = <var>inputType</var></p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#dom-inputevent-data" id="ref-for-dom-inputevent-data">data</a></code> = <var>data</var></p>
      <li data-md>
       <p>Return the result of <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①⓪">dispatch</a> <var>event</var> at <var>target</var></p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="9" id="textevent"><span class="secno">9. </span><span class="content">Text Event</span><a class="self-link" href="#textevent"></a></h2>
    <p class="note" role="note"><span class="marker">Note:</span> <code class="idl"><a data-link-type="idl" href="#textevent①" id="ref-for-textevent①">TextEvent</a></code> is obsolete.</p>
    <h3 class="heading settled" data-level="9.1" id="textevent-interface"><span class="secno">9.1. </span><span class="content">TextEvent Interface</span><a class="self-link" href="#textevent-interface"></a></h3>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="textevent①"><code><c- g>TextEvent</c-></code></dfn> : <a data-link-type="idl-name" href="https://w3c.github.io/uievents/#uievent" id="ref-for-uievent②"><c- n>UIEvent</c-></a> {
    <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-textevent-data" id="ref-for-dom-textevent-data"><c- g>data</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-textevent-inittextevent" id="ref-for-dom-textevent-inittextevent"><c- g>initTextEvent</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="TextEvent/initTextEvent(type, bubbles, cancelable, view, data), TextEvent/initTextEvent(type, bubbles, cancelable, view), TextEvent/initTextEvent(type, bubbles, cancelable), TextEvent/initTextEvent(type, bubbles), TextEvent/initTextEvent(type)" data-dfn-type="argument" data-export id="dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type"><code><c- g>type</c-></code></dfn>,
        <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="TextEvent/initTextEvent(type, bubbles, cancelable, view, data), TextEvent/initTextEvent(type, bubbles, cancelable, view), TextEvent/initTextEvent(type, bubbles, cancelable), TextEvent/initTextEvent(type, bubbles), TextEvent/initTextEvent(type)" data-dfn-type="argument" data-export id="dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles"><code><c- g>bubbles</c-></code></dfn> = <c- b>false</c->,
        <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean①"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="TextEvent/initTextEvent(type, bubbles, cancelable, view, data), TextEvent/initTextEvent(type, bubbles, cancelable, view), TextEvent/initTextEvent(type, bubbles, cancelable), TextEvent/initTextEvent(type, bubbles), TextEvent/initTextEvent(type)" data-dfn-type="argument" data-export id="dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable"><code><c- g>cancelable</c-></code></dfn> = <c- b>false</c->,
        <c- b>optional</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①"><c- n>Window</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="TextEvent/initTextEvent(type, bubbles, cancelable, view, data), TextEvent/initTextEvent(type, bubbles, cancelable, view), TextEvent/initTextEvent(type, bubbles, cancelable), TextEvent/initTextEvent(type, bubbles), TextEvent/initTextEvent(type)" data-dfn-type="argument" data-export id="dom-textevent-inittextevent-type-bubbles-cancelable-view-data-view"><code><c- g>view</c-></code></dfn> = <c- b>null</c->,
        <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="TextEvent/initTextEvent(type, bubbles, cancelable, view, data), TextEvent/initTextEvent(type, bubbles, cancelable, view), TextEvent/initTextEvent(type, bubbles, cancelable), TextEvent/initTextEvent(type, bubbles), TextEvent/initTextEvent(type)" data-dfn-type="argument" data-export id="dom-textevent-inittextevent-type-bubbles-cancelable-view-data-data"><code><c- g>data</c-></code></dfn> = "undefined");
};
</pre>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TextEvent" data-dfn-type="attribute" data-export id="dom-textevent-data"><code>data</code></dfn> attribute must return the value it was initialized to.</p>
    <div class="algorithm" data-algorithm="initTextEvent(type, bubbles, cancelable, view, data)" data-algorithm-for="TextEvent">
     <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TextEvent" data-dfn-type="method" data-export data-lt="initTextEvent(type, bubbles, cancelable, view, data)|initTextEvent(type, bubbles, cancelable, view)|initTextEvent(type, bubbles, cancelable)|initTextEvent(type, bubbles)|initTextEvent(type)" id="dom-textevent-inittextevent"><code>initTextEvent(<var>type</var>, <var>bubbles</var>, <var>cancelable</var>, <var>view</var>, <var>data</var>)</code></dfn> method steps are: </p>
     <ol>
      <li>
       <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#dispatch-flag" id="ref-for-dispatch-flag①">dispatch flag</a> is set, then return. </p>
      <li>
       <p><a data-link-type="dfn" href="#initialize-a-uievent" id="ref-for-initialize-a-uievent②">Initialize a UIEvent</a> with <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①">this</a>, <var>type</var> and <var>eventTarget</var> </p>
      <li>
       <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②">this</a>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles" id="ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles③">bubbles</a></code> = <var>bubbles</var> </p>
      <li>
       <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③">this</a>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable" id="ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable③">cancelable</a></code> = <var>cancelable</var> </p>
      <li>
       <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④">this</a>.<code class="idl"><a data-link-type="idl" href="#dom-uievent-view" id="ref-for-dom-uievent-view①">view</a></code> = <var>view</var> </p>
       <p class="note" role="note">The bubbles/cancelable/view should be parameters to "Initialize a UIEvent" instead of being set twice. </p>
      <li>
       <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑤">this</a>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-data" id="ref-for-dom-textevent-data①">data</a></code> = <var>data</var> </p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="initialize-a-textevent">
     <h3 class="heading settled" data-level="9.2" id="initialize-a-textevent"><span class="secno">9.2. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="initialize-a-textevent①">initialize a TextEvent</dfn></span><a class="self-link" href="#initialize-a-textevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>e</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event④">Event</a></code> to initialize</p>
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget⑨">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-uievent" id="ref-for-initialize-a-uievent③">Initialize a UIEvent</a> with <var>e</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Initialize the following public attributes</p>
       <ol>
        <li data-md>
         <p>Set event.data = ""</p>
       </ol>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="create-a-textevent">
     <h3 class="heading settled" data-level="9.3" id="create-a-textevent"><span class="secno">9.3. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-textevent①">create a TextEvent</dfn></span><a class="self-link" href="#create-a-textevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①⓪">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>e</var> = the result of <a href="https://dom.spec.whatwg.org/#concept-event-create">creating a new event</a> using <code class="idl"><a data-link-type="idl" href="#textevent①" id="ref-for-textevent①①">TextEvent</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-textevent①" id="ref-for-initialize-a-textevent①">Initialize a TextEvent</a> with <var>e</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Return <var>e</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="fire-a-textevent">
     <h3 class="heading settled" data-level="9.4" id="fire-a-textevent"><span class="secno">9.4. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="fire-a-textevent①">fire a TextEvent</dfn></span><a class="self-link" href="#fire-a-textevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>data</var>, a DOMString containing event data, or null</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let target = <a href="https://html.spec.whatwg.org/#currently-focused-area-of-a-top-level-browsing-context">currently focused area of a top-level browsing context</a></p>
      <li data-md>
       <p>Let <var>event</var> = result of <a data-link-type="dfn" href="#create-a-textevent①" id="ref-for-create-a-textevent①">create a TextEvent</a> with <var>eventType</var>, <var>target</var></p>
      <li data-md>
       <p>If <var>data</var> is null, set <var>data</var> to the empty string.</p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-data" id="ref-for-dom-textevent-data②">data</a></code> = <var>data</var></p>
      <li data-md>
       <p>Return the result of <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①①">dispatch</a> <var>event</var> at <var>target</var></p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="10" id="keyboard event"><span class="secno">10. </span><span class="content">Keyboard Event</span><a class="self-link" href="#keyboard%20event"></a></h2>
    <h3 class="heading settled" data-level="10.1" id="keyboardevent-interface"><span class="secno">10.1. </span><span class="content">KeyboardEvent Interface</span><a class="self-link" href="#keyboardevent-interface"></a></h3>
    <p>A <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#keyboardevent" id="ref-for-keyboardevent①">KeyboardEvent</a></code> has the following:</p>
    <dl>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="const" data-export id="dom-keyboardevent-dom_key_location_standard"><code>DOM_KEY_LOCATION_STANDARD</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="const" data-export id="dom-keyboardevent-dom_key_location_left"><code>DOM_KEY_LOCATION_LEFT</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="const" data-export id="dom-keyboardevent-dom_key_location_right"><code>DOM_KEY_LOCATION_RIGHT</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="const" data-export id="dom-keyboardevent-dom_key_location_numpad"><code>DOM_KEY_LOCATION_NUMPAD</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-key"><code>key</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-code"><code>code</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-location"><code>location</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-ctrlkey"><code>ctrlKey</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-shiftkey"><code>shiftKey</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-altkey"><code>altKey</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-metakey"><code>metaKey</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-repeat"><code>repeat</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-iscomposing"><code>isComposing</code></dfn>
     <li>getModifierState(keyArg) - handled by <a data-link-type="dfn" href="#get-modifier-state" id="ref-for-get-modifier-state">get modifier state</a>
    </dl>
    <p>Along with the following historical attributes:</p>
    <dl>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-keycode"><code>keyCode</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="KeyboardEvent" data-dfn-type="attribute" data-export id="dom-keyboardevent-keychar"><code>keyChar</code></dfn>
    </dl>
    <p>And the following internal state:</p>
    <dl>
     <li><dfn class="dfn-paneled" data-dfn-for="KeyboardEvent" data-dfn-type="dfn" data-noexport id="keyboardevent-shift-flag">shift flag</dfn>
     <li><dfn class="dfn-paneled" data-dfn-for="KeyboardEvent" data-dfn-type="dfn" data-noexport id="keyboardevent-control-flag">control flag</dfn>
     <li><dfn class="dfn-paneled" data-dfn-for="KeyboardEvent" data-dfn-type="dfn" data-noexport id="keyboardevent-alt-flag">alt flag</dfn>
     <li><dfn class="dfn-paneled" data-dfn-for="KeyboardEvent" data-dfn-type="dfn" data-noexport id="keyboardevent-altgraph-flag">altgraph flag</dfn>
     <li><dfn class="dfn-paneled" data-dfn-for="KeyboardEvent" data-dfn-type="dfn" data-noexport id="keyboardevent-meta-flag">meta flag</dfn>
     <li><dfn class="dfn-paneled" data-dfn-for="KeyboardEvent" data-dfn-type="dfn" data-noexport id="keyboardevent-capslock-flag">capslock flag</dfn>
     <li><dfn class="dfn-paneled" data-dfn-for="KeyboardEvent" data-dfn-type="dfn" data-noexport id="keyboardevent-numlock-flag">numlock flag</dfn>
    </dl>
    <h3 class="heading settled" data-level="10.2" id="keyboardevent-global-state"><span class="secno">10.2. </span><span class="content">Global State for KeyboardEvent</span><a class="self-link" href="#keyboardevent-global-state"></a></h3>
    <h4 class="heading settled" data-level="10.2.1" id="keyboardevent-global-ua"><span class="secno">10.2.1. </span><span class="content">User Agent-Level State</span><a class="self-link" href="#keyboardevent-global-ua"></a></h4>
    <p>The UA must maintain the following values that are shared for the entire
    User Agent.</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="key-modifier-state">key modifier state</dfn> (initially empty) that keeps track of the current
    state of each <a data-link-type="dfn" href="https://www.w3.org/TR/uievents-key/#keys-modifier" id="ref-for-keys-modifier">modifier key</a> available on the system.</p>
    <h4 class="heading settled" data-level="10.2.2" id="keyboardevent-global-window"><span class="secno">10.2.2. </span><span class="content">Window-Level State</span><a class="self-link" href="#keyboardevent-global-window"></a></h4>
    <p>The UA must maintain the following values that are shared for the Window.</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="suppress-key-input-events-flag">suppress key input events flag</dfn> (initially false) that is used to suppress
    input events when the initial keydown event is canceled.</p>
    <div class="algorithm" data-algorithm="initialize-a-keyboardevent">
     <h3 class="heading settled" data-level="10.3" id="initialize a keyboardevent"><span class="secno">10.3. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="initialize-a-keyboardevent">initialize a KeyboardEvent</dfn></span><a class="self-link" href="#initialize%20a%20keyboardevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#keyboardevent" id="ref-for-keyboardevent②">KeyboardEvent</a></code> to initialize</p>
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①①">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-uievent" id="ref-for-initialize-a-uievent④">Initialize a UIEvent</a> with <var>event</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Initialize the following public attributes</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-key" id="ref-for-dom-keyboardevent-key">key</a></code> = ""</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-code" id="ref-for-dom-keyboardevent-code">code</a></code> = ""</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-location" id="ref-for-dom-keyboardevent-location">location</a></code> = <code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-dom_key_location_standard" id="ref-for-dom-keyboardevent-dom_key_location_standard">DOM_KEY_LOCATION_STANDARD</a></code></p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-shiftkey" id="ref-for-dom-keyboardevent-shiftkey">shiftKey</a></code> = false</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-ctrlkey" id="ref-for-dom-keyboardevent-ctrlkey">ctrlKey</a></code> = false</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-altkey" id="ref-for-dom-keyboardevent-altkey">altKey</a></code> = false</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-metakey" id="ref-for-dom-keyboardevent-metakey">metaKey</a></code> = false</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-repeat" id="ref-for-dom-keyboardevent-repeat">repeat</a></code> = false</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-iscomposing" id="ref-for-dom-keyboardevent-iscomposing">isComposing</a></code> = false</p>
       </ol>
      <li data-md>
       <p>Initialize the following historical attributes</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-keycode" id="ref-for-dom-keyboardevent-keycode">keyCode</a></code> = 0</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#dom-keyboardevent-charcode" id="ref-for-dom-keyboardevent-charcode">charCode</a></code> = 0</p>
       </ol>
      <li data-md>
       <p>Initialize the following internal state</p>
       <p class="issue" id="issue-b4147fbf"><a class="self-link" href="#issue-b4147fbf"></a> Need to review: ScrollLock, Hyper, Super, and (for virtual keyboards) Symbol, SymbolLock</p>
       <ol>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-shift-flag" id="ref-for-keyboardevent-shift-flag">shift flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-control-flag" id="ref-for-keyboardevent-control-flag">control flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-alt-flag" id="ref-for-keyboardevent-alt-flag">alt flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-altgraph-flag" id="ref-for-keyboardevent-altgraph-flag">altgraph flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-meta-flag" id="ref-for-keyboardevent-meta-flag">meta flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-capslock-flag" id="ref-for-keyboardevent-capslock-flag">capslock flag</a></p>
        <li data-md>
         <p>Unset <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-numlock-flag" id="ref-for-keyboardevent-numlock-flag">numlock flag</a></p>
       </ol>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="create-a-keyboardevent">
     <h3 class="heading settled" data-level="10.4" id="create a keyboardevent"><span class="secno">10.4. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-keyboardevent">create a KeyboardEvent</dfn></span><a class="self-link" href="#create%20a%20keyboardevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①②">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>e</var> = the result of <a href="https://dom.spec.whatwg.org/#concept-event-create">creating a new event</a> using <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#keyboardevent" id="ref-for-keyboardevent③">KeyboardEvent</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-keyboardevent" id="ref-for-initialize-a-keyboardevent">Initialize a KeyboardEvent</a> with <var>e</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Return <var>e</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="set-event-modifiers">
     <h3 class="heading settled" data-level="10.5" id="set event modifiers"><span class="secno">10.5. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="set-event-modifiers">set event modifiers</dfn></span><a class="self-link" href="#set%20event%20modifiers"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#keyboardevent" id="ref-for-keyboardevent④">KeyboardEvent</a></code> or <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent⑥">MouseEvent</a></code> to update</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="issue" id="issue-359c7cda"><a class="self-link" href="#issue-359c7cda"></a> eval: ScrollLock, Hyper, Super, and (for virtual keyboards) Symbol, SymbolLock</p>
     <ol>
      <li data-md>
       <p>Set <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-shift-flag" id="ref-for-keyboardevent-shift-flag①">shift flag</a> if <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state">key modifier state</a> includes "Shift", unset it otherwise</p>
      <li data-md>
       <p>Set <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-control-flag" id="ref-for-keyboardevent-control-flag①">control flag</a> if <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state①">key modifier state</a> includes "Control", unset it otherwise</p>
      <li data-md>
       <p>Set <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-alt-flag" id="ref-for-keyboardevent-alt-flag①">alt flag</a> if <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state②">key modifier state</a> includes "Alt", unset it otherwise</p>
      <li data-md>
       <p>Set <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-altgraph-flag" id="ref-for-keyboardevent-altgraph-flag①">altgraph flag</a> if <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state③">key modifier state</a> includes "AltGraph", unset it otherwise</p>
      <li data-md>
       <p>Set <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-meta-flag" id="ref-for-keyboardevent-meta-flag①">meta flag</a> if <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state④">key modifier state</a> includes "Meta", unset it otherwise</p>
      <li data-md>
       <p>Set <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-capslock-flag" id="ref-for-keyboardevent-capslock-flag①">capslock flag</a> if <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state⑤">key modifier state</a> includes "CapsLock", unset it otherwise</p>
      <li data-md>
       <p>Set <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-numlock-flag" id="ref-for-keyboardevent-numlock-flag①">numlock flag</a> if <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state⑥">key modifier state</a> includes "NumLock", unset it otherwise</p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-shiftkey" id="ref-for-dom-keyboardevent-shiftkey①">shiftKey</a></code> = true if the event’s <a data-link-type="dfn" href="#keyboardevent-shift-flag" id="ref-for-keyboardevent-shift-flag②">shift flag</a> is set, false otherwise</p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-ctrlkey" id="ref-for-dom-keyboardevent-ctrlkey①">ctrlKey</a></code> = true if the event’s <a data-link-type="dfn" href="#keyboardevent-control-flag" id="ref-for-keyboardevent-control-flag②">control flag</a> is set, false otherwise</p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-altkey" id="ref-for-dom-keyboardevent-altkey①">altKey</a></code> = true if the event’s <a data-link-type="dfn" href="#keyboardevent-alt-flag" id="ref-for-keyboardevent-alt-flag②">alt flag</a> or <a data-link-type="dfn" href="#keyboardevent-altgraph-flag" id="ref-for-keyboardevent-altgraph-flag②">altgraph flag</a> is set, false otherwise</p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-metakey" id="ref-for-dom-keyboardevent-metakey①">metaKey</a></code> = true if the event’s <a data-link-type="dfn" href="#keyboardevent-meta-flag" id="ref-for-keyboardevent-meta-flag②">meta flag</a> is set, false otherwise</p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="set-keyboardevent-attributes">
     <h3 class="heading settled" data-level="10.6" id="set keyboardevent attributes"><span class="secno">10.6. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="set-keyboardevent-attributes">set KeyboardEvent attributes</dfn></span><a class="self-link" href="#set%20keyboardevent%20attributes"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#keyboardevent" id="ref-for-keyboardevent⑤">KeyboardEvent</a></code> to initialize</p>
      <dd data-md>
       <p><var>nativeKey</var>, native key info</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Set the following public attributes</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-key" id="ref-for-dom-keyboardevent-key①">key</a></code> = the key attribute value for this key press</p>
         <p class="issue" id="issue-d5cc0d9d"><a class="self-link" href="#issue-d5cc0d9d"></a> Needs more formal description of non-printable characters</p>
         <p class="issue" id="issue-2200ddf1"><a class="self-link" href="#issue-2200ddf1"></a> Need to include description of how AltGraph should be handled.
See <a href="https://github.com/w3c/uievents/issues/147">uievents/147</a></p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-code" id="ref-for-dom-keyboardevent-code①">code</a></code> = the key code attribute value corresponding to the physical
key that was pressed.</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-location" id="ref-for-dom-keyboardevent-location①">location</a></code> = the result of <a data-link-type="dfn" href="#calculate-key-location" id="ref-for-calculate-key-location">calculate key location</a> with <var>event</var>.code</p>
        <li data-md>
         <p>if <var>nativeKey</var> indicates that this is a repeat key event</p>
         <ol>
          <li data-md>
           <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-repeat" id="ref-for-dom-keyboardevent-repeat①">repeat</a></code></p>
         </ol>
        <li data-md>
         <p><a data-link-type="dfn" href="#set-event-modifiers" id="ref-for-set-event-modifiers①">set event modifiers</a> with <var>event</var></p>
       </ol>
      <li data-md>
       <p>Set the following historical attributes</p>
       <p class="issue" id="issue-40bc3077"><a class="self-link" href="#issue-40bc3077"></a> TODO: For historical reasons, we can’t have a formal description of these
fields without recognizing that certain UAs produce different values.</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-keycode" id="ref-for-dom-keyboardevent-keycode①">keyCode</a></code> = ???</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#dom-keyboardevent-charcode" id="ref-for-dom-keyboardevent-charcode①">charCode</a></code> = ???</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-which" id="ref-for-dom-keyboardevent-which①">which</a></code> = ???</p>
       </ol>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="calculate-key-location">
     <h3 class="heading settled" data-level="10.7" id="calculate key locationinitialize a keyboardevent"><span class="secno">10.7. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="calculate-key-location">calculate key location</dfn></span><a class="self-link" href="#calculate%20key%20locationinitialize%20a%20keyboardevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>code</var>, the <code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-code" id="ref-for-dom-keyboardevent-code②">code</a></code> for the key</p>
      <dt data-md>Output
      <dd data-md>
       <p>The DOM key location for the specified key</p>
     </dl>
     <ol>
      <li data-md>
       <p>If <var>code</var> is any of [ "AltLeft", "ControlLeft", "MetaLeft", "ShiftLeft"], then</p>
       <ol>
        <li data-md>
         <p>return <code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-dom_key_location_left" id="ref-for-dom-keyboardevent-dom_key_location_left">DOM_KEY_LOCATION_LEFT</a></code></p>
       </ol>
      <li data-md>
       <p>If <var>code</var> is any of [ "AltRight", "ControlRight", "MetaRight", "ShiftRight"], then</p>
       <ol>
        <li data-md>
         <p>return <code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-dom_key_location_right" id="ref-for-dom-keyboardevent-dom_key_location_right">DOM_KEY_LOCATION_RIGHT</a></code></p>
       </ol>
      <li data-md>
       <p>If <var>code</var> matches any of the values in the <a href="https://www.w3.org/TR/uievents-code/#key-numpad-section">numpad section</a>, then</p>
       <ol>
        <li data-md>
         <p>return <code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-dom_key_location_numpad" id="ref-for-dom-keyboardevent-dom_key_location_numpad">DOM_KEY_LOCATION_NUMPAD</a></code></p>
       </ol>
      <li data-md>
       <p>return <code class="idl"><a data-link-type="idl" href="#dom-keyboardevent-dom_key_location_standard" id="ref-for-dom-keyboardevent-dom_key_location_standard①">DOM_KEY_LOCATION_STANDARD</a></code></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="get-modifier-state">
     <h3 class="heading settled" data-level="10.8" id="get modifier state"><span class="secno">10.8. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="get-modifier-state">get modifier state</dfn></span><a class="self-link" href="#get%20modifier%20state"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#keyboardevent" id="ref-for-keyboardevent⑥">KeyboardEvent</a></code> to initialize</p>
      <dd data-md>
       <p><var>modifier</var>, a DOMString containing the name of the modifier key</p>
      <dt data-md>Output
      <dd data-md>
       <p>True if the modifier is currently set, false otherwise</p>
     </dl>
     <ol>
      <li data-md>
       <p>If <var>modifier</var> is "Shift", then return true if <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-shift-flag" id="ref-for-keyboardevent-shift-flag③">shift flag</a> is set</p>
      <li data-md>
       <p>If <var>modifier</var> is "Control", then return true if <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-control-flag" id="ref-for-keyboardevent-control-flag③">control flag</a> is set</p>
      <li data-md>
       <p>If <var>modifier</var> is "Alt", then return true if <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-alt-flag" id="ref-for-keyboardevent-alt-flag③">alt flag</a> is set</p>
      <li data-md>
       <p>If <var>modifier</var> is "AltGraph", then return true if <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-altgraph-flag" id="ref-for-keyboardevent-altgraph-flag③">altgraph flag</a> is set</p>
      <li data-md>
       <p>If <var>modifier</var> is "Meta", then return true if <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-meta-flag" id="ref-for-keyboardevent-meta-flag③">meta flag</a> is set</p>
      <li data-md>
       <p>If <var>modifier</var> is "CapsLock", then return true if <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-capslock-flag" id="ref-for-keyboardevent-capslock-flag②">capslock flag</a> is set</p>
      <li data-md>
       <p>If <var>modifier</var> is "NumLock", then return true if <var>event</var>’s <a data-link-type="dfn" href="#keyboardevent-numlock-flag" id="ref-for-keyboardevent-numlock-flag②">numlock flag</a> is set</p>
      <li data-md>
       <p>Return false</p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-pre-browser-key">
     <h3 class="heading settled" data-level="10.9" id="handle pre browser key"><span class="secno">10.9. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-pre-browser-key">handle pre browser key</dfn></span><a class="self-link" href="#handle%20pre%20browser%20key"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>key</var>, basic info about the key</p>
      <dt data-md>Output
      <dd data-md>
       <p>True is the User Agent has already handled this key</p>
     </dl>
     <ol>
      <li data-md>
       <p>If <a data-link-type="dfn" href="#keyboard-lock-is-enabled" id="ref-for-keyboard-lock-is-enabled">Keyboard Lock is enabled</a>, then return false</p>
       <p class="note" role="note"><span class="marker">Note:</span> Keyboard Lock is not an official standard. This is demonstrating
how it might be integrated.</p>
     </ol>
     <p class="issue" id="issue-95f8c21d"><a class="self-link" href="#issue-95f8c21d"></a> These key shortcuts are defined by the User Agent  (e.g., Cmd-T on Mac).
    They should be defined in such a way that the UA is in control.</p>
     <p class="issue" id="issue-ab1accc3"><a class="self-link" href="#issue-ab1accc3"></a> Need a more complete list of these pre-keydown browser keys, or a better description
    of the sort of keys the UA handles.</p>
     <ol>
      <li data-md>
       <p>If <var>key</var> is the shortcut to create a new tab, then</p>
       <ol>
        <li data-md>
         <p>Create a new tab</p>
        <li data-md>
         <p>Return true</p>
       </ol>
      <li data-md>
       <p>If <var>key</var> is the shortcut to close a window, then</p>
       <ol>
        <li data-md>
         <p>Close the current tab</p>
        <li data-md>
         <p>Return true</p>
       </ol>
     </ol>
     <p class="issue" id="issue-3845ba6b"><a class="self-link" href="#issue-3845ba6b"></a> IME is often provided by the native OS. So the requirements need to be
    defined and added to the <a href="#req-ime">IME Requirements</a> section.</p>
     <p class="issue" id="issue-93e6f32f"><a class="self-link" href="#issue-93e6f32f"></a> How should IME keys be represented. We need the native OS to call <a data-link-type="dfn" href="#enter-composition-mode" id="ref-for-enter-composition-mode">enter composition mode</a> and <a data-link-type="dfn" href="#exit-composition-mode" id="ref-for-exit-composition-mode">exit composition mode</a></p>
     <p class="issue" id="issue-d744c6c4"><a class="self-link" href="#issue-d744c6c4"></a> When should <a data-link-type="dfn" href="#begin-composition" id="ref-for-begin-composition">begin composition</a> be called? How should that be hooked with
    the native IME calls.</p>
     <ol>
      <li data-md>
       <p>Return false</p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-post-browser-key">
     <h3 class="heading settled" data-level="10.10" id="handle post browser key"><span class="secno">10.10. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-post-browser-key">handle post browser key</dfn></span><a class="self-link" href="#handle%20post%20browser%20key"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>key</var>, basic info about the key</p>
      <dt data-md>Output
      <dd data-md>
       <p>True is the User Agent has already handled this key</p>
     </dl>
     <ol>
      <li data-md>
       <p>If <a data-link-type="dfn" href="#keyboard-lock-is-enabled" id="ref-for-keyboard-lock-is-enabled①">Keyboard Lock is enabled</a>, then return false</p>
       <p class="issue" id="issue-713be494"><a class="self-link" href="#issue-713be494"></a> Placeholder until there’s an actual agreed-upon definition for Keyboard Lock.</p>
      <li data-md>
       <p>If <var>key</var> is:</p>
       <ol>
        <li data-md>
         <p>The shortcut to cut (e.g., ctrl-x), then <a data-link-type="dfn" href="#handle-native-cut" id="ref-for-handle-native-cut①">Handle native cut</a></p>
        <li data-md>
         <p>The shortcut to copy (e.g., ctrl-c), then <a data-link-type="dfn" href="#handle-native-copy" id="ref-for-handle-native-copy①">Handle native copy</a></p>
        <li data-md>
         <p>The shortcut to paste (e.g., ctrl-v), then <a data-link-type="dfn" href="#handle-native-paste" id="ref-for-handle-native-paste①">Handle native paste</a></p>
         <p class="issue" id="issue-9a62a3b5"><a class="self-link" href="#issue-9a62a3b5"></a> Need more complete set of post-keydown browser keys. Perhaps define
a set of common browser keys (clipboard, open/close tabs, quit).</p>
        <li data-md>
         <p>And then return true</p>
       </ol>
      <li data-md>
       <p>Return false</p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-native-key-down">
     <h3 class="heading settled" data-level="10.11" id="handle native key down"><span class="secno">10.11. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-native-key-down">handle native key down</dfn></span><a class="self-link" href="#handle%20native%20key%20down"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>nativeKey</var>, native key info</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Update global modifier key state</p>
      <li data-md>
       <p>If <var>nativKey</var> is left or right Shift key, then add "Shift" to <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state⑦">key modifier state</a></p>
      <li data-md>
       <p>If <var>nativKey</var> is left or right Control key, then add "Control" to <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state⑧">key modifier state</a></p>
      <li data-md>
       <p>If <var>nativKey</var> is left or right Alt key, then add "Alt" to <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state⑨">key modifier state</a></p>
      <li data-md>
       <p>If <var>nativKey</var> is AltGraph key, then add "AltGraph" to <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state①⓪">key modifier state</a></p>
      <li data-md>
       <p>If <var>nativKey</var> is left or right Meta key, then add "Meta" to <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state①①">key modifier state</a></p>
      <li data-md>
       <p>If <a data-link-type="dfn" href="#handle-pre-browser-key" id="ref-for-handle-pre-browser-key">handle pre browser key</a> with <var>nativeKey</var>, then</p>
       <p class="note" role="note"><span class="marker">Note:</span> Chrome/Firefox handle some BrowserKeys before generating keydown events.
Tested with ctrl-t (to create new tab)</p>
       <ol>
        <li data-md>
         <p>exit</p>
       </ol>
      <li data-md>
       <p>Let target = <a href="https://html.spec.whatwg.org/#currently-focused-area-of-a-top-level-browsing-context">currently focused area of a top-level browsing context</a></p>
      <li data-md>
       <p>Let <var>event</var> = result of <a data-link-type="dfn" href="#create-a-keyboardevent" id="ref-for-create-a-keyboardevent">create a KeyboardEvent</a> with "keydown", <var>target</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#set-keyboardevent-attributes" id="ref-for-set-keyboardevent-attributes">set KeyboardEvent attributes</a> with <var>event</var>, <var>nativeKey</var></p>
      <li data-md>
       <p>Let <var>result</var> = <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①②">dispatch</a> <var>event</var> at <var>target</var></p>
       <p class="note" role="note"><span class="marker">Note:</span> when in composition, canceling the keydown has no effect
(tested: macOS Chrome; TODO: test other configs)</p>
      <li data-md>
       <p>If the <a data-link-type="dfn" href="#in-composition-flag" id="ref-for-in-composition-flag">in composition flag</a> is set, then</p>
       <ol>
        <li data-md>
         <p><a data-link-type="dfn" href="#handle-composition-key" id="ref-for-handle-composition-key">handle composition key</a> and exit</p>
       </ol>
      <li data-md>
       <p>Unset the <a data-link-type="dfn" href="#suppress-key-input-events-flag" id="ref-for-suppress-key-input-events-flag①">suppress key input events flag</a></p>
      <li data-md>
       <p>If <var>result</var> = false, then</p>
       <ol>
        <li data-md>
         <p>Set the <a data-link-type="dfn" href="#suppress-key-input-events-flag" id="ref-for-suppress-key-input-events-flag②">suppress key input events flag</a></p>
       </ol>
      <li data-md>
       <p>If native platform has separate CHAR event, then</p>
       <p class="issue" id="issue-41fee8f3"><a class="self-link" href="#issue-41fee8f3"></a> Is this check necessary?
Can native CHAR events be ignored or do they contain needed info?</p>
       <ol>
        <li data-md>
         <p>Exit  (because CHAR event will trigger <a data-link-type="dfn" href="#handle-native-key-press" id="ref-for-handle-native-key-press①">handle native key press</a>)</p>
       </ol>
     </ol>
     <ol>
      <li data-md>
       <p>Call <a data-link-type="dfn" href="#handle-native-key-press" id="ref-for-handle-native-key-press②">handle native key press</a> with <var>nativeKey</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-native-key-up">
     <h3 class="heading settled" data-level="10.12" id="handle native key up"><span class="secno">10.12. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-native-key-up">handle native key up</dfn></span><a class="self-link" href="#handle%20native%20key%20up"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>nativeKey</var>, native key info</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Update global modifier key state</p>
       <ol>
        <li data-md>
         <p>If <var>nativeKey</var> is left or right Shift key, then remove "Shift" to <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state①②">key modifier state</a></p>
        <li data-md>
         <p>If <var>nativeKey</var> is left or right Control key, then remove "Control" to <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state①③">key modifier state</a></p>
        <li data-md>
         <p>If <var>nativeKey</var> is left or right Alt key, then remove "Alt" to <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state①④">key modifier state</a></p>
        <li data-md>
         <p>If <var>nativeKey</var> is AltGraph key, then remove "AltGraph" to <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state①⑤">key modifier state</a></p>
        <li data-md>
         <p>If <var>nativeKey</var> is left or right Meta key, then remove "Meta" to <a data-link-type="dfn" href="#key-modifier-state" id="ref-for-key-modifier-state①⑥">key modifier state</a></p>
       </ol>
      <li data-md>
       <p>Let target = <a href="https://html.spec.whatwg.org/#currently-focused-area-of-a-top-level-browsing-context">currently focused area of a top-level browsing context</a></p>
      <li data-md>
       <p>Let <var>event</var> = result of <a data-link-type="dfn" href="#create-a-keyboardevent" id="ref-for-create-a-keyboardevent①">create a KeyboardEvent</a> with "keyup", <var>target</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#set-keyboardevent-attributes" id="ref-for-set-keyboardevent-attributes①">set KeyboardEvent attributes</a> with <var>event</var>, <var>nativeKey</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①③">dispatch</a> <var>event</var> at <var>target</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-native-key-press">
     <h3 class="heading settled" data-level="10.13" id="handle native key press"><span class="secno">10.13. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-native-key-press">handle native key press</dfn></span><a class="self-link" href="#handle%20native%20key%20press"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>nativeKey</var>, native key info</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="note" role="note"><span class="marker">Note:</span> This may be called directly if the native platform generates CHAR events that
    are separate from keydown events. Or it may be called from <a data-link-type="dfn" href="#handle-native-key-down" id="ref-for-handle-native-key-down①">handle native key down</a>.</p>
     <ol>
      <li data-md>
       <p>If <a data-link-type="dfn" href="#composition-mode-flag" id="ref-for-composition-mode-flag">composition mode flag</a> is set, then</p>
       <ol>
        <li data-md>
         <p><a data-link-type="dfn" href="#handle-composition-key" id="ref-for-handle-composition-key①">Handle composition key</a> with <var>nativeKey</var></p>
        <li data-md>
         <p>Exit</p>
       </ol>
      <li data-md>
       <p>If <a data-link-type="dfn" href="#handle-post-browser-key" id="ref-for-handle-post-browser-key">handle post browser key</a>, then exit</p>
      <li data-md>
       <p>Let <var>target</var> = <a href="https://html.spec.whatwg.org/#currently-focused-area-of-a-top-level-browsing-context">currently focused area of a top-level browsing context</a></p>
       <p class="issue" id="issue-beb23471"><a class="self-link" href="#issue-beb23471"></a> What should happen if the event focus has changed since the keydown event?
What is the appropriate target for the keyup? The current focus or the previous?
Are there security issues (e.g., if it’s not safe to edit the current focus)?</p>
      <li data-md>
       <p>Let <var>key</var> = extract info from <var>nativeKey</var></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#fire-key-input-events" id="ref-for-fire-key-input-events">Fire key input events</a> with <var>key</var> and <var>target</var></p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="11" id="composition event"><span class="secno">11. </span><span class="content">Composition Event</span><a class="self-link" href="#composition%20event"></a></h2>
    <h3 class="heading settled" data-level="11.1" id="compositionevent-global-state"><span class="secno">11.1. </span><span class="content">Global State for CompositionEvent</span><a class="self-link" href="#compositionevent-global-state"></a></h3>
    <h4 class="heading settled" data-level="11.1.1" id="compositionevent-global-window"><span class="secno">11.1.1. </span><span class="content">Window-Level State</span><a class="self-link" href="#compositionevent-global-window"></a></h4>
    <p>The UA must maintain the following values that are shared for the Window.</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="composition-mode-flag">composition mode flag</dfn> (initially false) that is set if the native
    IME is enabled and the next key press will trigger compositionstart.</p>
    <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="in-composition-flag">in composition flag</dfn> (initially false) that tracks if the system is currently
    in the middle of input composition (i.e., after <a data-link-type="dfn" href="https://www.w3.org/TR/uievents/#compositionstart" id="ref-for-compositionstart">compositionstart</a> but before <a data-link-type="dfn" href="https://www.w3.org/TR/uievents/#compositionend" id="ref-for-compositionend">compositionend</a>).</p>
    <div class="algorithm" data-algorithm="initialize-a-compositionevent">
     <h3 class="heading settled" data-level="11.2" id="initialize a compositionevent"><span class="secno">11.2. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="initialize-a-compositionevent">initialize a CompositionEvent</dfn></span><a class="self-link" href="#initialize%20a%20compositionevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>e</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event⑤">Event</a></code> to initialize</p>
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①③">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-uievent" id="ref-for-initialize-a-uievent⑤">Initialize a UIEvent</a> with <var>e</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Initialize the following public attributes</p>
       <ol>
        <li data-md>
         <p>Set event.data = ""</p>
         <p class="note" role="note"><span class="marker">Note:</span> This attribute has the same name as an attribute in InputEvent.</p>
       </ol>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="create-a-compositionevent">
     <h3 class="heading settled" data-level="11.3" id="create a compositionevent"><span class="secno">11.3. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-compositionevent">create a CompositionEvent</dfn></span><a class="self-link" href="#create%20a%20compositionevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①④">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>e</var> = the result of <a href="https://dom.spec.whatwg.org/#concept-event-create">creating a new event</a> using <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#compositionevent" id="ref-for-compositionevent">CompositionEvent</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-compositionevent" id="ref-for-initialize-a-compositionevent">Initialize a CompositionEvent</a> with <var>e</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Return <var>e</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="fire-a-compositionevent">
     <h3 class="heading settled" data-level="11.4" id="fire a compositionevent"><span class="secno">11.4. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="fire-a-compositionevent">fire a CompositionEvent</dfn></span><a class="self-link" href="#fire%20a%20compositionevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>data</var>, a DOMString containing event data</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let target = <a href="https://html.spec.whatwg.org/#currently-focused-area-of-a-top-level-browsing-context">currently focused area of a top-level browsing context</a></p>
       <p class="issue" id="issue-82843cb4"><a class="self-link" href="#issue-82843cb4"></a> The target for compositionstart should be determined by the element with
focus, but subsequent composition events should be fired on that same element.
Need to test what happens when focus changes during composition.
On the Mac, if you change focus, the composition target changes.
On Windows, behavior depends on the IME.</p>
      <li data-md>
       <p>Let <var>event</var> = result of <a data-link-type="dfn" href="#create-a-compositionevent" id="ref-for-create-a-compositionevent">create a CompositionEvent</a> with <var>eventType</var>, <var>target</var></p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#dom-compositionevent-data" id="ref-for-dom-compositionevent-data">data</a></code> = <var>data</var></p>
      <li data-md>
       <p>Return the result of <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①④">dispatch</a> <var>event</var> at <var>target</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="enter-composition-mode">
     <h3 class="heading settled" data-level="11.5" id="enter composition mode"><span class="secno">11.5. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="enter-composition-mode">enter composition mode</dfn></span><a class="self-link" href="#enter%20composition%20mode"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p>None</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="issue" id="issue-35af4a5a"><a class="self-link" href="#issue-35af4a5a"></a> This is an oversimplification. We need to native OS to call then when the user
    enters composition mode.</p>
     <ol>
      <li data-md>
       <p>Set the <a data-link-type="dfn" href="#composition-mode-flag" id="ref-for-composition-mode-flag①">composition mode flag</a></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="exit-composition-mode">
     <h3 class="heading settled" data-level="11.6" id="exit composition mode"><span class="secno">11.6. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="exit-composition-mode">exit composition mode</dfn></span><a class="self-link" href="#exit%20composition%20mode"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p>None</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="#end-composition" id="ref-for-end-composition">End composition</a></p>
      <li data-md>
       <p>Unset the <a data-link-type="dfn" href="#composition-mode-flag" id="ref-for-composition-mode-flag②">composition mode flag</a></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-composition-key">
     <h3 class="heading settled" data-level="11.7" id="handle composition key"><span class="secno">11.7. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-composition-key">handle composition key</dfn></span><a class="self-link" href="#handle%20composition%20key"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p>None</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="note" role="note"><span class="marker">Note:</span> This is called when a key is added to the composition buffer, or when the
    user navigates between composition options.</p>
     <p class="note" role="note"><span class="marker">Note:</span> This is where the IME handles the UI part to navigate the candidates or accept
    all or part of the text.
    Not sure how much (if any) of this makes sense to "specify" here since it is controlled by the IME.</p>
     <ol>
      <li data-md>
       <p>If special IME key, then</p>
      <li data-md>
       <p>If arrow, then select new candidate</p>
      <li data-md>
       <p>If enter, then accept the current candidate, run <a data-link-type="dfn" href="#end-composition" id="ref-for-end-composition①">end composition</a> and exit</p>
       <ol>
        <li data-md>
         <p>...</p>
       </ol>
     </ol>
     <p class="issue" id="issue-2d2dfa96"><a class="self-link" href="#issue-2d2dfa96"></a> Need agreement on event order for compositionupdate and beforeinput.
    Chrome currently does bi -> cu, whereas Safari does cu -> bi.
    Firefox doesn’t yet produce bi, but prefers cu -> bi.
    See <a href="https://github.com/w3c/input-events/issues/49">input-events/49</a> and <a href="https://github.com/w3c/uievents/issues/66">uievents/66</a></p>
     <ol>
      <li data-md>
       <p>Let <var>data</var> = the current composition candidate string</p>
      <li data-md>
       <p><a data-link-type="dfn" href="#fire-a-compositionevent" id="ref-for-fire-a-compositionevent①">Fire a CompositionEvent</a> with "compositionupdate" and <var>data</var></p>
       <p class="issue" id="issue-2170a384"><a class="self-link" href="#issue-2170a384"></a> Verify compositionupdate cannot be canceled</p>
      <li data-md>
       <p>Let <var>result</var> = <a data-link-type="dfn" href="#fire-an-inputevent" id="ref-for-fire-an-inputevent②">fire an InputEvent</a> with "beforeinput", "insertCompositionText" and <var>data</var></p>
       <p class="issue" id="issue-8be390f6"><a class="self-link" href="#issue-8be390f6"></a> Not all beforeinput events can be canceled - need to encode that here</p>
      <li data-md>
       <p>If <var>result</var> is true, then</p>
       <ol>
        <li data-md>
         <p>Update the DOM with the composition text</p>
        <li data-md>
         <p><a data-link-type="dfn" href="#fire-an-inputevent" id="ref-for-fire-an-inputevent③">Fire an InputEvent</a> with "input", "insertCompositionText" and <var>data</var></p>
         <p class="note" role="note"><span class="marker">Note:</span> Not cancelable</p>
       </ol>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="begin-composition">
     <h3 class="heading settled" data-level="11.8" id="begin composition"><span class="secno">11.8. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="begin-composition">begin composition</dfn></span><a class="self-link" href="#begin%20composition"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p>None</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>If <a data-link-type="dfn" href="#in-composition-flag" id="ref-for-in-composition-flag①">in composition flag</a>, then exit</p>
      <li data-md>
       <p>Let <var>data</var> = currently selected text</p>
      <li data-md>
       <p>Let <var>result</var> = <a data-link-type="dfn" href="#fire-a-compositionevent" id="ref-for-fire-a-compositionevent②">fire a CompositionEvent</a> with "compositionstart" and <var>data</var></p>
       <p class="issue" id="issue-e3eb5b91"><a class="self-link" href="#issue-e3eb5b91"></a> Document what happens when <var>result</var> is not true (event canceled)</p>
      <li data-md>
       <p>Set <a data-link-type="dfn" href="#in-composition-flag" id="ref-for-in-composition-flag②">in composition flag</a></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#handle-composition-key" id="ref-for-handle-composition-key②">Handle composition key</a></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="end-composition">
     <h3 class="heading settled" data-level="11.9" id="end composition"><span class="secno">11.9. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="end-composition">end composition</dfn></span><a class="self-link" href="#end%20composition"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p>None</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>If <a data-link-type="dfn" href="#in-composition-flag" id="ref-for-in-composition-flag③">in composition flag</a> is not set, then exit</p>
     </ol>
     <p class="issue" id="issue-11ce2a87"><a class="self-link" href="#issue-11ce2a87"></a> Compat: Chrome sends out beforeinput/compositionupdate/textInput/input sequence before
    compositionend (tested on macOS). Compare with Firefox.</p>
     <ol>
      <li data-md>
       <p>Set <var>result</var> = <a data-link-type="dfn" href="#fire-a-textevent①" id="ref-for-fire-a-textevent①①">fire a TextEvent</a> with "textInput", and <var>data</var></p>
       <p class="note" role="note"><span class="marker">Note:</span> The "textInput" event is obsolete.</p>
      <li data-md>
       <p>If <var>result</var> is false, then return.</p>
      <li data-md>
       <p class="issue" id="issue-a4437074"><a class="self-link" href="#issue-a4437074"></a> fire an input event here.</p>
      <li data-md>
       <p>Let <var>data</var> = the current composition candidate string</p>
      <li data-md>
       <p><a data-link-type="dfn" href="#fire-a-compositionevent" id="ref-for-fire-a-compositionevent③">fire a CompositionEvent</a> with "compositionend" and <var>data</var></p>
       <p class="issue" id="issue-acf5a28c"><a class="self-link" href="#issue-acf5a28c"></a> Document what to do with result</p>
      <li data-md>
       <p>If Firefox:</p>
       <p class="issue" id="issue-273f9f41"><a class="self-link" href="#issue-273f9f41"></a> Compat: Firefox sends input events after compositionend. Not sure when the
DOM is updated relative to compositionend (tested on macOS). Need to resolve this.</p>
       <ol>
        <li data-md>
         <p><a data-link-type="dfn" href="#fire-an-inputevent" id="ref-for-fire-an-inputevent④">Fire an InputEvent</a> with "input", "insertCompositionText" and <var>data</var></p>
       </ol>
      <li data-md>
       <p>Unset the <a data-link-type="dfn" href="#in-composition-flag" id="ref-for-in-composition-flag④">in composition flag</a></p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="12" id="pointer event"><span class="secno">12. </span><span class="content">Pointer Event</span><a class="self-link" href="#pointer%20event"></a></h2>
    <p class="issue" id="issue-6c0044ca"><a class="self-link" href="#issue-6c0044ca"></a> The contents of this section should eventually be moved into the PointerEvent spec.</p>
    <div class="algorithm" data-algorithm="initialize-a-pointerevent">
     <h3 class="heading settled" data-level="12.1" id="initialize a pointerevent"><span class="secno">12.1. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="initialize-a-pointerevent">initialize a PointerEvent</dfn></span><a class="self-link" href="#initialize%20a%20pointerevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/pointerevents/#dom-pointerevent" id="ref-for-dom-pointerevent">PointerEvent</a></code> to initialize</p>
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①⑤">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-mouseevent" id="ref-for-initialize-a-mouseevent①">Initialize a MouseEvent</a> with <var>event</var>, <var>eventType</var> and <var>eventTarget</var></p>
     </ol>
     <p class="issue" id="issue-b7cb6aa8"><a class="self-link" href="#issue-b7cb6aa8"></a> TODO - initialize the pointerevent attributes</p>
    </div>
    <div class="algorithm" data-algorithm="create-a-pointerevent">
     <h3 class="heading settled" data-level="12.2" id="create a pointerevent"><span class="secno">12.2. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-pointerevent">create a PointerEvent</dfn></span><a class="self-link" href="#create%20a%20pointerevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>eventTarget</var>, the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①⑥">EventTarget</a></code> of the event</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>event</var> = the result of <a href="https://dom.spec.whatwg.org/#concept-event-create">creating a new event</a> using <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/pointerevents/#dom-pointerevent" id="ref-for-dom-pointerevent①">PointerEvent</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-pointerevent" id="ref-for-initialize-a-pointerevent">Initialize a PointerEvent</a> with <var>event</var>, <var>eventType</var> and <var>eventTarget</var></p>
      <li data-md>
       <p>Return <var>event</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="create-pointerevent-from-mouseevent">
     <h3 class="heading settled" data-level="12.3" id="create pointerevent from mouseevent"><span class="secno">12.3. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-pointerevent-from-mouseevent">create PointerEvent from MouseEvent</dfn></span><a class="self-link" href="#create%20pointerevent%20from%20mouseevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>eventType</var>, a DOMString containing the event type</p>
      <dd data-md>
       <p><var>mouseevent</var>, the corresponding <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent⑦">MouseEvent</a></code></p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>event</var> = the result of <a href="https://dom.spec.whatwg.org/#concept-event-create">creating a new event</a> using <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/pointerevents/#dom-pointerevent" id="ref-for-dom-pointerevent②">PointerEvent</a></code></p>
      <li data-md>
       <p>Let <var>target</var> = <var>mouseevent</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-target" id="ref-for-dom-event-target①">target</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="#initialize-a-pointerevent" id="ref-for-initialize-a-pointerevent①">Initialize a PointerEvent</a> with <var>event</var>, <var>eventType</var> and <var>target</var></p>
      <li data-md>
       <p>Copy MouseEvent attributes from <var>mouseevent</var> into <var>event</var></p>
      <li data-md>
       <p>Return <var>event</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="maybe-send-pointerout-event">
     <h3 class="heading settled" data-level="12.4" id="maybe send pointerout event"><span class="secno">12.4. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="maybe-send-pointerout-event">maybe send pointerout event</dfn></span><a class="self-link" href="#maybe%20send%20pointerout%20event"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>mouseout</var>, the corresponding mouseout <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent⑧">MouseEvent</a></code></p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>pointerout</var> = <a data-link-type="dfn" href="#create-pointerevent-from-mouseevent" id="ref-for-create-pointerevent-from-mouseevent">create PointerEvent from MouseEvent</a> with "pointerout" and <var>mouseout</var></p>
      <li data-md>
       <p>Set pointerevent attributes</p>
       <p class="issue" id="issue-b7b1e314③"><a class="self-link" href="#issue-b7b1e314③"></a> TODO</p>
      <li data-md>
       <p>Let <var>target</var> = <var>mouseout</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-target" id="ref-for-dom-event-target②">target</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①⑤">dispatch</a> <var>pointerout</var> at <var>target</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="maybe-send-pointerleave-event">
     <h3 class="heading settled" data-level="12.5" id="maybe send pointerleave event"><span class="secno">12.5. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="maybe-send-pointerleave-event">maybe send pointerleave event</dfn></span><a class="self-link" href="#maybe%20send%20pointerleave%20event"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>mouseout</var>, the corresponding mouseout <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent⑨">MouseEvent</a></code></p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>pointerout</var> = <a data-link-type="dfn" href="#create-pointerevent-from-mouseevent" id="ref-for-create-pointerevent-from-mouseevent①">create PointerEvent from MouseEvent</a> with "pointerout" and <var>mouseout</var></p>
      <li data-md>
       <p>Set pointerevent attributes</p>
       <p class="issue" id="issue-b7b1e314④"><a class="self-link" href="#issue-b7b1e314④"></a> TODO</p>
      <li data-md>
       <p>Let <var>target</var> = <var>mouseout</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-target" id="ref-for-dom-event-target③">target</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①⑥">dispatch</a> <var>pointerout</var> at <var>target</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="maybe-send-pointerover-event">
     <h3 class="heading settled" data-level="12.6" id="maybe send pointerover event"><span class="secno">12.6. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="maybe-send-pointerover-event">maybe send pointerover event</dfn></span><a class="self-link" href="#maybe%20send%20pointerover%20event"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>mouseout</var>, the corresponding mouseout <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent①⓪">MouseEvent</a></code></p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>pointerout</var> = <a data-link-type="dfn" href="#create-pointerevent-from-mouseevent" id="ref-for-create-pointerevent-from-mouseevent②">create PointerEvent from MouseEvent</a> with "pointerout" and <var>mouseout</var></p>
      <li data-md>
       <p>Set pointerevent attributes</p>
       <p class="issue" id="issue-b7b1e314⑤"><a class="self-link" href="#issue-b7b1e314⑤"></a> TODO</p>
      <li data-md>
       <p>Let <var>target</var> = <var>mouseout</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-target" id="ref-for-dom-event-target④">target</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①⑦">dispatch</a> <var>pointerout</var> at <var>target</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="maybe-send-pointerenter-event">
     <h3 class="heading settled" data-level="12.7" id="maybe send pointerenter event"><span class="secno">12.7. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="maybe-send-pointerenter-event">maybe send pointerenter event</dfn></span><a class="self-link" href="#maybe%20send%20pointerenter%20event"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>mouseout</var>, the corresponding mouseout <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent①①">MouseEvent</a></code></p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>pointerout</var> = <a data-link-type="dfn" href="#create-pointerevent-from-mouseevent" id="ref-for-create-pointerevent-from-mouseevent③">create PointerEvent from MouseEvent</a> with "pointerout" and <var>mouseout</var></p>
      <li data-md>
       <p>Set pointerevent attributes</p>
       <p class="issue" id="issue-b7b1e314⑥"><a class="self-link" href="#issue-b7b1e314⑥"></a> TODO</p>
      <li data-md>
       <p>Let <var>target</var> = <var>mouseout</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-target" id="ref-for-dom-event-target⑤">target</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①⑧">dispatch</a> <var>pointerout</var> at <var>target</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="maybe-send-pointermove-event">
     <h3 class="heading settled" data-level="12.8" id="maybe send pointermove event"><span class="secno">12.8. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="maybe-send-pointermove-event">maybe send pointermove event</dfn></span><a class="self-link" href="#maybe%20send%20pointermove%20event"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>mouseout</var>, the corresponding mouseout <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent①②">MouseEvent</a></code></p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="issue" id="issue-db237ad4"><a class="self-link" href="#issue-db237ad4"></a> Can this send pointermove and pointerrawupdate? Or do we need 2 methods?</p>
     <p class="issue" id="issue-a521983e"><a class="self-link" href="#issue-a521983e"></a> What is needed to properly define how pointermove events are coalesced?</p>
     <ol>
      <li data-md>
       <p>Let <var>pointerout</var> = <a data-link-type="dfn" href="#create-pointerevent-from-mouseevent" id="ref-for-create-pointerevent-from-mouseevent④">create PointerEvent from MouseEvent</a> with "pointerout" and <var>mouseout</var></p>
      <li data-md>
       <p>Set pointerevent attributes</p>
       <p class="issue" id="issue-b7b1e314⑦"><a class="self-link" href="#issue-b7b1e314⑦"></a> TODO</p>
      <li data-md>
       <p>Let <var>target</var> = <var>mouseout</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-target" id="ref-for-dom-event-target⑥">target</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch①⑨">dispatch</a> <var>pointerout</var> at <var>target</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="maybe-send-pointerdown-event">
     <h3 class="heading settled" data-level="12.9" id="maybe send pointerdown event"><span class="secno">12.9. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="maybe-send-pointerdown-event">maybe send pointerdown event</dfn></span><a class="self-link" href="#maybe%20send%20pointerdown%20event"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>mouseout</var>, the corresponding mouseout <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent①③">MouseEvent</a></code></p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="issue" id="issue-ac02e1f6"><a class="self-link" href="#issue-ac02e1f6"></a> Unlike mousedown events, <a href="https://w3c.github.io/pointerevents/#the-pointerdown-event">pointerdown</a> events are not nested when multiple buttons are pressed.
    The MouseEvent is passed so that the fields can be copied into the PointerEvent.</p>
     <ol>
      <li data-md>
       <p>Let <var>pointerout</var> = <a data-link-type="dfn" href="#create-pointerevent-from-mouseevent" id="ref-for-create-pointerevent-from-mouseevent⑤">create PointerEvent from MouseEvent</a> with "pointerout" and <var>mouseout</var></p>
      <li data-md>
       <p>Set pointerevent attributes</p>
       <p class="issue" id="issue-b7b1e314⑧"><a class="self-link" href="#issue-b7b1e314⑧"></a> TODO</p>
      <li data-md>
       <p>Let <var>target</var> = <var>mouseout</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-target" id="ref-for-dom-event-target⑦">target</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch②⓪">dispatch</a> <var>pointerout</var> at <var>target</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="maybe-send-pointerup-event">
     <h3 class="heading settled" data-level="12.10" id="maybe send pointerup event"><span class="secno">12.10. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="maybe-send-pointerup-event">maybe send pointerup event</dfn></span><a class="self-link" href="#maybe%20send%20pointerup%20event"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>mouseout</var>, the corresponding mouseout <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent①④">MouseEvent</a></code></p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="issue" id="issue-571ee343"><a class="self-link" href="#issue-571ee343"></a> Unlike mouseup events, <a href="https://w3c.github.io/pointerevents/#the-pointerup-event">pointerup</a> events are not nested when multiple buttons are pressed.
    The MouseEvent is passed so that the fields can be copied into the PointerEvent.</p>
     <ol>
      <li data-md>
       <p>Let <var>pointerout</var> = <a data-link-type="dfn" href="#create-pointerevent-from-mouseevent" id="ref-for-create-pointerevent-from-mouseevent⑥">create PointerEvent from MouseEvent</a> with "pointerout" and <var>mouseout</var></p>
      <li data-md>
       <p>Set pointerevent attributes</p>
       <p class="issue" id="issue-b7b1e314⑨"><a class="self-link" href="#issue-b7b1e314⑨"></a> TODO</p>
      <li data-md>
       <p>Let <var>target</var> = <var>mouseout</var>.<code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-target" id="ref-for-dom-event-target⑧">target</a></code></p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-dispatch" id="ref-for-concept-event-dispatch②①">dispatch</a> <var>pointerout</var> at <var>target</var></p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="13" id="pointer lock"><span class="secno">13. </span><span class="content">Pointer Lock</span><a class="self-link" href="#pointer%20lock"></a></h2>
    <p class="issue" id="issue-972fa7f3"><a class="self-link" href="#issue-972fa7f3"></a> The contents of this section should eventually be moved into the <a data-link-type="biblio" href="#biblio-pointerlock" title="Pointer Lock">[PointerLock]</a> spec</p>
    <p class="note" role="note"><span class="marker">Note:</span> The algorithms here are an oversimplification since they don’t account for the lock/unlock
state the or the pointer leaving and re-entering the UA screen boundaries.
That should be fixed as part of moving this section to the PointerLock spec.</p>
    <h3 class="heading settled" data-level="13.1" id="pointerlock-interface"><span class="secno">13.1. </span><span class="content">MouseEvent Interface Extension</span><a class="self-link" href="#pointerlock-interface"></a></h3>
    <p>A <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent①⑤">MouseEvent</a></code> has the following:</p>
    <dl>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-movementx"><code>movementX</code></dfn>
     <li><dfn class="dfn-paneled idl-code" data-dfn-for="MouseEvent" data-dfn-type="attribute" data-export id="dom-mouseevent-movementy"><code>movementY</code></dfn>
    </dl>
    <h3 class="heading settled" data-level="13.2" id="pointer-lock-global-state"><span class="secno">13.2. </span><span class="content">Global State for PointerLock</span><a class="self-link" href="#pointer-lock-global-state"></a></h3>
    <h4 class="heading settled" data-level="13.2.1" id="pointer-lock-global-window"><span class="secno">13.2.1. </span><span class="content">Window-Level State</span><a class="self-link" href="#pointer-lock-global-window"></a></h4>
    <p>The UA must maintain the following values that are shared for the Window.</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="last-mouse-move">last mouse move</dfn> value (initially undefined) that records the position of the
    last mousemove event.</p>
    <div class="algorithm" data-algorithm="initialize-pointerlock-attributes-for-mouseevent">
     <h3 class="heading settled" data-level="13.3" id="initialize pointerlock attributes for mouseevent"><span class="secno">13.3. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="initialize-pointerlock-attributes-for-mouseevent">initialize PointerLock attributes for MouseEvent</dfn></span><a class="self-link" href="#initialize%20pointerlock%20attributes%20for%20mouseevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent①⑥">MouseEvent</a></code></p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-movementx" id="ref-for-dom-mouseevent-movementx">movementX</a></code> = 0</p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-movementy" id="ref-for-dom-mouseevent-movementy">movementY</a></code> = 0</p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="set-pointerlock-attributes-for-mousemove">
     <h3 class="heading settled" data-level="13.4" id="set pointerlock attributes for mousemove"><span class="secno">13.4. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="set-pointerlock-attributes-for-mousemove">set PointerLock attributes for mousemove</dfn></span><a class="self-link" href="#set%20pointerlock%20attributes%20for%20mousemove"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent①⑦">MouseEvent</a></code></p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>If <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type" id="ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type②">type</a></code> is not "mousemove", then exit</p>
      <li data-md>
       <p>If <a data-link-type="dfn" href="#last-mouse-move" id="ref-for-last-mouse-move">last mouse move</a> is not defined, then</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-movementx" id="ref-for-dom-mouseevent-movementx①">movementX</a></code> = 0</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-movementy" id="ref-for-dom-mouseevent-movementy①">movementY</a></code> = 0</p>
       </ol>
      <li data-md>
       <p>Otherwise,</p>
       <ol>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-movementx" id="ref-for-dom-mouseevent-movementx②">movementX</a></code> = <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-screenx" id="ref-for-dom-mouseevent-screenx③">screenX</a></code> - <a data-link-type="dfn" href="#last-mouse-move" id="ref-for-last-mouse-move①">last mouse move</a>’s x-coordinate</p>
        <li data-md>
         <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-movementy" id="ref-for-dom-mouseevent-movementy②">movementY</a></code> = <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-screenx" id="ref-for-dom-mouseevent-screenx④">screenX</a></code> - <a data-link-type="dfn" href="#last-mouse-move" id="ref-for-last-mouse-move②">last mouse move</a>’s y-coordinate</p>
       </ol>
      <li data-md>
       <p>Set <a data-link-type="dfn" href="#last-mouse-move" id="ref-for-last-mouse-move③">last mouse move</a> = ( <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-screenx" id="ref-for-dom-mouseevent-screenx⑤">screenX</a></code>, <var>event</var>.<code class="idl"><a data-link-type="idl" href="#dom-mouseevent-screeny" id="ref-for-dom-mouseevent-screeny③">screenY</a></code> )</p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="14" id="keyboard lock"><span class="secno">14. </span><span class="content">Keyboard Lock</span><a class="self-link" href="#keyboard%20lock"></a></h2>
    <p class="issue" id="issue-37fef50b"><a class="self-link" href="#issue-37fef50b"></a> KeyboardLock is not yet an accepted standard and is included here as a placeholder
to explore how it might be integrated.</p>
    <p class="issue" id="issue-4d0ba757"><a class="self-link" href="#issue-4d0ba757"></a> The contents of this section should eventually be moved into the <a data-link-type="biblio" href="#biblio-wicg-keyboard-lock" title="Keyboard Lock">[WICG-Keyboard-Lock]</a> spec</p>
    <h3 class="heading settled" data-level="14.1" id="keyboard-lock-global-state"><span class="secno">14.1. </span><span class="content">Global State for Keyboard Lock</span><a class="self-link" href="#keyboard-lock-global-state"></a></h3>
    <h4 class="heading settled" data-level="14.1.1" id="keyboard-lock-global-ua"><span class="secno">14.1.1. </span><span class="content">User Agent-Level State</span><a class="self-link" href="#keyboard-lock-global-ua"></a></h4>
    <p>The UA must maintain the following values that are shared for the entire
    User Agent.</p>
    <p class="issue" id="issue-b7b1e314①⓪"><a class="self-link" href="#issue-b7b1e314①⓪"></a> TODO</p>
    <h4 class="heading settled" data-level="14.1.2" id="keyboard-lock-global-window"><span class="secno">14.1.2. </span><span class="content">Window-Level State</span><a class="self-link" href="#keyboard-lock-global-window"></a></h4>
    <p>The UA must maintain the following values that are shared for the Window.</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="keyboard-lock-enable-flag">keyboard lock enable flag</dfn> (initially false) that tracks whether Keyboard
    Lock is currently enabled.</p>
    <div class="algorithm" data-algorithm="keyboard-lock-is-enabled">
     <h3 class="heading settled" data-level="14.2" id="keyboard lock is enabled"><span class="secno">14.2. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="keyboard-lock-is-enabled">Keyboard Lock is enabled</dfn></span><a class="self-link" href="#keyboard%20lock%20is%20enabled"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p>None</p>
      <dt data-md>Output
      <dd data-md>
       <p>True if keyboard lock is enabled.</p>
     </dl>
     <ol>
      <li data-md>
       <p>Return <a data-link-type="dfn" href="#keyboard-lock-enable-flag" id="ref-for-keyboard-lock-enable-flag">keyboard lock enable flag</a></p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="15" id="core dom"><span class="secno">15. </span><span class="content">Core DOM</span><a class="self-link" href="#core%20dom"></a></h2>
    <p class="issue" id="issue-65045046"><a class="self-link" href="#issue-65045046"></a> These definitions probably belong in another spec.</p>
    <div class="algorithm" data-algorithm="hit-test">
     <h3 class="heading settled" data-level="15.1" id="hit test"><span class="secno">15.1. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="hit-test">hit test</dfn></span><a class="self-link" href="#hit%20test"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>pos</var>, the x,y coordinates relative to the viewport</p>
      <dt data-md>Output
      <dd data-md>
       <p>The frontmost DOM element at <var>pos</var></p>
     </dl>
     <p class="issue" id="issue-d31c8856"><a class="self-link" href="#issue-d31c8856"></a> To account for <a href="https://html.spec.whatwg.org/#inert">inert</a> or <a href="https://html.spec.whatwg.org/#concept-fe-disabled">disabled</a> elements. this should call <a data-link-type="dfn" href="https://www.w3.org/TR/cssom-view-1/#dom-document-elementfrompoint" id="ref-for-dom-document-elementfrompoint">elementsFromPoint</a> and reject
    invalid elements</p>
     <ol>
      <li data-md>
       <p>Return <a data-link-type="biblio" href="#biblio-cssom-view" title="CSSOM View Module">[CSSOM-View]</a>'s <a data-link-type="dfn" href="https://www.w3.org/TR/cssom-view-1/#dom-document-elementfrompoint" id="ref-for-dom-document-elementfrompoint①">elementFromPoint</a> with <var>pos</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="calculate-dom-path">
     <h3 class="heading settled" data-level="15.2" id="calculate dom path"><span class="secno">15.2. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="calculate-dom-path">calculate DOM path</dfn></span><a class="self-link" href="#calculate%20dom%20path"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>element</var>, the starting element</p>
      <dt data-md>Output
      <dd data-md>
       <p>The list of ancestor elements for the given element</p>
     </dl>
     <ol>
      <li data-md>
       <p>Let <var>path</var> = A list that contains <var>element</var></p>
     </ol>
     <p class="issue" id="issue-b8797d0c"><a class="self-link" href="#issue-b8797d0c"></a> This needs a proper definition to add ancestors to <var>path</var>.</p>
     <ol>
      <li data-md>
       <p>Return <var>path</var></p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="16" id="cssom"><span class="secno">16. </span><span class="content">CSSOM</span><a class="self-link" href="#cssom"></a></h2>
    <p class="issue" id="issue-2236bbea"><a class="self-link" href="#issue-2236bbea"></a> The contents of this section should eventually be moved into the <a data-link-type="biblio" href="#biblio-cssom" title="CSS Object Model (CSSOM)">[CSSOM]</a> spec</p>
    <div class="algorithm" data-algorithm="initialize-cssom-attributes-for-mouseevent">
     <h3 class="heading settled" data-level="16.1" id="initialize cssom attributes for mouseevent"><span class="secno">16.1. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="initialize-cssom-attributes-for-mouseevent">initialize CSSOM attributes for MouseEvent</dfn></span><a class="self-link" href="#initialize%20cssom%20attributes%20for%20mouseevent"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p><var>event</var>, a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/uievents/#mouseevent" id="ref-for-mouseevent①⑧">MouseEvent</a></code></p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <ol>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-pagex" id="ref-for-dom-mouseevent-pagex">pageX</a></code> according to <a href="https://www.w3.org/TR/cssom-view-1/#dom-mouseevent-pagex">pageX</a></p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-pagey" id="ref-for-dom-mouseevent-pagey">pageY</a></code> according to <a href="https://www.w3.org/TR/cssom-view-1/#dom-mouseevent-pagey">pageY</a></p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-x" id="ref-for-dom-mouseevent-x">x</a></code> according to <a href="https://www.w3.org/TR/cssom-view-1/#dom-mouseevent-x">x</a></p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-y" id="ref-for-dom-mouseevent-y">y</a></code> according to <a href="https://www.w3.org/TR/cssom-view-1/#dom-mouseevent-y">y</a></p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-offsetx" id="ref-for-dom-mouseevent-offsetx">offsetX</a></code> according to <a href="https://www.w3.org/TR/cssom-view-1/#dom-mouseevent-offsetx">offsetX</a></p>
      <li data-md>
       <p>Set <var>event</var>.<code class="idl"><a data-link-type="idl" href="https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-offsety" id="ref-for-dom-mouseevent-offsety">offsetY</a></code> according to <a href="https://www.w3.org/TR/cssom-view-1/#dom-mouseevent-offsety">offsetY</a></p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="17" id="clipboard"><span class="secno">17. </span><span class="content">Clipboard</span><a class="self-link" href="#clipboard"></a></h2>
    <p class="issue" id="issue-5ce38960"><a class="self-link" href="#issue-5ce38960"></a> Should these be moved into the Clipboard spec?</p>
    <div class="algorithm" data-algorithm="handle-native-cut">
     <h3 class="heading settled" data-level="17.1" id="handle native cut"><span class="secno">17.1. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-native-cut">handle native cut</dfn></span><a class="self-link" href="#handle%20native%20cut"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p>None</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="issue" id="issue-86dbc66c"><a class="self-link" href="#issue-86dbc66c"></a> Define when the "cut" event is fired.</p>
     <ol>
      <li data-md>
       <p>Let <var>data</var> = null</p>
      <li data-md>
       <p>Let <var>result</var> = <a data-link-type="dfn" href="#fire-an-inputevent" id="ref-for-fire-an-inputevent⑤">fire an InputEvent</a> with "beforeinput", "deleteByCut" and <var>data</var></p>
      <li data-md>
       <p>If <var>result</var> is true, then</p>
      <li data-md>
       <p>Copy selected text to clipboard</p>
      <li data-md>
       <p>Remove selected text from DOM target element</p>
      <li data-md>
       <p><a data-link-type="dfn" href="#fire-an-inputevent" id="ref-for-fire-an-inputevent⑥">Fire an InputEvent</a> with "input", "deleteByCut" and <var>data</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-native-copy">
     <h3 class="heading settled" data-level="17.2" id="handle native copy"><span class="secno">17.2. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-native-copy">handle native copy</dfn></span><a class="self-link" href="#handle%20native%20copy"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p>None</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="note" role="note"><span class="marker">Note:</span> No input events fired</p>
     <p class="issue" id="issue-4a872fb7"><a class="self-link" href="#issue-4a872fb7"></a> Define when "copy" event is fired. Should that be in the Clipboard Spec?</p>
     <ol>
      <li data-md>
       <p>Update clipboard with current selection</p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="handle-native-paste">
     <h3 class="heading settled" data-level="17.3" id="handle native paste"><span class="secno">17.3. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-native-paste">handle native paste</dfn></span><a class="self-link" href="#handle%20native%20paste"></a></h3>
     <dl>
      <dt data-md>Input
      <dd data-md>
       <p>None</p>
      <dt data-md>Output
      <dd data-md>
       <p>None</p>
     </dl>
     <p class="note" role="note"><span class="marker">Note:</span> This is intended to be called when the UA triggers a paste action (via user action)</p>
     <p class="issue" id="issue-c9eb8a10"><a class="self-link" href="#issue-c9eb8a10"></a> Define when the "paste" event is fired.</p>
     <ol>
      <li data-md>
       <p>Let <var>data</var> = the text on the clipboard being pasted</p>
      <li data-md>
       <p>Let <var>result</var> = <a data-link-type="dfn" href="#fire-an-inputevent" id="ref-for-fire-an-inputevent⑦">fire an InputEvent</a> with "beforeinput", "insertFromPaste" and <var>data</var></p>
      <li data-md>
       <p>If <var>result</var> is false, then return.</p>
      <li data-md>
       <p>Set <var>result</var> = <a data-link-type="dfn" href="#fire-a-textevent①" id="ref-for-fire-a-textevent①②">fire a TextEvent</a> with "textInput", and <var>data</var></p>
       <p class="note" role="note"><span class="marker">Note:</span> The "textInput" event is obsolete.</p>
      <li data-md>
       <p>If <var>result</var> is false, then return.</p>
      <li data-md>
       <p>Paste clipboard contents into DOM target element</p>
      <li data-md>
       <p><a data-link-type="dfn" href="#fire-an-inputevent" id="ref-for-fire-an-inputevent⑧">Fire an InputEvent</a> with "input", "insertFromPaste" and <var>data</var></p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="18" id="acknowledgementsclipboard"><span class="secno">18. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgementsclipboard"></a></h2>
    <p>Thanks to the following for their contributions to this document:</p>
    <ul>
     <li data-md>
      <p>Anupam Snigdha</p>
     <li data-md>
      <p>Domenic Denicola</p>
     <li data-md>
      <p>Masayuki Nakano</p>
    </ul>
   </section>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p> Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
            The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
            in the normative parts of this document
            are to be interpreted as described in RFC 2119.
            However, for readability,
            these words do not appear in all uppercase letters in this specification. </p>
   <p> All of the text of this specification is normative
            except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p> Examples in this specification are introduced with the words “for example”
            or are set apart from the normative text with <code>class="example"</code>, like this: </p>
   <div class="example" id="example-example"><a class="self-link" href="#example-example"></a> This is an example of an informative example. </div>
   <p> Informative notes begin with the word “Note”
            and are set apart from the normative text with <code>class="note"</code>, like this: </p>
   <p class="note" role="note"> Note, this is an informative note.</p>
  </div>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don't scroll to compensate for the ToC if we're above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don't know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn't exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn't standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don't have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we're at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can't find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#keyboardevent-alt-flag">alt flag</a><span>, in § 10.1</span>
   <li><a href="#keyboardevent-altgraph-flag">altgraph flag</a><span>, in § 10.1</span>
   <li>
    altKey
    <ul>
     <li><a href="#dom-keyboardevent-altkey">attribute for KeyboardEvent</a><span>, in § 10.1</span>
     <li><a href="#dom-mouseevent-altkey">attribute for MouseEvent</a><span>, in § 6.1</span>
    </ul>
   <li><a href="#begin-composition">begin composition</a><span>, in § 11.8</span>
   <li><a href="#dom-mouseevent-button">button</a><span>, in § 6.1</span>
   <li><a href="#dom-mouseevent-buttons">buttons</a><span>, in § 6.1</span>
   <li><a href="#calculate-dom-path">calculate DOM path</a><span>, in § 15.2</span>
   <li><a href="#calculate-key-location">calculate key location</a><span>, in § 10.7</span>
   <li><a href="#calculate-mouseevent-button-attribute">calculate MouseEvent button attribute</a><span>, in § 6.5</span>
   <li><a href="#keyboardevent-capslock-flag">capslock flag</a><span>, in § 10.1</span>
   <li><a href="#dom-mouseevent-clientx">clientX</a><span>, in § 6.1</span>
   <li><a href="#dom-mouseevent-clienty">clientY</a><span>, in § 6.1</span>
   <li><a href="#dom-keyboardevent-code">code</a><span>, in § 10.1</span>
   <li><a href="#composition-mode-flag">composition mode flag</a><span>, in § 11.1.1</span>
   <li><a href="#keyboardevent-control-flag">control flag</a><span>, in § 10.1</span>
   <li><a href="#create-a-compositionevent">create a CompositionEvent</a><span>, in § 11.3</span>
   <li><a href="#create-a-keyboardevent">create a KeyboardEvent</a><span>, in § 10.4</span>
   <li><a href="#create-a-mouseevent">create a MouseEvent</a><span>, in § 6.4</span>
   <li><a href="#create-an-inputevent">create an InputEvent</a><span>, in § 8.2</span>
   <li><a href="#create-a-pointerevent">create a PointerEvent</a><span>, in § 12.2</span>
   <li><a href="#create-a-textevent①">create a TextEvent</a><span>, in § 9.3</span>
   <li><a href="#create-pointerevent-from-mouseevent">create PointerEvent from MouseEvent</a><span>, in § 12.3</span>
   <li>
    ctrlKey
    <ul>
     <li><a href="#dom-keyboardevent-ctrlkey">attribute for KeyboardEvent</a><span>, in § 10.1</span>
     <li><a href="#dom-mouseevent-ctrlkey">attribute for MouseEvent</a><span>, in § 6.1</span>
    </ul>
   <li><a href="#dom-textevent-data">data</a><span>, in § 9.1</span>
   <li><a href="#dom-uievent-detail">detail</a><span>, in § 4.1</span>
   <li><a href="#dom-keyboardevent-dom_key_location_left">DOM_KEY_LOCATION_LEFT</a><span>, in § 10.1</span>
   <li><a href="#dom-keyboardevent-dom_key_location_numpad">DOM_KEY_LOCATION_NUMPAD</a><span>, in § 10.1</span>
   <li><a href="#dom-keyboardevent-dom_key_location_right">DOM_KEY_LOCATION_RIGHT</a><span>, in § 10.1</span>
   <li><a href="#dom-keyboardevent-dom_key_location_standard">DOM_KEY_LOCATION_STANDARD</a><span>, in § 10.1</span>
   <li><a href="#uievent-due-to-user-interaction-flag">due to user interaction flag</a><span>, in § 3.1</span>
   <li><a href="#end-composition">end composition</a><span>, in § 11.9</span>
   <li><a href="#enter-composition-mode">enter composition mode</a><span>, in § 11.5</span>
   <li><a href="#exit-composition-mode">exit composition mode</a><span>, in § 11.6</span>
   <li><a href="#fire-a-compositionevent">fire a CompositionEvent</a><span>, in § 11.4</span>
   <li><a href="#fire-an-inputevent">fire an InputEvent</a><span>, in § 8.4</span>
   <li><a href="#fire-a-textevent①">fire a TextEvent</a><span>, in § 9.4</span>
   <li><a href="#fire-key-input-events">fire key input events</a><span>, in § 8.3</span>
   <li><a href="#get-modifier-state">get modifier state</a><span>, in § 10.8</span>
   <li><a href="#handle-composition-key">handle composition key</a><span>, in § 11.7</span>
   <li><a href="#handle-native-copy">handle native copy</a><span>, in § 17.2</span>
   <li><a href="#handle-native-cut">handle native cut</a><span>, in § 17.1</span>
   <li><a href="#handle-native-key-down">handle native key down</a><span>, in § 10.11</span>
   <li><a href="#handle-native-key-press">handle native key press</a><span>, in § 10.13</span>
   <li><a href="#handle-native-key-up">handle native key up</a><span>, in § 10.12</span>
   <li><a href="#handle-native-mouse-click">handle native mouse click</a><span>, in § 6.9</span>
   <li><a href="#handle-native-mouse-double-click">handle native mouse double click</a><span>, in § 6.11</span>
   <li><a href="#handle-native-mouse-down">handle native mouse down</a><span>, in § 6.7</span>
   <li><a href="#handle-native-mouse-move">handle native mouse move</a><span>, in § 6.12</span>
   <li><a href="#handle-native-mouse-up">handle native mouse up</a><span>, in § 6.8</span>
   <li><a href="#handle-native-paste">handle native paste</a><span>, in § 17.3</span>
   <li><a href="#handle-post-browser-key">handle post browser key</a><span>, in § 10.10</span>
   <li><a href="#handle-pre-browser-key">handle pre browser key</a><span>, in § 10.9</span>
   <li><a href="#hit-test">hit test</a><span>, in § 15.1</span>
   <li><a href="#in-composition-flag">in composition flag</a><span>, in § 11.1.1</span>
   <li><a href="#initialize-a-compositionevent">initialize a CompositionEvent</a><span>, in § 11.2</span>
   <li><a href="#initialize-a-keyboardevent">initialize a KeyboardEvent</a><span>, in § 10.3</span>
   <li><a href="#initialize-a-mouseevent">initialize a MouseEvent</a><span>, in § 6.3</span>
   <li><a href="#initialize-an-event">initialize an Event</a><span>, in § 3.2</span>
   <li><a href="#initialize-an-inputevent">initialize an InputEvent</a><span>, in § 8.1</span>
   <li><a href="#initialize-a-pointerevent">initialize a PointerEvent</a><span>, in § 12.1</span>
   <li><a href="#initialize-a-textevent①">initialize a TextEvent</a><span>, in § 9.2</span>
   <li><a href="#initialize-a-uievent">initialize a UIEvent</a><span>, in § 4.2</span>
   <li><a href="#initialize-cssom-attributes-for-mouseevent">initialize CSSOM attributes for MouseEvent</a><span>, in § 16.1</span>
   <li><a href="#initialize-pointerlock-attributes-for-mouseevent">initialize PointerLock attributes for MouseEvent</a><span>, in § 13.3</span>
   <li><a href="#dom-textevent-inittextevent">initTextEvent(type)</a><span>, in § 9.1</span>
   <li><a href="#dom-textevent-inittextevent">initTextEvent(type, bubbles)</a><span>, in § 9.1</span>
   <li><a href="#dom-textevent-inittextevent">initTextEvent(type, bubbles, cancelable)</a><span>, in § 9.1</span>
   <li><a href="#dom-textevent-inittextevent">initTextEvent(type, bubbles, cancelable, view)</a><span>, in § 9.1</span>
   <li><a href="#dom-textevent-inittextevent">initTextEvent(type, bubbles, cancelable, view, data)</a><span>, in § 9.1</span>
   <li><a href="#dom-keyboardevent-iscomposing">isComposing</a><span>, in § 10.1</span>
   <li><a href="#dom-keyboardevent-key">key</a><span>, in § 10.1</span>
   <li><a href="#keyboard-lock-enable-flag">keyboard lock enable flag</a><span>, in § 14.1.2</span>
   <li><a href="#keyboard-lock-is-enabled">Keyboard Lock is enabled</a><span>, in § 14.2</span>
   <li><a href="#dom-keyboardevent-keychar">keyChar</a><span>, in § 10.1</span>
   <li><a href="#dom-keyboardevent-keycode">keyCode</a><span>, in § 10.1</span>
   <li><a href="#key-modifier-state">key modifier state</a><span>, in § 10.2.1</span>
   <li><a href="#last-mouse-dom-path">last mouse DOM path</a><span>, in § 6.2.2</span>
   <li><a href="#last-mouse-element">last mouse element</a><span>, in § 6.2.2</span>
   <li><a href="#last-mouse-move">last mouse move</a><span>, in § 13.2.1</span>
   <li><a href="#dom-keyboardevent-location">location</a><span>, in § 10.1</span>
   <li><a href="#maybe-send-pointerdown-event">maybe send pointerdown event</a><span>, in § 12.9</span>
   <li><a href="#maybe-send-pointerenter-event">maybe send pointerenter event</a><span>, in § 12.7</span>
   <li><a href="#maybe-send-pointerleave-event">maybe send pointerleave event</a><span>, in § 12.5</span>
   <li><a href="#maybe-send-pointermove-event">maybe send pointermove event</a><span>, in § 12.8</span>
   <li><a href="#maybe-send-pointerout-event">maybe send pointerout event</a><span>, in § 12.4</span>
   <li><a href="#maybe-send-pointerover-event">maybe send pointerover event</a><span>, in § 12.6</span>
   <li><a href="#maybe-send-pointerup-event">maybe send pointerup event</a><span>, in § 12.10</span>
   <li><a href="#maybe-show-context-menu">maybe show context menu</a><span>, in § 6.13</span>
   <li><a href="#keyboardevent-meta-flag">meta flag</a><span>, in § 10.1</span>
   <li>
    metaKey
    <ul>
     <li><a href="#dom-keyboardevent-metakey">attribute for KeyboardEvent</a><span>, in § 10.1</span>
     <li><a href="#dom-mouseevent-metakey">attribute for MouseEvent</a><span>, in § 6.1</span>
    </ul>
   <li><a href="#mouse-button-bitmask">mouse button bitmask</a><span>, in § 6.2.1</span>
   <li><a href="#dom-mouseevent-movementx">movementX</a><span>, in § 13.1</span>
   <li><a href="#dom-mouseevent-movementy">movementY</a><span>, in § 13.1</span>
   <li><a href="#keyboardevent-numlock-flag">numlock flag</a><span>, in § 10.1</span>
   <li><a href="#dom-mouseevent-relatedtarget">relatedTarget</a><span>, in § 6.1</span>
   <li><a href="#dom-keyboardevent-repeat">repeat</a><span>, in § 10.1</span>
   <li><a href="#dom-mouseevent-screenx">screenX</a><span>, in § 6.1</span>
   <li><a href="#dom-mouseevent-screeny">screenY</a><span>, in § 6.1</span>
   <li><a href="#send-click-event">send click event</a><span>, in § 6.10</span>
   <li><a href="#set-event-modifiers">set event modifiers</a><span>, in § 10.5</span>
   <li><a href="#set-keyboardevent-attributes">set KeyboardEvent attributes</a><span>, in § 10.6</span>
   <li><a href="#set-mouseevent-attributes-from-native">set MouseEvent attributes from native</a><span>, in § 6.6</span>
   <li><a href="#set-pointerlock-attributes-for-mousemove">set PointerLock attributes for mousemove</a><span>, in § 13.4</span>
   <li><a href="#keyboardevent-shift-flag">shift flag</a><span>, in § 10.1</span>
   <li>
    shiftKey
    <ul>
     <li><a href="#dom-keyboardevent-shiftkey">attribute for KeyboardEvent</a><span>, in § 10.1</span>
     <li><a href="#dom-mouseevent-shiftkey">attribute for MouseEvent</a><span>, in § 6.1</span>
    </ul>
   <li><a href="#suppress-key-input-events-flag">suppress key input events flag</a><span>, in § 10.2.2</span>
   <li><a href="#textevent①">TextEvent</a><span>, in § 9.1</span>
   <li><a href="#dom-uievent-view">view</a><span>, in § 4.1</span>
   <li><a href="#dom-keyboardevent-which">which</a><span>, in § 4.1</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSS21]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="7ed32311">viewport</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSSOM-View]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="6aa2dfc0">elementfrompoint</span>
     <li><span class="dfn-paneled" id="8d17f908">elementsfrompoint</span>
     <li><span class="dfn-paneled" id="682e5080">offsetX</span>
     <li><span class="dfn-paneled" id="cf79cd2c">offsetY</span>
     <li><span class="dfn-paneled" id="e5441b90">pageX</span>
     <li><span class="dfn-paneled" id="b628bb4c">pageY</span>
     <li><span class="dfn-paneled" id="b8dfd2df">x</span>
     <li><span class="dfn-paneled" id="5306d119">y</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="296f3551">Element</span>
     <li><span class="dfn-paneled" id="129bdae8">Event</span>
     <li><span class="dfn-paneled" id="2bc0cdf4">EventTarget</span>
     <li><span class="dfn-paneled" id="cfca2fca">NONE</span>
     <li><span class="dfn-paneled" id="2e9f6464">canceled flag</span>
     <li><span class="dfn-paneled" id="8b547cc7">composed</span>
     <li><span class="dfn-paneled" id="9663c02f">composed flag</span>
     <li><span class="dfn-paneled" id="5ca8693f">currentTarget</span>
     <li><span class="dfn-paneled" id="1777dcd2">defaultPrevented</span>
     <li><span class="dfn-paneled" id="092f2e0b">dispatch flag</span>
     <li><span class="dfn-paneled" id="07e9cd55">eventPhase</span>
     <li><span class="dfn-paneled" id="6b3c3a50">in passive listener flag</span>
     <li><span class="dfn-paneled" id="62eec4f2">initialized flag</span>
     <li><span class="dfn-paneled" id="838900a7">isTrusted</span>
     <li><span class="dfn-paneled" id="5216e1a0">node document</span>
     <li><span class="dfn-paneled" id="38340ce0">stop immediate propagation flag</span>
     <li><span class="dfn-paneled" id="c89908b4">stop propagation flag</span>
     <li><span class="dfn-paneled" id="e8478f36">target</span>
     <li><span class="dfn-paneled" id="d4ec1548">timeStamp</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5d7209e9">Window</span>
     <li><span class="dfn-paneled" id="59928beb">click focusable</span>
     <li><span class="dfn-paneled" id="1372f92a">dispatch</span>
     <li><span class="dfn-paneled" id="03d782eb">focusable area</span>
     <li><span class="dfn-paneled" id="ca61c676">focusing steps</span>
    </ul>
   <li>
    <a data-link-type="biblio">[POINTEREVENTS3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="d94094fa">PointerEvent</span>
    </ul>
   <li>
    <a data-link-type="biblio">[UIEVENTS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a7d6c2ec">CompositionEvent</span>
     <li><span class="dfn-paneled" id="518be2ae">InputEvent</span>
     <li><span class="dfn-paneled" id="1fc098b2">KeyboardEvent</span>
     <li><span class="dfn-paneled" id="c3469cd0">MouseEvent</span>
     <li><span class="dfn-paneled" id="92000da2">UIEvent</span>
     <li><span class="dfn-paneled" id="adddfb97">charCode</span>
     <li><span class="dfn-paneled" id="895b90c9">compositionend</span>
     <li><span class="dfn-paneled" id="6336d184">compositionstart</span>
     <li><span class="dfn-paneled" id="bdf33d13">data <small>(for CompositionEvent)</small></span>
     <li><span class="dfn-paneled" id="515958a8">data <small>(for InputEvent)</small></span>
    </ul>
   <li>
    <a data-link-type="biblio">[UIEVENTS-KEY]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="e39eb324">modifier key</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="8855a9aa">DOMString</span>
     <li><span class="dfn-paneled" id="889e932f">Exposed</span>
     <li><span class="dfn-paneled" id="5372cca8">boolean</span>
     <li><span class="dfn-paneled" id="4013a022">this</span>
     <li><span class="dfn-paneled" id="5f90bbfb">undefined</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css21">[CSS21]
   <dd>Bert Bos; et al. <a href="https://drafts.csswg.org/css2/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</cite></a>. URL: <a href="https://drafts.csswg.org/css2/">https://drafts.csswg.org/css2/</a>
   <dt id="biblio-cssom-view">[CSSOM-View]
   <dd>Simon Pieters. <a href="https://drafts.csswg.org/cssom-view/"><cite>CSSOM View Module</cite></a>. URL: <a href="https://drafts.csswg.org/cssom-view/">https://drafts.csswg.org/cssom-view/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-pointerevents3">[POINTEREVENTS3]
   <dd>Patrick Lauke; Robert Flack. <a href="https://w3c.github.io/pointerevents/"><cite>Pointer Events</cite></a>. URL: <a href="https://w3c.github.io/pointerevents/">https://w3c.github.io/pointerevents/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-uievents">[UIEVENTS]
   <dd>Gary Kacmarcik; Travis Leithead. <a href="https://w3c.github.io/uievents/"><cite>UI Events</cite></a>. URL: <a href="https://w3c.github.io/uievents/">https://w3c.github.io/uievents/</a>
   <dt id="biblio-uievents-key">[UIEVENTS-KEY]
   <dd>Travis Leithead; Gary Kacmarcik. <a href="https://w3c.github.io/uievents-key/"><cite>UI Events KeyboardEvent key Values</cite></a>. URL: <a href="https://w3c.github.io/uievents-key/">https://w3c.github.io/uievents-key/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-cssom">[CSSOM]
   <dd>Daniel Glazman; Emilio Cobos Álvarez. <a href="https://drafts.csswg.org/cssom/"><cite>CSS Object Model (CSSOM)</cite></a>. URL: <a href="https://drafts.csswg.org/cssom/">https://drafts.csswg.org/cssom/</a>
   <dt id="biblio-pointerlock">[PointerLock]
   <dd>Vincent Scheib. <a href="https://w3c.github.io/pointerlock/"><cite>Pointer Lock</cite></a>. URL: <a href="https://w3c.github.io/pointerlock/">https://w3c.github.io/pointerlock/</a>
   <dt id="biblio-wicg-keyboard-lock">[WICG-Keyboard-Lock]
   <dd><a href="https://wicg.github.io/keyboard-lock/"><cite>Keyboard Lock</cite></a>. cg-draft. URL: <a href="https://wicg.github.io/keyboard-lock/">https://wicg.github.io/keyboard-lock/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#textevent①"><code><c- g>TextEvent</c-></code></a> : <a data-link-type="idl-name" href="https://w3c.github.io/uievents/#uievent"><c- n>UIEvent</c-></a> {
    <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-textevent-data"><c- g>data</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#dom-textevent-inittextevent"><c- g>initTextEvent</c-></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type"><code><c- g>type</c-></code></a>,
        <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles"><code><c- g>bubbles</c-></code></a> = <c- b>false</c->,
        <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable"><code><c- g>cancelable</c-></code></a> = <c- b>false</c->,
        <c- b>optional</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"><c- n>Window</c-></a>? <a href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-view"><code><c- g>view</c-></code></a> = <c- b>null</c->,
        <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-data"><code><c- g>data</c-></code></a> = "undefined");
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> IMEs differ wildly on different platforms, and often have different capabilities
(such as whether or not they can be "canceled") even on the same platform.
What is the common set of requirements that we can rely on? <a class="issue-return" href="#issue-39f24517" title="Jump to section">↵</a></div>
   <div class="issue"> For example, on Windows, Win+'.' opens an emoji window that will generate
composition events. But there is not indication from the OS that composition
is about to take place. A similar problem exists with "shape writing" using the
virtual keyboard. <a class="issue-return" href="#issue-dba77cfe" title="Jump to section">↵</a></div>
   <div class="issue"> Move to/merge with <a data-link-type="biblio" href="#biblio-dom" title="DOM Standard">[DOM]</a> spec <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event">Event</a></code> interface. <a class="issue-return" href="#issue-a52634a8" title="Jump to section">↵</a></div>
   <div class="issue"> This is a proposal.
    See <a href="https://github.com/w3c/uievents/issues/270">uievents/270</a> <a class="issue-return" href="#issue-8b668288" title="Jump to section">↵</a></div>
   <div class="issue"> Add definition for UIEventInit <a class="issue-return" href="#issue-21d6f045" title="Jump to section">↵</a></div>
   <div class="issue"> Event firing for load, unload, abort, error, select. Should those be covered here
or are they handled elsewhere already? <a class="issue-return" href="#issue-af4b830f" title="Jump to section">↵</a></div>
   <div class="issue"> TODO <a class="issue-return" href="#issue-b7b1e314" title="Jump to section">↵</a></div>
   <div class="issue"> TODO <a class="issue-return" href="#issue-b7b1e314①" title="Jump to section">↵</a></div>
   <div class="issue"> Other buttons can be added starting with 0x08 <a class="issue-return" href="#issue-e1271e39" title="Jump to section">↵</a></div>
   <div class="issue"> This algorithm makes assumptions about the dispatch of PointerEvents because they
    are not currently specified explicitly. Once <a href="https://github.com/w3c/pointerevents/issues/285">pointerevents/285</a> is resolved
    this may need to be updated. <a class="issue-return" href="#issue-5a61aefb" title="Jump to section">↵</a></div>
   <div class="issue"> TODO: Set <var>mouseout</var> attributes from <var>native</var>. +CSSOM attributes <a class="issue-return" href="#issue-6c6e5fe0" title="Jump to section">↵</a></div>
   <div class="issue"> Verify behavior when canceled (appears to have no effect). <a class="issue-return" href="#issue-f864a356" title="Jump to section">↵</a></div>
   <div class="issue"> Handle case where <var>element</var> has been deleted.
Also case where it has been moved: Should the DOM mutation have triggered
a mouseleave event? Should we sent it now? Should it be dropped?
Need to verify what current browsers do. <a class="issue-return" href="#issue-c3b2625c" title="Jump to section">↵</a></div>
   <div class="issue"> Compat: Value of event.composed. Spec says false.
Chrome/Linux = true
Firefox/Linux = false <a class="issue-return" href="#issue-ab0000b0" title="Jump to section">↵</a></div>
   <div class="issue"> TODO: Set <var>mouseout</var> attributes from <var>native</var>. +CSSOM attributes <a class="issue-return" href="#issue-6c6e5fe0①" title="Jump to section">↵</a></div>
   <div class="issue"> Verify behavior when canceled (appears to have no effect). <a class="issue-return" href="#issue-f864a356①" title="Jump to section">↵</a></div>
   <div class="issue"> Handle case where <var>element</var> has been deleted or moved. <a class="issue-return" href="#issue-9fc42a9a" title="Jump to section">↵</a></div>
   <div class="issue"> Compat: Value of event.composed. Spec says false.
Chrome/Linux = true
Firefox/Linux = false <a class="issue-return" href="#issue-ab0000b0①" title="Jump to section">↵</a></div>
   <div class="issue"> Compat for shadow DOM elements
Chrome/Linux fires this event at the element and the shadow root <a class="issue-return" href="#issue-9a3a918a" title="Jump to section">↵</a></div>
   <div class="issue"> TODO <a class="issue-return" href="#issue-b7b1e314②" title="Jump to section">↵</a></div>
   <div class="issue"> Move the following into InputEvents spec
(<a href="https://www.w3.org/TR/input-events-1/">level 1</a> or <a href="https://www.w3.org/TR/input-events-2/">level 2</a>)
since that’s where these attributes are defined. <a class="issue-return" href="#issue-0a3912f8" title="Jump to section">↵</a></div>
   <div class="issue"> Handle historical keypress event here. Return if cancelled. <a class="issue-return" href="#issue-7ecf840c" title="Jump to section">↵</a></div>
   <div class="issue"> How much of this can be moved into the [[Input Events]] spec?
    Issue: List more keys here <a class="issue-return" href="#issue-10cc14f1" title="Jump to section">↵</a></div>
   <div class="issue"> What about target ranges? Need to add support here. <a class="issue-return" href="#issue-3dc727e9" title="Jump to section">↵</a></div>
   <div class="issue"> The target for input events should consider focus, but should also ensure that
    the element is editable and being modified.
    Compare: <a data-link-type="dfn" href="#fire-a-compositionevent">fire a compositionevent</a> <a class="issue-return" href="#issue-616da821" title="Jump to section">↵</a></div>
   <div class="issue"> Need to review: ScrollLock, Hyper, Super, and (for virtual keyboards) Symbol, SymbolLock <a class="issue-return" href="#issue-b4147fbf" title="Jump to section">↵</a></div>
   <div class="issue"> eval: ScrollLock, Hyper, Super, and (for virtual keyboards) Symbol, SymbolLock <a class="issue-return" href="#issue-359c7cda" title="Jump to section">↵</a></div>
   <div class="issue"> Needs more formal description of non-printable characters <a class="issue-return" href="#issue-d5cc0d9d" title="Jump to section">↵</a></div>
   <div class="issue"> Need to include description of how AltGraph should be handled.
See <a href="https://github.com/w3c/uievents/issues/147">uievents/147</a> <a class="issue-return" href="#issue-2200ddf1" title="Jump to section">↵</a></div>
   <div class="issue"> TODO: For historical reasons, we can’t have a formal description of these
fields without recognizing that certain UAs produce different values. <a class="issue-return" href="#issue-40bc3077" title="Jump to section">↵</a></div>
   <div class="issue"> These key shortcuts are defined by the User Agent  (e.g., Cmd-T on Mac).
    They should be defined in such a way that the UA is in control. <a class="issue-return" href="#issue-95f8c21d" title="Jump to section">↵</a></div>
   <div class="issue"> Need a more complete list of these pre-keydown browser keys, or a better description
    of the sort of keys the UA handles. <a class="issue-return" href="#issue-ab1accc3" title="Jump to section">↵</a></div>
   <div class="issue"> IME is often provided by the native OS. So the requirements need to be
    defined and added to the <a href="#req-ime">IME Requirements</a> section. <a class="issue-return" href="#issue-3845ba6b" title="Jump to section">↵</a></div>
   <div class="issue"> How should IME keys be represented. We need the native OS to call <a data-link-type="dfn" href="#enter-composition-mode">enter composition mode</a> and <a data-link-type="dfn" href="#exit-composition-mode">exit composition mode</a> <a class="issue-return" href="#issue-93e6f32f" title="Jump to section">↵</a></div>
   <div class="issue"> When should <a data-link-type="dfn" href="#begin-composition">begin composition</a> be called? How should that be hooked with
    the native IME calls. <a class="issue-return" href="#issue-d744c6c4" title="Jump to section">↵</a></div>
   <div class="issue"> Placeholder until there’s an actual agreed-upon definition for Keyboard Lock. <a class="issue-return" href="#issue-713be494" title="Jump to section">↵</a></div>
   <div class="issue"> Need more complete set of post-keydown browser keys. Perhaps define
a set of common browser keys (clipboard, open/close tabs, quit). <a class="issue-return" href="#issue-9a62a3b5" title="Jump to section">↵</a></div>
   <div class="issue"> Is this check necessary?
Can native CHAR events be ignored or do they contain needed info? <a class="issue-return" href="#issue-41fee8f3" title="Jump to section">↵</a></div>
   <div class="issue"> What should happen if the event focus has changed since the keydown event?
What is the appropriate target for the keyup? The current focus or the previous?
Are there security issues (e.g., if it’s not safe to edit the current focus)? <a class="issue-return" href="#issue-beb23471" title="Jump to section">↵</a></div>
   <div class="issue"> The target for compositionstart should be determined by the element with
focus, but subsequent composition events should be fired on that same element.
Need to test what happens when focus changes during composition.
On the Mac, if you change focus, the composition target changes.
On Windows, behavior depends on the IME. <a class="issue-return" href="#issue-82843cb4" title="Jump to section">↵</a></div>
   <div class="issue"> This is an oversimplification. We need to native OS to call then when the user
    enters composition mode. <a class="issue-return" href="#issue-35af4a5a" title="Jump to section">↵</a></div>
   <div class="issue"> Need agreement on event order for compositionupdate and beforeinput.
    Chrome currently does bi -> cu, whereas Safari does cu -> bi.
    Firefox doesn’t yet produce bi, but prefers cu -> bi.
    See <a href="https://github.com/w3c/input-events/issues/49">input-events/49</a> and <a href="https://github.com/w3c/uievents/issues/66">uievents/66</a> <a class="issue-return" href="#issue-2d2dfa96" title="Jump to section">↵</a></div>
   <div class="issue"> Verify compositionupdate cannot be canceled <a class="issue-return" href="#issue-2170a384" title="Jump to section">↵</a></div>
   <div class="issue"> Not all beforeinput events can be canceled - need to encode that here <a class="issue-return" href="#issue-8be390f6" title="Jump to section">↵</a></div>
   <div class="issue"> Document what happens when <var>result</var> is not true (event canceled) <a class="issue-return" href="#issue-e3eb5b91" title="Jump to section">↵</a></div>
   <div class="issue"> Compat: Chrome sends out beforeinput/compositionupdate/textInput/input sequence before
    compositionend (tested on macOS). Compare with Firefox. <a class="issue-return" href="#issue-11ce2a87" title="Jump to section">↵</a></div>
   <div class="issue"> fire an input event here. <a class="issue-return" href="#issue-a4437074" title="Jump to section">↵</a></div>
   <div class="issue"> Document what to do with result <a class="issue-return" href="#issue-acf5a28c" title="Jump to section">↵</a></div>
   <div class="issue"> Compat: Firefox sends input events after compositionend. Not sure when the
DOM is updated relative to compositionend (tested on macOS). Need to resolve this. <a class="issue-return" href="#issue-273f9f41" title="Jump to section">↵</a></div>
   <div class="issue"> The contents of this section should eventually be moved into the PointerEvent spec. <a class="issue-return" href="#issue-6c0044ca" title="Jump to section">↵</a></div>
   <div class="issue"> TODO - initialize the pointerevent attributes <a class="issue-return" href="#issue-b7cb6aa8" title="Jump to section">↵</a></div>
   <div class="issue"> TODO <a class="issue-return" href="#issue-b7b1e314③" title="Jump to section">↵</a></div>
   <div class="issue"> TODO <a class="issue-return" href="#issue-b7b1e314④" title="Jump to section">↵</a></div>
   <div class="issue"> TODO <a class="issue-return" href="#issue-b7b1e314⑤" title="Jump to section">↵</a></div>
   <div class="issue"> TODO <a class="issue-return" href="#issue-b7b1e314⑥" title="Jump to section">↵</a></div>
   <div class="issue"> Can this send pointermove and pointerrawupdate? Or do we need 2 methods? <a class="issue-return" href="#issue-db237ad4" title="Jump to section">↵</a></div>
   <div class="issue"> What is needed to properly define how pointermove events are coalesced? <a class="issue-return" href="#issue-a521983e" title="Jump to section">↵</a></div>
   <div class="issue"> TODO <a class="issue-return" href="#issue-b7b1e314⑦" title="Jump to section">↵</a></div>
   <div class="issue"> Unlike mousedown events, <a href="https://w3c.github.io/pointerevents/#the-pointerdown-event">pointerdown</a> events are not nested when multiple buttons are pressed.
    The MouseEvent is passed so that the fields can be copied into the PointerEvent. <a class="issue-return" href="#issue-ac02e1f6" title="Jump to section">↵</a></div>
   <div class="issue"> TODO <a class="issue-return" href="#issue-b7b1e314⑧" title="Jump to section">↵</a></div>
   <div class="issue"> Unlike mouseup events, <a href="https://w3c.github.io/pointerevents/#the-pointerup-event">pointerup</a> events are not nested when multiple buttons are pressed.
    The MouseEvent is passed so that the fields can be copied into the PointerEvent. <a class="issue-return" href="#issue-571ee343" title="Jump to section">↵</a></div>
   <div class="issue"> TODO <a class="issue-return" href="#issue-b7b1e314⑨" title="Jump to section">↵</a></div>
   <div class="issue"> The contents of this section should eventually be moved into the <a data-link-type="biblio" href="#biblio-pointerlock" title="Pointer Lock">[PointerLock]</a> spec <a class="issue-return" href="#issue-972fa7f3" title="Jump to section">↵</a></div>
   <div class="issue"> KeyboardLock is not yet an accepted standard and is included here as a placeholder
to explore how it might be integrated. <a class="issue-return" href="#issue-37fef50b" title="Jump to section">↵</a></div>
   <div class="issue"> The contents of this section should eventually be moved into the <a data-link-type="biblio" href="#biblio-wicg-keyboard-lock" title="Keyboard Lock">[WICG-Keyboard-Lock]</a> spec <a class="issue-return" href="#issue-4d0ba757" title="Jump to section">↵</a></div>
   <div class="issue"> TODO <a class="issue-return" href="#issue-b7b1e314①⓪" title="Jump to section">↵</a></div>
   <div class="issue"> These definitions probably belong in another spec. <a class="issue-return" href="#issue-65045046" title="Jump to section">↵</a></div>
   <div class="issue"> To account for <a href="https://html.spec.whatwg.org/#inert">inert</a> or <a href="https://html.spec.whatwg.org/#concept-fe-disabled">disabled</a> elements. this should call <a data-link-type="dfn" href="https://www.w3.org/TR/cssom-view-1/#dom-document-elementfrompoint">elementsFromPoint</a> and reject
    invalid elements <a class="issue-return" href="#issue-d31c8856" title="Jump to section">↵</a></div>
   <div class="issue"> This needs a proper definition to add ancestors to <var>path</var>. <a class="issue-return" href="#issue-b8797d0c" title="Jump to section">↵</a></div>
   <div class="issue"> The contents of this section should eventually be moved into the <a data-link-type="biblio" href="#biblio-cssom" title="CSS Object Model (CSSOM)">[CSSOM]</a> spec <a class="issue-return" href="#issue-2236bbea" title="Jump to section">↵</a></div>
   <div class="issue"> Should these be moved into the Clipboard spec? <a class="issue-return" href="#issue-5ce38960" title="Jump to section">↵</a></div>
   <div class="issue"> Define when the "cut" event is fired. <a class="issue-return" href="#issue-86dbc66c" title="Jump to section">↵</a></div>
   <div class="issue"> Define when "copy" event is fired. Should that be in the Clipboard Spec? <a class="issue-return" href="#issue-4a872fb7" title="Jump to section">↵</a></div>
   <div class="issue"> Define when the "paste" event is fired. <a class="issue-return" href="#issue-c9eb8a10" title="Jump to section">↵</a></div>
  </div>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"03d782eb": {"dfnID":"03d782eb","dfnText":"focusable area","external":true,"refSections":[{"refs":[{"id":"ref-for-focusable-area"}],"title":"6.7. handle native mouse down"}],"url":"https://html.spec.whatwg.org/#focusable-area"},
"07e9cd55": {"dfnID":"07e9cd55","dfnText":"eventPhase","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-eventphase"}],"title":"3.2. initialize an Event"}],"url":"https://dom.spec.whatwg.org/#dom-event-eventphase"},
"092f2e0b": {"dfnID":"092f2e0b","dfnText":"dispatch flag","external":true,"refSections":[{"refs":[{"id":"ref-for-dispatch-flag"}],"title":"3.2. initialize an Event"},{"refs":[{"id":"ref-for-dispatch-flag\u2460"}],"title":"9.1. TextEvent Interface"}],"url":"https://dom.spec.whatwg.org/#dispatch-flag"},
"129bdae8": {"dfnID":"129bdae8","dfnText":"Event","external":true,"refSections":[{"refs":[{"id":"ref-for-event"}],"title":"3. Event"},{"refs":[{"id":"ref-for-event\u2460"}],"title":"3.1. Event Interface"},{"refs":[{"id":"ref-for-event\u2461"}],"title":"3.2. initialize an Event"},{"refs":[{"id":"ref-for-event\u2462"}],"title":"8.1. initialize an InputEvent"},{"refs":[{"id":"ref-for-event\u2463"}],"title":"9.2. initialize a TextEvent"},{"refs":[{"id":"ref-for-event\u2464"}],"title":"11.2. initialize a CompositionEvent"}],"url":"https://dom.spec.whatwg.org/#event"},
"1372f92a": {"dfnID":"1372f92a","dfnText":"dispatch","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-event-dispatch"}],"title":"6.7. handle native mouse down"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2460"}],"title":"6.8. handle native mouse up"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2461"}],"title":"6.10. send click event"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2462"}],"title":"6.11. handle native mouse double click"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2463"},{"id":"ref-for-concept-event-dispatch\u2464"},{"id":"ref-for-concept-event-dispatch\u2465"},{"id":"ref-for-concept-event-dispatch\u2466"},{"id":"ref-for-concept-event-dispatch\u2467"}],"title":"6.12. handle native mouse move"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2468"}],"title":"6.13. maybe show context menu"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2460\u24ea"}],"title":"8.4. fire an InputEvent"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2460\u2460"}],"title":"9.4. fire a TextEvent"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2460\u2461"}],"title":"10.11. handle native key down"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2460\u2462"}],"title":"10.12. handle native key up"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2460\u2463"}],"title":"11.4. fire a CompositionEvent"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2460\u2464"}],"title":"12.4. maybe send pointerout event"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2460\u2465"}],"title":"12.5. maybe send pointerleave event"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2460\u2466"}],"title":"12.6. maybe send pointerover event"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2460\u2467"}],"title":"12.7. maybe send pointerenter event"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2460\u2468"}],"title":"12.8. maybe send pointermove event"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2461\u24ea"}],"title":"12.9. maybe send pointerdown event"},{"refs":[{"id":"ref-for-concept-event-dispatch\u2461\u2460"}],"title":"12.10. maybe send pointerup event"}],"url":"https://dom.spec.whatwg.org/#concept-event-dispatch"},
"1777dcd2": {"dfnID":"1777dcd2","dfnText":"defaultPrevented","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-defaultprevented"}],"title":"3.2. initialize an Event"}],"url":"https://dom.spec.whatwg.org/#dom-event-defaultprevented"},
"1fc098b2": {"dfnID":"1fc098b2","dfnText":"KeyboardEvent","external":true,"refSections":[{"refs":[{"id":"ref-for-keyboardevent"}],"title":"4.2. initialize a UIEvent"},{"refs":[{"id":"ref-for-keyboardevent\u2460"}],"title":"10.1. KeyboardEvent Interface"},{"refs":[{"id":"ref-for-keyboardevent\u2461"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-keyboardevent\u2462"}],"title":"10.4. create a KeyboardEvent"},{"refs":[{"id":"ref-for-keyboardevent\u2463"}],"title":"10.5. set event modifiers"},{"refs":[{"id":"ref-for-keyboardevent\u2464"}],"title":"10.6. set KeyboardEvent attributes"},{"refs":[{"id":"ref-for-keyboardevent\u2465"}],"title":"10.8. get modifier state"}],"url":"https://w3c.github.io/uievents/#keyboardevent"},
"296f3551": {"dfnID":"296f3551","dfnText":"Element","external":true,"refSections":[{"refs":[{"id":"ref-for-element"},{"id":"ref-for-element\u2460"}],"title":"6.2.2. Window-Level State"}],"url":"https://dom.spec.whatwg.org/#element"},
"2bc0cdf4": {"dfnID":"2bc0cdf4","dfnText":"EventTarget","external":true,"refSections":[{"refs":[{"id":"ref-for-eventtarget"}],"title":"3.2. initialize an Event"},{"refs":[{"id":"ref-for-eventtarget\u2460"}],"title":"4.2. initialize a UIEvent"},{"refs":[{"id":"ref-for-eventtarget\u2461"}],"title":"6.3. initialize a MouseEvent"},{"refs":[{"id":"ref-for-eventtarget\u2462"}],"title":"6.4. create a MouseEvent"},{"refs":[{"id":"ref-for-eventtarget\u2463"}],"title":"6.10. send click event"},{"refs":[{"id":"ref-for-eventtarget\u2464"}],"title":"6.13. maybe show context menu"},{"refs":[{"id":"ref-for-eventtarget\u2465"}],"title":"8.1. initialize an InputEvent"},{"refs":[{"id":"ref-for-eventtarget\u2466"}],"title":"8.2. create an InputEvent"},{"refs":[{"id":"ref-for-eventtarget\u2467"}],"title":"8.3. fire key input events"},{"refs":[{"id":"ref-for-eventtarget\u2468"}],"title":"9.2. initialize a TextEvent"},{"refs":[{"id":"ref-for-eventtarget\u2460\u24ea"}],"title":"9.3. create a TextEvent"},{"refs":[{"id":"ref-for-eventtarget\u2460\u2460"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-eventtarget\u2460\u2461"}],"title":"10.4. create a KeyboardEvent"},{"refs":[{"id":"ref-for-eventtarget\u2460\u2462"}],"title":"11.2. initialize a CompositionEvent"},{"refs":[{"id":"ref-for-eventtarget\u2460\u2463"}],"title":"11.3. create a CompositionEvent"},{"refs":[{"id":"ref-for-eventtarget\u2460\u2464"}],"title":"12.1. initialize a PointerEvent"},{"refs":[{"id":"ref-for-eventtarget\u2460\u2465"}],"title":"12.2. create a PointerEvent"}],"url":"https://dom.spec.whatwg.org/#eventtarget"},
"2e9f6464": {"dfnID":"2e9f6464","dfnText":"canceled flag","external":true,"refSections":[{"refs":[{"id":"ref-for-canceled-flag"}],"title":"3.2. initialize an Event"}],"url":"https://dom.spec.whatwg.org/#canceled-flag"},
"38340ce0": {"dfnID":"38340ce0","dfnText":"stop immediate propagation flag","external":true,"refSections":[{"refs":[{"id":"ref-for-stop-immediate-propagation-flag"}],"title":"3.2. initialize an Event"}],"url":"https://dom.spec.whatwg.org/#stop-immediate-propagation-flag"},
"4013a022": {"dfnID":"4013a022","dfnText":"this","external":true,"refSections":[{"refs":[{"id":"ref-for-this"},{"id":"ref-for-this\u2460"},{"id":"ref-for-this\u2461"},{"id":"ref-for-this\u2462"},{"id":"ref-for-this\u2463"},{"id":"ref-for-this\u2464"}],"title":"9.1. TextEvent Interface"}],"url":"https://webidl.spec.whatwg.org/#this"},
"515958a8": {"dfnID":"515958a8","dfnText":"data (for InputEvent)","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-inputevent-data"}],"title":"8.4. fire an InputEvent"}],"url":"https://w3c.github.io/uievents/#dom-inputevent-data"},
"518be2ae": {"dfnID":"518be2ae","dfnText":"InputEvent","external":true,"refSections":[{"refs":[{"id":"ref-for-inputevent"}],"title":"8.2. create an InputEvent"}],"url":"https://w3c.github.io/uievents/#inputevent"},
"5216e1a0": {"dfnID":"5216e1a0","dfnText":"node document","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-node-document"}],"title":"4.2. initialize a UIEvent"}],"url":"https://dom.spec.whatwg.org/#concept-node-document"},
"5306d119": {"dfnID":"5306d119","dfnText":"y","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-y"}],"title":"16.1. initialize CSSOM attributes for MouseEvent"}],"url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-y"},
"5372cca8": {"dfnID":"5372cca8","dfnText":"boolean","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-boolean"},{"id":"ref-for-idl-boolean\u2460"}],"title":"9.1. TextEvent Interface"}],"url":"https://webidl.spec.whatwg.org/#idl-boolean"},
"59928beb": {"dfnID":"59928beb","dfnText":"click focusable","external":true,"refSections":[{"refs":[{"id":"ref-for-click-focusable"}],"title":"6.7. handle native mouse down"}],"url":"https://html.spec.whatwg.org/#click-focusable"},
"5ca8693f": {"dfnID":"5ca8693f","dfnText":"currentTarget","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-currenttarget"}],"title":"3.2. initialize an Event"}],"url":"https://dom.spec.whatwg.org/#dom-event-currenttarget"},
"5d7209e9": {"dfnID":"5d7209e9","dfnText":"Window","external":true,"refSections":[{"refs":[{"id":"ref-for-window"}],"title":"4.2. initialize a UIEvent"},{"refs":[{"id":"ref-for-window\u2460"}],"title":"9.1. TextEvent Interface"}],"url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"},
"5f90bbfb": {"dfnID":"5f90bbfb","dfnText":"undefined","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-undefined"}],"title":"9.1. TextEvent Interface"}],"url":"https://webidl.spec.whatwg.org/#idl-undefined"},
"62eec4f2": {"dfnID":"62eec4f2","dfnText":"initialized flag","external":true,"refSections":[{"refs":[{"id":"ref-for-initialized-flag"}],"title":"3.2. initialize an Event"}],"url":"https://dom.spec.whatwg.org/#initialized-flag"},
"6336d184": {"dfnID":"6336d184","dfnText":"compositionstart","external":true,"refSections":[{"refs":[{"id":"ref-for-compositionstart"}],"title":"11.1.1. Window-Level State"}],"url":"https://www.w3.org/TR/uievents/#compositionstart"},
"682e5080": {"dfnID":"682e5080","dfnText":"offsetX","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-offsetx"}],"title":"16.1. initialize CSSOM attributes for MouseEvent"}],"url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-offsetx"},
"6aa2dfc0": {"dfnID":"6aa2dfc0","dfnText":"elementfrompoint","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-document-elementfrompoint"},{"id":"ref-for-dom-document-elementfrompoint\u2460"}],"title":"15.1. hit test"}],"url":"https://www.w3.org/TR/cssom-view-1/#dom-document-elementfrompoint"},
"6b3c3a50": {"dfnID":"6b3c3a50","dfnText":"in passive listener flag","external":true,"refSections":[{"refs":[{"id":"ref-for-in-passive-listener-flag"}],"title":"3.2. initialize an Event"}],"url":"https://dom.spec.whatwg.org/#in-passive-listener-flag"},
"7ed32311": {"dfnID":"7ed32311","dfnText":"viewport","external":true,"refSections":[{"refs":[{"id":"ref-for-viewport"}],"title":"6.3. initialize a MouseEvent"}],"url":"https://www.w3.org/TR/CSS2/visuren.html#viewport"},
"838900a7": {"dfnID":"838900a7","dfnText":"isTrusted","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-istrusted"}],"title":"3.2. initialize an Event"},{"refs":[{"id":"ref-for-dom-event-istrusted\u2460"}],"title":"4.2. initialize a UIEvent"}],"url":"https://dom.spec.whatwg.org/#dom-event-istrusted"},
"8855a9aa": {"dfnID":"8855a9aa","dfnText":"DOMString","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-DOMString"},{"id":"ref-for-idl-DOMString\u2460"},{"id":"ref-for-idl-DOMString\u2461"}],"title":"9.1. TextEvent Interface"}],"url":"https://webidl.spec.whatwg.org/#idl-DOMString"},
"889e932f": {"dfnID":"889e932f","dfnText":"Exposed","external":true,"refSections":[{"refs":[{"id":"ref-for-Exposed"}],"title":"9.1. TextEvent Interface"}],"url":"https://webidl.spec.whatwg.org/#Exposed"},
"895b90c9": {"dfnID":"895b90c9","dfnText":"compositionend","external":true,"refSections":[{"refs":[{"id":"ref-for-compositionend"}],"title":"11.1.1. Window-Level State"}],"url":"https://www.w3.org/TR/uievents/#compositionend"},
"8b547cc7": {"dfnID":"8b547cc7","dfnText":"composed","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-composed"}],"title":"3.2. initialize an Event"},{"refs":[{"id":"ref-for-dom-event-composed\u2460"},{"id":"ref-for-dom-event-composed\u2461"}],"title":"6.12. handle native mouse move"}],"url":"https://dom.spec.whatwg.org/#dom-event-composed"},
"8d17f908": {"dfnID":"8d17f908","dfnText":"elementsfrompoint","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-document-elementfrompoint"},{"id":"ref-for-dom-document-elementfrompoint\u2460"}],"title":"15.1. hit test"}],"url":"https://www.w3.org/TR/cssom-view-1/#dom-document-elementfrompoint"},
"92000da2": {"dfnID":"92000da2","dfnText":"UIEvent","external":true,"refSections":[{"refs":[{"id":"ref-for-uievent"}],"title":"4.1. UIEvent Interface"},{"refs":[{"id":"ref-for-uievent\u2460"}],"title":"4.2. initialize a UIEvent"},{"refs":[{"id":"ref-for-uievent\u2461"}],"title":"9.1. TextEvent Interface"}],"url":"https://w3c.github.io/uievents/#uievent"},
"9663c02f": {"dfnID":"9663c02f","dfnText":"composed flag","external":true,"refSections":[{"refs":[{"id":"ref-for-composed-flag"}],"title":"3.2. initialize an Event"}],"url":"https://dom.spec.whatwg.org/#composed-flag"},
"a7d6c2ec": {"dfnID":"a7d6c2ec","dfnText":"CompositionEvent","external":true,"refSections":[{"refs":[{"id":"ref-for-compositionevent"}],"title":"11.3. create a CompositionEvent"}],"url":"https://w3c.github.io/uievents/#compositionevent"},
"adddfb97": {"dfnID":"adddfb97","dfnText":"charCode","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-charcode"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-charcode\u2460"}],"title":"10.6. set KeyboardEvent attributes"}],"url":"https://w3c.github.io/uievents/#dom-keyboardevent-charcode"},
"b628bb4c": {"dfnID":"b628bb4c","dfnText":"pageY","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-pagey"}],"title":"16.1. initialize CSSOM attributes for MouseEvent"}],"url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-pagey"},
"b8dfd2df": {"dfnID":"b8dfd2df","dfnText":"x","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-x"}],"title":"16.1. initialize CSSOM attributes for MouseEvent"}],"url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-x"},
"bdf33d13": {"dfnID":"bdf33d13","dfnText":"data (for CompositionEvent)","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-compositionevent-data"}],"title":"11.4. fire a CompositionEvent"}],"url":"https://w3c.github.io/uievents/#dom-compositionevent-data"},
"begin-composition": {"dfnID":"begin-composition","dfnText":"begin composition","external":false,"refSections":[{"refs":[{"id":"ref-for-begin-composition"}],"title":"10.9. handle pre browser key"}],"url":"#begin-composition"},
"c3469cd0": {"dfnID":"c3469cd0","dfnText":"MouseEvent","external":true,"refSections":[{"refs":[{"id":"ref-for-mouseevent"}],"title":"4.2. initialize a UIEvent"},{"refs":[{"id":"ref-for-mouseevent\u2460"}],"title":"6.1. MouseEvent Interface"},{"refs":[{"id":"ref-for-mouseevent\u2461"}],"title":"6.3. initialize a MouseEvent"},{"refs":[{"id":"ref-for-mouseevent\u2462"}],"title":"6.4. create a MouseEvent"},{"refs":[{"id":"ref-for-mouseevent\u2463"}],"title":"6.5. calculate MouseEvent button attribute"},{"refs":[{"id":"ref-for-mouseevent\u2464"}],"title":"6.6. set MouseEvent attributes from native"},{"refs":[{"id":"ref-for-mouseevent\u2465"}],"title":"10.5. set event modifiers"},{"refs":[{"id":"ref-for-mouseevent\u2466"}],"title":"12.3. create PointerEvent from MouseEvent"},{"refs":[{"id":"ref-for-mouseevent\u2467"}],"title":"12.4. maybe send pointerout event"},{"refs":[{"id":"ref-for-mouseevent\u2468"}],"title":"12.5. maybe send pointerleave event"},{"refs":[{"id":"ref-for-mouseevent\u2460\u24ea"}],"title":"12.6. maybe send pointerover event"},{"refs":[{"id":"ref-for-mouseevent\u2460\u2460"}],"title":"12.7. maybe send pointerenter event"},{"refs":[{"id":"ref-for-mouseevent\u2460\u2461"}],"title":"12.8. maybe send pointermove event"},{"refs":[{"id":"ref-for-mouseevent\u2460\u2462"}],"title":"12.9. maybe send pointerdown event"},{"refs":[{"id":"ref-for-mouseevent\u2460\u2463"}],"title":"12.10. maybe send pointerup event"},{"refs":[{"id":"ref-for-mouseevent\u2460\u2464"}],"title":"13.1. MouseEvent Interface Extension"},{"refs":[{"id":"ref-for-mouseevent\u2460\u2465"}],"title":"13.3. initialize PointerLock attributes for MouseEvent"},{"refs":[{"id":"ref-for-mouseevent\u2460\u2466"}],"title":"13.4. set PointerLock attributes for mousemove"},{"refs":[{"id":"ref-for-mouseevent\u2460\u2467"}],"title":"16.1. initialize CSSOM attributes for MouseEvent"}],"url":"https://w3c.github.io/uievents/#mouseevent"},
"c89908b4": {"dfnID":"c89908b4","dfnText":"stop propagation flag","external":true,"refSections":[{"refs":[{"id":"71fe70a20"},{"id":"ref-for-stop-propagation-flag"}],"title":"3.2. initialize an Event"}],"url":"https://dom.spec.whatwg.org/#stop-propagation-flag"},
"ca61c676": {"dfnID":"ca61c676","dfnText":"focusing steps","external":true,"refSections":[{"refs":[{"id":"ref-for-focusing-steps"}],"title":"6.7. handle native mouse down"}],"url":"https://html.spec.whatwg.org/#focusing-steps"},
"calculate-dom-path": {"dfnID":"calculate-dom-path","dfnText":"calculate DOM path","external":false,"refSections":[{"refs":[{"id":"ref-for-calculate-dom-path"}],"title":"6.12. handle native mouse move"}],"url":"#calculate-dom-path"},
"calculate-key-location": {"dfnID":"calculate-key-location","dfnText":"calculate key location","external":false,"refSections":[{"refs":[{"id":"ref-for-calculate-key-location"}],"title":"10.6. set KeyboardEvent attributes"}],"url":"#calculate-key-location"},
"calculate-mouseevent-button-attribute": {"dfnID":"calculate-mouseevent-button-attribute","dfnText":"calculate MouseEvent button attribute","external":false,"refSections":[{"refs":[{"id":"ref-for-calculate-mouseevent-button-attribute"}],"title":"6.6. set MouseEvent attributes from native"}],"url":"#calculate-mouseevent-button-attribute"},
"cf79cd2c": {"dfnID":"cf79cd2c","dfnText":"offsetY","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-offsety"}],"title":"16.1. initialize CSSOM attributes for MouseEvent"}],"url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-offsety"},
"cfca2fca": {"dfnID":"cfca2fca","dfnText":"NONE","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-none"}],"title":"3.2. initialize an Event"}],"url":"https://dom.spec.whatwg.org/#dom-event-none"},
"composition-mode-flag": {"dfnID":"composition-mode-flag","dfnText":"composition mode flag","external":false,"refSections":[{"refs":[{"id":"ref-for-composition-mode-flag"}],"title":"10.13. handle native key press"},{"refs":[{"id":"ref-for-composition-mode-flag\u2460"}],"title":"11.5. enter composition mode"},{"refs":[{"id":"ref-for-composition-mode-flag\u2461"}],"title":"11.6. exit composition mode"}],"url":"#composition-mode-flag"},
"create-a-compositionevent": {"dfnID":"create-a-compositionevent","dfnText":"create a CompositionEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-create-a-compositionevent"}],"title":"11.4. fire a CompositionEvent"}],"url":"#create-a-compositionevent"},
"create-a-keyboardevent": {"dfnID":"create-a-keyboardevent","dfnText":"create a KeyboardEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-create-a-keyboardevent"}],"title":"10.11. handle native key down"},{"refs":[{"id":"ref-for-create-a-keyboardevent\u2460"}],"title":"10.12. handle native key up"}],"url":"#create-a-keyboardevent"},
"create-a-mouseevent": {"dfnID":"create-a-mouseevent","dfnText":"create a MouseEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-create-a-mouseevent"}],"title":"6.7. handle native mouse down"},{"refs":[{"id":"ref-for-create-a-mouseevent\u2460"}],"title":"6.8. handle native mouse up"},{"refs":[{"id":"ref-for-create-a-mouseevent\u2461"},{"id":"ref-for-create-a-mouseevent\u2462"},{"id":"ref-for-create-a-mouseevent\u2463"},{"id":"ref-for-create-a-mouseevent\u2464"},{"id":"ref-for-create-a-mouseevent\u2465"}],"title":"6.12. handle native mouse move"}],"url":"#create-a-mouseevent"},
"create-a-pointerevent": {"dfnID":"create-a-pointerevent","dfnText":"create a PointerEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-create-a-pointerevent"}],"title":"6.10. send click event"},{"refs":[{"id":"ref-for-create-a-pointerevent\u2460"}],"title":"6.11. handle native mouse double click"},{"refs":[{"id":"ref-for-create-a-pointerevent\u2461"}],"title":"6.13. maybe show context menu"}],"url":"#create-a-pointerevent"},
"create-a-textevent①": {"dfnID":"create-a-textevent\u2460","dfnText":"create a TextEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-create-a-textevent\u2460"}],"title":"9.4. fire a TextEvent"}],"url":"#create-a-textevent\u2460"},
"create-an-inputevent": {"dfnID":"create-an-inputevent","dfnText":"create an InputEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-create-an-inputevent"}],"title":"8.4. fire an InputEvent"}],"url":"#create-an-inputevent"},
"create-pointerevent-from-mouseevent": {"dfnID":"create-pointerevent-from-mouseevent","dfnText":"create PointerEvent from MouseEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-create-pointerevent-from-mouseevent"}],"title":"12.4. maybe send pointerout event"},{"refs":[{"id":"ref-for-create-pointerevent-from-mouseevent\u2460"}],"title":"12.5. maybe send pointerleave event"},{"refs":[{"id":"ref-for-create-pointerevent-from-mouseevent\u2461"}],"title":"12.6. maybe send pointerover event"},{"refs":[{"id":"ref-for-create-pointerevent-from-mouseevent\u2462"}],"title":"12.7. maybe send pointerenter event"},{"refs":[{"id":"ref-for-create-pointerevent-from-mouseevent\u2463"}],"title":"12.8. maybe send pointermove event"},{"refs":[{"id":"ref-for-create-pointerevent-from-mouseevent\u2464"}],"title":"12.9. maybe send pointerdown event"},{"refs":[{"id":"ref-for-create-pointerevent-from-mouseevent\u2465"}],"title":"12.10. maybe send pointerup event"}],"url":"#create-pointerevent-from-mouseevent"},
"d4ec1548": {"dfnID":"d4ec1548","dfnText":"timeStamp","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-timestamp"}],"title":"3.2. initialize an Event"}],"url":"https://dom.spec.whatwg.org/#dom-event-timestamp"},
"d94094fa": {"dfnID":"d94094fa","dfnText":"PointerEvent","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-pointerevent"}],"title":"12.1. initialize a PointerEvent"},{"refs":[{"id":"ref-for-dom-pointerevent\u2460"}],"title":"12.2. create a PointerEvent"},{"refs":[{"id":"ref-for-dom-pointerevent\u2461"}],"title":"12.3. create PointerEvent from MouseEvent"}],"url":"https://w3c.github.io/pointerevents/#dom-pointerevent"},
"dom-keyboardevent-altkey": {"dfnID":"dom-keyboardevent-altkey","dfnText":"altKey","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-altkey"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-altkey\u2460"}],"title":"10.5. set event modifiers"}],"url":"#dom-keyboardevent-altkey"},
"dom-keyboardevent-code": {"dfnID":"dom-keyboardevent-code","dfnText":"code","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-code"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-code\u2460"}],"title":"10.6. set KeyboardEvent attributes"},{"refs":[{"id":"ref-for-dom-keyboardevent-code\u2461"}],"title":"10.7. calculate key location"}],"url":"#dom-keyboardevent-code"},
"dom-keyboardevent-ctrlkey": {"dfnID":"dom-keyboardevent-ctrlkey","dfnText":"ctrlKey","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-ctrlkey"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-ctrlkey\u2460"}],"title":"10.5. set event modifiers"}],"url":"#dom-keyboardevent-ctrlkey"},
"dom-keyboardevent-dom_key_location_left": {"dfnID":"dom-keyboardevent-dom_key_location_left","dfnText":"DOM_KEY_LOCATION_LEFT","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-dom_key_location_left"}],"title":"10.7. calculate key location"}],"url":"#dom-keyboardevent-dom_key_location_left"},
"dom-keyboardevent-dom_key_location_numpad": {"dfnID":"dom-keyboardevent-dom_key_location_numpad","dfnText":"DOM_KEY_LOCATION_NUMPAD","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-dom_key_location_numpad"}],"title":"10.7. calculate key location"}],"url":"#dom-keyboardevent-dom_key_location_numpad"},
"dom-keyboardevent-dom_key_location_right": {"dfnID":"dom-keyboardevent-dom_key_location_right","dfnText":"DOM_KEY_LOCATION_RIGHT","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-dom_key_location_right"}],"title":"10.7. calculate key location"}],"url":"#dom-keyboardevent-dom_key_location_right"},
"dom-keyboardevent-dom_key_location_standard": {"dfnID":"dom-keyboardevent-dom_key_location_standard","dfnText":"DOM_KEY_LOCATION_STANDARD","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-dom_key_location_standard"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-dom_key_location_standard\u2460"}],"title":"10.7. calculate key location"}],"url":"#dom-keyboardevent-dom_key_location_standard"},
"dom-keyboardevent-iscomposing": {"dfnID":"dom-keyboardevent-iscomposing","dfnText":"isComposing","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-iscomposing"}],"title":"10.3. initialize a KeyboardEvent"}],"url":"#dom-keyboardevent-iscomposing"},
"dom-keyboardevent-key": {"dfnID":"dom-keyboardevent-key","dfnText":"key","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-key"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-key\u2460"}],"title":"10.6. set KeyboardEvent attributes"}],"url":"#dom-keyboardevent-key"},
"dom-keyboardevent-keychar": {"dfnID":"dom-keyboardevent-keychar","dfnText":"keyChar","external":false,"refSections":[],"url":"#dom-keyboardevent-keychar"},
"dom-keyboardevent-keycode": {"dfnID":"dom-keyboardevent-keycode","dfnText":"keyCode","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-keycode"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-keycode\u2460"}],"title":"10.6. set KeyboardEvent attributes"}],"url":"#dom-keyboardevent-keycode"},
"dom-keyboardevent-location": {"dfnID":"dom-keyboardevent-location","dfnText":"location","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-location"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-location\u2460"}],"title":"10.6. set KeyboardEvent attributes"}],"url":"#dom-keyboardevent-location"},
"dom-keyboardevent-metakey": {"dfnID":"dom-keyboardevent-metakey","dfnText":"metaKey","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-metakey"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-metakey\u2460"}],"title":"10.5. set event modifiers"}],"url":"#dom-keyboardevent-metakey"},
"dom-keyboardevent-repeat": {"dfnID":"dom-keyboardevent-repeat","dfnText":"repeat","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-repeat"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-repeat\u2460"}],"title":"10.6. set KeyboardEvent attributes"}],"url":"#dom-keyboardevent-repeat"},
"dom-keyboardevent-shiftkey": {"dfnID":"dom-keyboardevent-shiftkey","dfnText":"shiftKey","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-shiftkey"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-shiftkey\u2460"}],"title":"10.5. set event modifiers"}],"url":"#dom-keyboardevent-shiftkey"},
"dom-keyboardevent-which": {"dfnID":"dom-keyboardevent-which","dfnText":"which","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-keyboardevent-which"}],"title":"4.2. initialize a UIEvent"},{"refs":[{"id":"ref-for-dom-keyboardevent-which\u2460"}],"title":"10.6. set KeyboardEvent attributes"}],"url":"#dom-keyboardevent-which"},
"dom-mouseevent-altkey": {"dfnID":"dom-mouseevent-altkey","dfnText":"altKey","external":false,"refSections":[],"url":"#dom-mouseevent-altkey"},
"dom-mouseevent-button": {"dfnID":"dom-mouseevent-button","dfnText":"button","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-button"}],"title":"6.3. initialize a MouseEvent"},{"refs":[{"id":"ref-for-dom-mouseevent-button\u2460"}],"title":"6.5. calculate MouseEvent button attribute"},{"refs":[{"id":"ref-for-dom-mouseevent-button\u2461"}],"title":"6.6. set MouseEvent attributes from native"}],"url":"#dom-mouseevent-button"},
"dom-mouseevent-buttons": {"dfnID":"dom-mouseevent-buttons","dfnText":"buttons","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-buttons"}],"title":"6.3. initialize a MouseEvent"}],"url":"#dom-mouseevent-buttons"},
"dom-mouseevent-clientx": {"dfnID":"dom-mouseevent-clientx","dfnText":"clientX","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-clientx"}],"title":"6.3. initialize a MouseEvent"}],"url":"#dom-mouseevent-clientx"},
"dom-mouseevent-clienty": {"dfnID":"dom-mouseevent-clienty","dfnText":"clientY","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-clienty"}],"title":"6.3. initialize a MouseEvent"}],"url":"#dom-mouseevent-clienty"},
"dom-mouseevent-ctrlkey": {"dfnID":"dom-mouseevent-ctrlkey","dfnText":"ctrlKey","external":false,"refSections":[],"url":"#dom-mouseevent-ctrlkey"},
"dom-mouseevent-metakey": {"dfnID":"dom-mouseevent-metakey","dfnText":"metaKey","external":false,"refSections":[],"url":"#dom-mouseevent-metakey"},
"dom-mouseevent-movementx": {"dfnID":"dom-mouseevent-movementx","dfnText":"movementX","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-movementx"}],"title":"13.3. initialize PointerLock attributes for MouseEvent"},{"refs":[{"id":"ref-for-dom-mouseevent-movementx\u2460"},{"id":"ref-for-dom-mouseevent-movementx\u2461"}],"title":"13.4. set PointerLock attributes for mousemove"}],"url":"#dom-mouseevent-movementx"},
"dom-mouseevent-movementy": {"dfnID":"dom-mouseevent-movementy","dfnText":"movementY","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-movementy"}],"title":"13.3. initialize PointerLock attributes for MouseEvent"},{"refs":[{"id":"ref-for-dom-mouseevent-movementy\u2460"},{"id":"ref-for-dom-mouseevent-movementy\u2461"}],"title":"13.4. set PointerLock attributes for mousemove"}],"url":"#dom-mouseevent-movementy"},
"dom-mouseevent-relatedtarget": {"dfnID":"dom-mouseevent-relatedtarget","dfnText":"relatedTarget","external":false,"refSections":[],"url":"#dom-mouseevent-relatedtarget"},
"dom-mouseevent-screenx": {"dfnID":"dom-mouseevent-screenx","dfnText":"screenX","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-screenx"}],"title":"6.3. initialize a MouseEvent"},{"refs":[{"id":"ref-for-dom-mouseevent-screenx\u2460"}],"title":"6.10. send click event"},{"refs":[{"id":"ref-for-dom-mouseevent-screenx\u2461"}],"title":"6.11. handle native mouse double click"},{"refs":[{"id":"ref-for-dom-mouseevent-screenx\u2462"},{"id":"ref-for-dom-mouseevent-screenx\u2463"},{"id":"ref-for-dom-mouseevent-screenx\u2464"}],"title":"13.4. set PointerLock attributes for mousemove"}],"url":"#dom-mouseevent-screenx"},
"dom-mouseevent-screeny": {"dfnID":"dom-mouseevent-screeny","dfnText":"screenY","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-screeny"}],"title":"6.3. initialize a MouseEvent"},{"refs":[{"id":"ref-for-dom-mouseevent-screeny\u2460"}],"title":"6.10. send click event"},{"refs":[{"id":"ref-for-dom-mouseevent-screeny\u2461"}],"title":"6.11. handle native mouse double click"},{"refs":[{"id":"ref-for-dom-mouseevent-screeny\u2462"}],"title":"13.4. set PointerLock attributes for mousemove"}],"url":"#dom-mouseevent-screeny"},
"dom-mouseevent-shiftkey": {"dfnID":"dom-mouseevent-shiftkey","dfnText":"shiftKey","external":false,"refSections":[],"url":"#dom-mouseevent-shiftkey"},
"dom-textevent-data": {"dfnID":"dom-textevent-data","dfnText":"data","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-textevent-data"},{"id":"ref-for-dom-textevent-data\u2460"}],"title":"9.1. TextEvent Interface"},{"refs":[{"id":"ref-for-dom-textevent-data\u2461"}],"title":"9.4. fire a TextEvent"}],"url":"#dom-textevent-data"},
"dom-textevent-inittextevent": {"dfnID":"dom-textevent-inittextevent","dfnText":"initTextEvent(type, bubbles, cancelable, view, data)","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-textevent-inittextevent"}],"title":"9.1. TextEvent Interface"}],"url":"#dom-textevent-inittextevent"},
"dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles": {"dfnID":"dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles","dfnText":"bubbles","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles"}],"title":"3.2. initialize an Event"},{"refs":[{"id":"ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles\u2460"},{"id":"ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles\u2461"}],"title":"6.12. handle native mouse move"},{"refs":[{"id":"ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles\u2462"}],"title":"9.1. TextEvent Interface"}],"url":"#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles"},
"dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable": {"dfnID":"dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable","dfnText":"cancelable","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable"}],"title":"3.2. initialize an Event"},{"refs":[{"id":"ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable\u2460"},{"id":"ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable\u2461"}],"title":"6.12. handle native mouse move"},{"refs":[{"id":"ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable\u2462"}],"title":"9.1. TextEvent Interface"}],"url":"#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable"},
"dom-textevent-inittextevent-type-bubbles-cancelable-view-data-data": {"dfnID":"dom-textevent-inittextevent-type-bubbles-cancelable-view-data-data","dfnText":"data","external":false,"refSections":[],"url":"#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-data"},
"dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type": {"dfnID":"dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type","dfnText":"type","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type"}],"title":"3.2. initialize an Event"},{"refs":[{"id":"ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type\u2460"}],"title":"6.6. set MouseEvent attributes from native"},{"refs":[{"id":"ref-for-dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type\u2461"}],"title":"13.4. set PointerLock attributes for mousemove"}],"url":"#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type"},
"dom-textevent-inittextevent-type-bubbles-cancelable-view-data-view": {"dfnID":"dom-textevent-inittextevent-type-bubbles-cancelable-view-data-view","dfnText":"view","external":false,"refSections":[],"url":"#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-view"},
"dom-uievent-detail": {"dfnID":"dom-uievent-detail","dfnText":"detail","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-uievent-detail"}],"title":"4.2. initialize a UIEvent"}],"url":"#dom-uievent-detail"},
"dom-uievent-view": {"dfnID":"dom-uievent-view","dfnText":"view","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-uievent-view"}],"title":"4.2. initialize a UIEvent"},{"refs":[{"id":"ref-for-dom-uievent-view\u2460"}],"title":"9.1. TextEvent Interface"}],"url":"#dom-uievent-view"},
"e39eb324": {"dfnID":"e39eb324","dfnText":"modifier key","external":true,"refSections":[{"refs":[{"id":"ref-for-keys-modifier"}],"title":"10.2.1. User Agent-Level State"}],"url":"https://www.w3.org/TR/uievents-key/#keys-modifier"},
"e5441b90": {"dfnID":"e5441b90","dfnText":"pageX","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-mouseevent-pagex"}],"title":"16.1. initialize CSSOM attributes for MouseEvent"}],"url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-pagex"},
"e8478f36": {"dfnID":"e8478f36","dfnText":"target","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-target"}],"title":"3.2. initialize an Event"},{"refs":[{"id":"ref-for-dom-event-target\u2460"}],"title":"12.3. create PointerEvent from MouseEvent"},{"refs":[{"id":"ref-for-dom-event-target\u2461"}],"title":"12.4. maybe send pointerout event"},{"refs":[{"id":"ref-for-dom-event-target\u2462"}],"title":"12.5. maybe send pointerleave event"},{"refs":[{"id":"ref-for-dom-event-target\u2463"}],"title":"12.6. maybe send pointerover event"},{"refs":[{"id":"ref-for-dom-event-target\u2464"}],"title":"12.7. maybe send pointerenter event"},{"refs":[{"id":"ref-for-dom-event-target\u2465"}],"title":"12.8. maybe send pointermove event"},{"refs":[{"id":"ref-for-dom-event-target\u2466"}],"title":"12.9. maybe send pointerdown event"},{"refs":[{"id":"ref-for-dom-event-target\u2467"}],"title":"12.10. maybe send pointerup event"}],"url":"https://dom.spec.whatwg.org/#dom-event-target"},
"end-composition": {"dfnID":"end-composition","dfnText":"end composition","external":false,"refSections":[{"refs":[{"id":"ref-for-end-composition"}],"title":"11.6. exit composition mode"},{"refs":[{"id":"ref-for-end-composition\u2460"}],"title":"11.7. handle composition key"}],"url":"#end-composition"},
"enter-composition-mode": {"dfnID":"enter-composition-mode","dfnText":"enter composition mode","external":false,"refSections":[{"refs":[{"id":"ref-for-enter-composition-mode"}],"title":"10.9. handle pre browser key"}],"url":"#enter-composition-mode"},
"exit-composition-mode": {"dfnID":"exit-composition-mode","dfnText":"exit composition mode","external":false,"refSections":[{"refs":[{"id":"ref-for-exit-composition-mode"}],"title":"10.9. handle pre browser key"}],"url":"#exit-composition-mode"},
"fire-a-compositionevent": {"dfnID":"fire-a-compositionevent","dfnText":"fire a CompositionEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-fire-a-compositionevent"}],"title":"8.4. fire an InputEvent"},{"refs":[{"id":"ref-for-fire-a-compositionevent\u2460"}],"title":"11.7. handle composition key"},{"refs":[{"id":"ref-for-fire-a-compositionevent\u2461"}],"title":"11.8. begin composition"},{"refs":[{"id":"ref-for-fire-a-compositionevent\u2462"}],"title":"11.9. end composition"}],"url":"#fire-a-compositionevent"},
"fire-a-textevent①": {"dfnID":"fire-a-textevent\u2460","dfnText":"fire a TextEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-fire-a-textevent\u2460"}],"title":"8.3. fire key input events"},{"refs":[{"id":"ref-for-fire-a-textevent\u2460\u2460"}],"title":"11.9. end composition"},{"refs":[{"id":"ref-for-fire-a-textevent\u2460\u2461"}],"title":"17.3. handle native paste"}],"url":"#fire-a-textevent\u2460"},
"fire-an-inputevent": {"dfnID":"fire-an-inputevent","dfnText":"fire an InputEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-fire-an-inputevent"},{"id":"ref-for-fire-an-inputevent\u2460"}],"title":"8.3. fire key input events"},{"refs":[{"id":"ref-for-fire-an-inputevent\u2461"},{"id":"ref-for-fire-an-inputevent\u2462"}],"title":"11.7. handle composition key"},{"refs":[{"id":"ref-for-fire-an-inputevent\u2463"}],"title":"11.9. end composition"},{"refs":[{"id":"ref-for-fire-an-inputevent\u2464"},{"id":"ref-for-fire-an-inputevent\u2465"}],"title":"17.1. handle native cut"},{"refs":[{"id":"ref-for-fire-an-inputevent\u2466"},{"id":"ref-for-fire-an-inputevent\u2467"}],"title":"17.3. handle native paste"}],"url":"#fire-an-inputevent"},
"fire-key-input-events": {"dfnID":"fire-key-input-events","dfnText":"fire key input events","external":false,"refSections":[{"refs":[{"id":"ref-for-fire-key-input-events"}],"title":"10.13. handle native key press"}],"url":"#fire-key-input-events"},
"get-modifier-state": {"dfnID":"get-modifier-state","dfnText":"get modifier state","external":false,"refSections":[{"refs":[{"id":"ref-for-get-modifier-state"}],"title":"10.1. KeyboardEvent Interface"}],"url":"#get-modifier-state"},
"handle-composition-key": {"dfnID":"handle-composition-key","dfnText":"handle composition key","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-composition-key"}],"title":"10.11. handle native key down"},{"refs":[{"id":"ref-for-handle-composition-key\u2460"}],"title":"10.13. handle native key press"},{"refs":[{"id":"ref-for-handle-composition-key\u2461"}],"title":"11.8. begin composition"}],"url":"#handle-composition-key"},
"handle-native-copy": {"dfnID":"handle-native-copy","dfnText":"handle native copy","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-native-copy"}],"title":"2.5.4. Clipboard"},{"refs":[{"id":"ref-for-handle-native-copy\u2460"}],"title":"10.10. handle post browser key"}],"url":"#handle-native-copy"},
"handle-native-cut": {"dfnID":"handle-native-cut","dfnText":"handle native cut","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-native-cut"}],"title":"2.5.4. Clipboard"},{"refs":[{"id":"ref-for-handle-native-cut\u2460"}],"title":"10.10. handle post browser key"}],"url":"#handle-native-cut"},
"handle-native-key-down": {"dfnID":"handle-native-key-down","dfnText":"handle native key down","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-native-key-down"}],"title":"2.5.3. Keyboard"},{"refs":[{"id":"ref-for-handle-native-key-down\u2460"}],"title":"10.13. handle native key press"}],"url":"#handle-native-key-down"},
"handle-native-key-press": {"dfnID":"handle-native-key-press","dfnText":"handle native key press","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-native-key-press"}],"title":"2.5.3. Keyboard"},{"refs":[{"id":"ref-for-handle-native-key-press\u2460"},{"id":"ref-for-handle-native-key-press\u2461"}],"title":"10.11. handle native key down"}],"url":"#handle-native-key-press"},
"handle-native-key-up": {"dfnID":"handle-native-key-up","dfnText":"handle native key up","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-native-key-up"}],"title":"2.5.3. Keyboard"}],"url":"#handle-native-key-up"},
"handle-native-mouse-click": {"dfnID":"handle-native-mouse-click","dfnText":"handle native mouse click","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-native-mouse-click"}],"title":"2.5.1. Mouse"}],"url":"#handle-native-mouse-click"},
"handle-native-mouse-double-click": {"dfnID":"handle-native-mouse-double-click","dfnText":"handle native mouse double click","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-native-mouse-double-click"}],"title":"2.5.1. Mouse"}],"url":"#handle-native-mouse-double-click"},
"handle-native-mouse-down": {"dfnID":"handle-native-mouse-down","dfnText":"handle native mouse down","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-native-mouse-down"}],"title":"2.5.1. Mouse"}],"url":"#handle-native-mouse-down"},
"handle-native-mouse-move": {"dfnID":"handle-native-mouse-move","dfnText":"handle native mouse move","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-native-mouse-move"}],"title":"2.5.1. Mouse"}],"url":"#handle-native-mouse-move"},
"handle-native-mouse-up": {"dfnID":"handle-native-mouse-up","dfnText":"handle native mouse up","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-native-mouse-up"}],"title":"2.5.1. Mouse"},{"refs":[{"id":"ref-for-handle-native-mouse-up\u2460"}],"title":"6.9. handle native mouse click"}],"url":"#handle-native-mouse-up"},
"handle-native-paste": {"dfnID":"handle-native-paste","dfnText":"handle native paste","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-native-paste"}],"title":"2.5.4. Clipboard"},{"refs":[{"id":"ref-for-handle-native-paste\u2460"}],"title":"10.10. handle post browser key"}],"url":"#handle-native-paste"},
"handle-post-browser-key": {"dfnID":"handle-post-browser-key","dfnText":"handle post browser key","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-post-browser-key"}],"title":"10.13. handle native key press"}],"url":"#handle-post-browser-key"},
"handle-pre-browser-key": {"dfnID":"handle-pre-browser-key","dfnText":"handle pre browser key","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-pre-browser-key"}],"title":"10.11. handle native key down"}],"url":"#handle-pre-browser-key"},
"hit-test": {"dfnID":"hit-test","dfnText":"hit test","external":false,"refSections":[{"refs":[{"id":"ref-for-hit-test"}],"title":"6.7. handle native mouse down"},{"refs":[{"id":"ref-for-hit-test\u2460"}],"title":"6.8. handle native mouse up"},{"refs":[{"id":"ref-for-hit-test\u2461"}],"title":"6.9. handle native mouse click"},{"refs":[{"id":"ref-for-hit-test\u2462"}],"title":"6.11. handle native mouse double click"},{"refs":[{"id":"ref-for-hit-test\u2463"}],"title":"6.12. handle native mouse move"}],"url":"#hit-test"},
"in-composition-flag": {"dfnID":"in-composition-flag","dfnText":"in composition flag","external":false,"refSections":[{"refs":[{"id":"ref-for-in-composition-flag"}],"title":"10.11. handle native key down"},{"refs":[{"id":"ref-for-in-composition-flag\u2460"},{"id":"ref-for-in-composition-flag\u2461"}],"title":"11.8. begin composition"},{"refs":[{"id":"ref-for-in-composition-flag\u2462"},{"id":"ref-for-in-composition-flag\u2463"}],"title":"11.9. end composition"}],"url":"#in-composition-flag"},
"initialize-a-compositionevent": {"dfnID":"initialize-a-compositionevent","dfnText":"initialize a CompositionEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-a-compositionevent"}],"title":"11.3. create a CompositionEvent"}],"url":"#initialize-a-compositionevent"},
"initialize-a-keyboardevent": {"dfnID":"initialize-a-keyboardevent","dfnText":"initialize a KeyboardEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-a-keyboardevent"}],"title":"10.4. create a KeyboardEvent"}],"url":"#initialize-a-keyboardevent"},
"initialize-a-mouseevent": {"dfnID":"initialize-a-mouseevent","dfnText":"initialize a MouseEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-a-mouseevent"}],"title":"6.4. create a MouseEvent"},{"refs":[{"id":"ref-for-initialize-a-mouseevent\u2460"}],"title":"12.1. initialize a PointerEvent"}],"url":"#initialize-a-mouseevent"},
"initialize-a-pointerevent": {"dfnID":"initialize-a-pointerevent","dfnText":"initialize a PointerEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-a-pointerevent"}],"title":"12.2. create a PointerEvent"},{"refs":[{"id":"ref-for-initialize-a-pointerevent\u2460"}],"title":"12.3. create PointerEvent from MouseEvent"}],"url":"#initialize-a-pointerevent"},
"initialize-a-textevent①": {"dfnID":"initialize-a-textevent\u2460","dfnText":"initialize a TextEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-a-textevent\u2460"}],"title":"9.3. create a TextEvent"}],"url":"#initialize-a-textevent\u2460"},
"initialize-a-uievent": {"dfnID":"initialize-a-uievent","dfnText":"initialize a UIEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-a-uievent"}],"title":"6.3. initialize a MouseEvent"},{"refs":[{"id":"ref-for-initialize-a-uievent\u2460"}],"title":"8.1. initialize an InputEvent"},{"refs":[{"id":"ref-for-initialize-a-uievent\u2461"}],"title":"9.1. TextEvent Interface"},{"refs":[{"id":"ref-for-initialize-a-uievent\u2462"}],"title":"9.2. initialize a TextEvent"},{"refs":[{"id":"ref-for-initialize-a-uievent\u2463"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-initialize-a-uievent\u2464"}],"title":"11.2. initialize a CompositionEvent"}],"url":"#initialize-a-uievent"},
"initialize-an-event": {"dfnID":"initialize-an-event","dfnText":"initialize an Event","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-an-event"}],"title":"4.2. initialize a UIEvent"}],"url":"#initialize-an-event"},
"initialize-an-inputevent": {"dfnID":"initialize-an-inputevent","dfnText":"initialize an InputEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-an-inputevent"}],"title":"8.2. create an InputEvent"}],"url":"#initialize-an-inputevent"},
"initialize-cssom-attributes-for-mouseevent": {"dfnID":"initialize-cssom-attributes-for-mouseevent","dfnText":"initialize CSSOM attributes for MouseEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-cssom-attributes-for-mouseevent"}],"title":"6.3. initialize a MouseEvent"}],"url":"#initialize-cssom-attributes-for-mouseevent"},
"initialize-pointerlock-attributes-for-mouseevent": {"dfnID":"initialize-pointerlock-attributes-for-mouseevent","dfnText":"initialize PointerLock attributes for MouseEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-pointerlock-attributes-for-mouseevent"}],"title":"6.3. initialize a MouseEvent"}],"url":"#initialize-pointerlock-attributes-for-mouseevent"},
"key-modifier-state": {"dfnID":"key-modifier-state","dfnText":"key modifier state","external":false,"refSections":[{"refs":[{"id":"ref-for-key-modifier-state"},{"id":"ref-for-key-modifier-state\u2460"},{"id":"ref-for-key-modifier-state\u2461"},{"id":"ref-for-key-modifier-state\u2462"},{"id":"ref-for-key-modifier-state\u2463"},{"id":"ref-for-key-modifier-state\u2464"},{"id":"ref-for-key-modifier-state\u2465"}],"title":"10.5. set event modifiers"},{"refs":[{"id":"ref-for-key-modifier-state\u2466"},{"id":"ref-for-key-modifier-state\u2467"},{"id":"ref-for-key-modifier-state\u2468"},{"id":"ref-for-key-modifier-state\u2460\u24ea"},{"id":"ref-for-key-modifier-state\u2460\u2460"}],"title":"10.11. handle native key down"},{"refs":[{"id":"ref-for-key-modifier-state\u2460\u2461"},{"id":"ref-for-key-modifier-state\u2460\u2462"},{"id":"ref-for-key-modifier-state\u2460\u2463"},{"id":"ref-for-key-modifier-state\u2460\u2464"},{"id":"ref-for-key-modifier-state\u2460\u2465"}],"title":"10.12. handle native key up"}],"url":"#key-modifier-state"},
"keyboard-lock-enable-flag": {"dfnID":"keyboard-lock-enable-flag","dfnText":"keyboard lock enable flag","external":false,"refSections":[{"refs":[{"id":"ref-for-keyboard-lock-enable-flag"}],"title":"14.2. Keyboard Lock is enabled"}],"url":"#keyboard-lock-enable-flag"},
"keyboard-lock-is-enabled": {"dfnID":"keyboard-lock-is-enabled","dfnText":"Keyboard Lock is enabled","external":false,"refSections":[{"refs":[{"id":"ref-for-keyboard-lock-is-enabled"}],"title":"10.9. handle pre browser key"},{"refs":[{"id":"ref-for-keyboard-lock-is-enabled\u2460"}],"title":"10.10. handle post browser key"}],"url":"#keyboard-lock-is-enabled"},
"keyboardevent-alt-flag": {"dfnID":"keyboardevent-alt-flag","dfnText":"alt flag","external":false,"refSections":[{"refs":[{"id":"ref-for-keyboardevent-alt-flag"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-keyboardevent-alt-flag\u2460"},{"id":"ref-for-keyboardevent-alt-flag\u2461"}],"title":"10.5. set event modifiers"},{"refs":[{"id":"ref-for-keyboardevent-alt-flag\u2462"}],"title":"10.8. get modifier state"}],"url":"#keyboardevent-alt-flag"},
"keyboardevent-altgraph-flag": {"dfnID":"keyboardevent-altgraph-flag","dfnText":"altgraph flag","external":false,"refSections":[{"refs":[{"id":"ref-for-keyboardevent-altgraph-flag"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-keyboardevent-altgraph-flag\u2460"},{"id":"ref-for-keyboardevent-altgraph-flag\u2461"}],"title":"10.5. set event modifiers"},{"refs":[{"id":"ref-for-keyboardevent-altgraph-flag\u2462"}],"title":"10.8. get modifier state"}],"url":"#keyboardevent-altgraph-flag"},
"keyboardevent-capslock-flag": {"dfnID":"keyboardevent-capslock-flag","dfnText":"capslock flag","external":false,"refSections":[{"refs":[{"id":"ref-for-keyboardevent-capslock-flag"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-keyboardevent-capslock-flag\u2460"}],"title":"10.5. set event modifiers"},{"refs":[{"id":"ref-for-keyboardevent-capslock-flag\u2461"}],"title":"10.8. get modifier state"}],"url":"#keyboardevent-capslock-flag"},
"keyboardevent-control-flag": {"dfnID":"keyboardevent-control-flag","dfnText":"control flag","external":false,"refSections":[{"refs":[{"id":"ref-for-keyboardevent-control-flag"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-keyboardevent-control-flag\u2460"},{"id":"ref-for-keyboardevent-control-flag\u2461"}],"title":"10.5. set event modifiers"},{"refs":[{"id":"ref-for-keyboardevent-control-flag\u2462"}],"title":"10.8. get modifier state"}],"url":"#keyboardevent-control-flag"},
"keyboardevent-meta-flag": {"dfnID":"keyboardevent-meta-flag","dfnText":"meta flag","external":false,"refSections":[{"refs":[{"id":"ref-for-keyboardevent-meta-flag"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-keyboardevent-meta-flag\u2460"},{"id":"ref-for-keyboardevent-meta-flag\u2461"}],"title":"10.5. set event modifiers"},{"refs":[{"id":"ref-for-keyboardevent-meta-flag\u2462"}],"title":"10.8. get modifier state"}],"url":"#keyboardevent-meta-flag"},
"keyboardevent-numlock-flag": {"dfnID":"keyboardevent-numlock-flag","dfnText":"numlock flag","external":false,"refSections":[{"refs":[{"id":"ref-for-keyboardevent-numlock-flag"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-keyboardevent-numlock-flag\u2460"}],"title":"10.5. set event modifiers"},{"refs":[{"id":"ref-for-keyboardevent-numlock-flag\u2461"}],"title":"10.8. get modifier state"}],"url":"#keyboardevent-numlock-flag"},
"keyboardevent-shift-flag": {"dfnID":"keyboardevent-shift-flag","dfnText":"shift flag","external":false,"refSections":[{"refs":[{"id":"ref-for-keyboardevent-shift-flag"}],"title":"10.3. initialize a KeyboardEvent"},{"refs":[{"id":"ref-for-keyboardevent-shift-flag\u2460"},{"id":"ref-for-keyboardevent-shift-flag\u2461"}],"title":"10.5. set event modifiers"},{"refs":[{"id":"ref-for-keyboardevent-shift-flag\u2462"}],"title":"10.8. get modifier state"}],"url":"#keyboardevent-shift-flag"},
"last-mouse-dom-path": {"dfnID":"last-mouse-dom-path","dfnText":"last mouse DOM path","external":false,"refSections":[{"refs":[{"id":"ref-for-last-mouse-dom-path"},{"id":"ref-for-last-mouse-dom-path\u2460"},{"id":"ref-for-last-mouse-dom-path\u2461"}],"title":"6.12. handle native mouse move"}],"url":"#last-mouse-dom-path"},
"last-mouse-element": {"dfnID":"last-mouse-element","dfnText":"last mouse element","external":false,"refSections":[{"refs":[{"id":"ref-for-last-mouse-element"}],"title":"6.2.2. Window-Level State"},{"refs":[{"id":"ref-for-last-mouse-element\u2460"},{"id":"ref-for-last-mouse-element\u2461"},{"id":"ref-for-last-mouse-element\u2462"},{"id":"ref-for-last-mouse-element\u2463"}],"title":"6.12. handle native mouse move"}],"url":"#last-mouse-element"},
"last-mouse-move": {"dfnID":"last-mouse-move","dfnText":"last mouse move","external":false,"refSections":[{"refs":[{"id":"ref-for-last-mouse-move"},{"id":"ref-for-last-mouse-move\u2460"},{"id":"ref-for-last-mouse-move\u2461"},{"id":"ref-for-last-mouse-move\u2462"}],"title":"13.4. set PointerLock attributes for mousemove"}],"url":"#last-mouse-move"},
"maybe-send-pointerdown-event": {"dfnID":"maybe-send-pointerdown-event","dfnText":"maybe send pointerdown event","external":false,"refSections":[{"refs":[{"id":"ref-for-maybe-send-pointerdown-event"}],"title":"6.7. handle native mouse down"}],"url":"#maybe-send-pointerdown-event"},
"maybe-send-pointerenter-event": {"dfnID":"maybe-send-pointerenter-event","dfnText":"maybe send pointerenter event","external":false,"refSections":[{"refs":[{"id":"ref-for-maybe-send-pointerenter-event"}],"title":"6.12. handle native mouse move"}],"url":"#maybe-send-pointerenter-event"},
"maybe-send-pointerleave-event": {"dfnID":"maybe-send-pointerleave-event","dfnText":"maybe send pointerleave event","external":false,"refSections":[{"refs":[{"id":"ref-for-maybe-send-pointerleave-event"}],"title":"6.12. handle native mouse move"}],"url":"#maybe-send-pointerleave-event"},
"maybe-send-pointermove-event": {"dfnID":"maybe-send-pointermove-event","dfnText":"maybe send pointermove event","external":false,"refSections":[{"refs":[{"id":"ref-for-maybe-send-pointermove-event"}],"title":"6.12. handle native mouse move"}],"url":"#maybe-send-pointermove-event"},
"maybe-send-pointerout-event": {"dfnID":"maybe-send-pointerout-event","dfnText":"maybe send pointerout event","external":false,"refSections":[{"refs":[{"id":"ref-for-maybe-send-pointerout-event"}],"title":"6.12. handle native mouse move"}],"url":"#maybe-send-pointerout-event"},
"maybe-send-pointerover-event": {"dfnID":"maybe-send-pointerover-event","dfnText":"maybe send pointerover event","external":false,"refSections":[{"refs":[{"id":"ref-for-maybe-send-pointerover-event"}],"title":"6.12. handle native mouse move"}],"url":"#maybe-send-pointerover-event"},
"maybe-send-pointerup-event": {"dfnID":"maybe-send-pointerup-event","dfnText":"maybe send pointerup event","external":false,"refSections":[{"refs":[{"id":"ref-for-maybe-send-pointerup-event"}],"title":"6.8. handle native mouse up"}],"url":"#maybe-send-pointerup-event"},
"maybe-show-context-menu": {"dfnID":"maybe-show-context-menu","dfnText":"maybe show context menu","external":false,"refSections":[{"refs":[{"id":"ref-for-maybe-show-context-menu"}],"title":"6.7. handle native mouse down"}],"url":"#maybe-show-context-menu"},
"mouse-button-bitmask": {"dfnID":"mouse-button-bitmask","dfnText":"mouse button bitmask","external":false,"refSections":[{"refs":[{"id":"ref-for-mouse-button-bitmask"}],"title":"6.3. initialize a MouseEvent"},{"refs":[{"id":"ref-for-mouse-button-bitmask\u2460"}],"title":"6.7. handle native mouse down"},{"refs":[{"id":"ref-for-mouse-button-bitmask\u2461"}],"title":"6.8. handle native mouse up"}],"url":"#mouse-button-bitmask"},
"send-click-event": {"dfnID":"send-click-event","dfnText":"send click event","external":false,"refSections":[{"refs":[{"id":"ref-for-send-click-event"}],"title":"6.9. handle native mouse click"}],"url":"#send-click-event"},
"set-event-modifiers": {"dfnID":"set-event-modifiers","dfnText":"set event modifiers","external":false,"refSections":[{"refs":[{"id":"ref-for-set-event-modifiers"}],"title":"6.3. initialize a MouseEvent"},{"refs":[{"id":"ref-for-set-event-modifiers\u2460"}],"title":"10.6. set KeyboardEvent attributes"}],"url":"#set-event-modifiers"},
"set-keyboardevent-attributes": {"dfnID":"set-keyboardevent-attributes","dfnText":"set KeyboardEvent attributes","external":false,"refSections":[{"refs":[{"id":"ref-for-set-keyboardevent-attributes"}],"title":"10.11. handle native key down"},{"refs":[{"id":"ref-for-set-keyboardevent-attributes\u2460"}],"title":"10.12. handle native key up"}],"url":"#set-keyboardevent-attributes"},
"set-mouseevent-attributes-from-native": {"dfnID":"set-mouseevent-attributes-from-native","dfnText":"set MouseEvent attributes from native","external":false,"refSections":[{"refs":[{"id":"ref-for-set-mouseevent-attributes-from-native"}],"title":"6.7. handle native mouse down"},{"refs":[{"id":"ref-for-set-mouseevent-attributes-from-native\u2460"}],"title":"6.8. handle native mouse up"},{"refs":[{"id":"ref-for-set-mouseevent-attributes-from-native\u2461"}],"title":"6.10. send click event"},{"refs":[{"id":"ref-for-set-mouseevent-attributes-from-native\u2462"}],"title":"6.11. handle native mouse double click"},{"refs":[{"id":"ref-for-set-mouseevent-attributes-from-native\u2463"}],"title":"6.13. maybe show context menu"}],"url":"#set-mouseevent-attributes-from-native"},
"set-pointerlock-attributes-for-mousemove": {"dfnID":"set-pointerlock-attributes-for-mousemove","dfnText":"set PointerLock attributes for mousemove","external":false,"refSections":[{"refs":[{"id":"ref-for-set-pointerlock-attributes-for-mousemove"}],"title":"6.12. handle native mouse move"}],"url":"#set-pointerlock-attributes-for-mousemove"},
"suppress-key-input-events-flag": {"dfnID":"suppress-key-input-events-flag","dfnText":"suppress key input events flag","external":false,"refSections":[{"refs":[{"id":"ref-for-suppress-key-input-events-flag"}],"title":"8.3. fire key input events"},{"refs":[{"id":"ref-for-suppress-key-input-events-flag\u2460"},{"id":"ref-for-suppress-key-input-events-flag\u2461"}],"title":"10.11. handle native key down"}],"url":"#suppress-key-input-events-flag"},
"textevent①": {"dfnID":"textevent\u2460","dfnText":"TextEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-textevent\u2460"}],"title":"9. Text Event"},{"refs":[{"id":"ref-for-textevent\u2460\u2460"}],"title":"9.3. create a TextEvent"}],"url":"#textevent\u2460"},
"uievent-due-to-user-interaction-flag": {"dfnID":"uievent-due-to-user-interaction-flag","dfnText":"due to user interaction flag","external":false,"refSections":[{"refs":[{"id":"ref-for-uievent-due-to-user-interaction-flag"}],"title":"3.2. initialize an Event"},{"refs":[{"id":"ref-for-uievent-due-to-user-interaction-flag\u2460"}],"title":"4.2. initialize a UIEvent"}],"url":"#uievent-due-to-user-interaction-flag"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getRootLevelAbsolutePosition(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// Returns the root-level absolute position {left and top} of element.
function getRootLevelAbsolutePosition(el) {
    const boundsRect = el.getBoundingClientRect();
    let xPos = 0;
    let yPos = 0;

    while (el) {
        let xScroll = el.scrollLeft;
        let yScroll = el.scrollTop;

        // Ignore scrolling of body.
        if (el.tagName === "BODY") {
            xScroll = 0;
            yScroll = 0;
        }
        xPos += (el.offsetLeft - xScroll + el.clientLeft);
        yPos += (el.offsetTop - yScroll + el.clientTop);

        el = el.offsetParent;
    }
    return {
        left: xPos,
        top: yPos,
        right: xPos + boundsRect.width,
        bottom: yPos + boundsRect.height,
    };
}

function scrolledIntoView(element) {
    const rect = element.getBoundingClientRect();
    return (
        rect.top > 0 &&
        rect.bottom < window.innerHeight
    );
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            // Maybe prevent default scroll.
            if (scrolledIntoView(dest)) {
                event.preventDefault();
            }
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#begin-composition": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"begin composition","type":"dfn","url":"#begin-composition"},
"#calculate-dom-path": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"calculate dom path","type":"dfn","url":"#calculate-dom-path"},
"#calculate-key-location": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"calculate key location","type":"dfn","url":"#calculate-key-location"},
"#calculate-mouseevent-button-attribute": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"calculate mouseevent button attribute","type":"dfn","url":"#calculate-mouseevent-button-attribute"},
"#composition-mode-flag": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"composition mode flag","type":"dfn","url":"#composition-mode-flag"},
"#create-a-compositionevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"create a compositionevent","type":"dfn","url":"#create-a-compositionevent"},
"#create-a-keyboardevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"create a keyboardevent","type":"dfn","url":"#create-a-keyboardevent"},
"#create-a-mouseevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"create a mouseevent","type":"dfn","url":"#create-a-mouseevent"},
"#create-a-pointerevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"create a pointerevent","type":"dfn","url":"#create-a-pointerevent"},
"#create-a-textevent①": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"create a textevent","type":"dfn","url":"#create-a-textevent\u2460"},
"#create-an-inputevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"create an inputevent","type":"dfn","url":"#create-an-inputevent"},
"#create-pointerevent-from-mouseevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"create pointerevent from mouseevent","type":"dfn","url":"#create-pointerevent-from-mouseevent"},
"#dom-keyboardevent-altkey": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"altKey","type":"attribute","url":"#dom-keyboardevent-altkey"},
"#dom-keyboardevent-code": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"code","type":"attribute","url":"#dom-keyboardevent-code"},
"#dom-keyboardevent-ctrlkey": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"ctrlKey","type":"attribute","url":"#dom-keyboardevent-ctrlkey"},
"#dom-keyboardevent-dom_key_location_left": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"DOM_KEY_LOCATION_LEFT","type":"const","url":"#dom-keyboardevent-dom_key_location_left"},
"#dom-keyboardevent-dom_key_location_numpad": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"DOM_KEY_LOCATION_NUMPAD","type":"const","url":"#dom-keyboardevent-dom_key_location_numpad"},
"#dom-keyboardevent-dom_key_location_right": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"DOM_KEY_LOCATION_RIGHT","type":"const","url":"#dom-keyboardevent-dom_key_location_right"},
"#dom-keyboardevent-dom_key_location_standard": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"DOM_KEY_LOCATION_STANDARD","type":"const","url":"#dom-keyboardevent-dom_key_location_standard"},
"#dom-keyboardevent-iscomposing": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"isComposing","type":"attribute","url":"#dom-keyboardevent-iscomposing"},
"#dom-keyboardevent-key": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"key","type":"attribute","url":"#dom-keyboardevent-key"},
"#dom-keyboardevent-keycode": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"keyCode","type":"attribute","url":"#dom-keyboardevent-keycode"},
"#dom-keyboardevent-location": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"location","type":"attribute","url":"#dom-keyboardevent-location"},
"#dom-keyboardevent-metakey": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"metaKey","type":"attribute","url":"#dom-keyboardevent-metakey"},
"#dom-keyboardevent-repeat": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"repeat","type":"attribute","url":"#dom-keyboardevent-repeat"},
"#dom-keyboardevent-shiftkey": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"shiftKey","type":"attribute","url":"#dom-keyboardevent-shiftkey"},
"#dom-keyboardevent-which": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"which","type":"attribute","url":"#dom-keyboardevent-which"},
"#dom-mouseevent-button": {"export":true,"for_":["MouseEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"button","type":"attribute","url":"#dom-mouseevent-button"},
"#dom-mouseevent-buttons": {"export":true,"for_":["MouseEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"buttons","type":"attribute","url":"#dom-mouseevent-buttons"},
"#dom-mouseevent-clientx": {"export":true,"for_":["MouseEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"clientX","type":"attribute","url":"#dom-mouseevent-clientx"},
"#dom-mouseevent-clienty": {"export":true,"for_":["MouseEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"clientY","type":"attribute","url":"#dom-mouseevent-clienty"},
"#dom-mouseevent-movementx": {"export":true,"for_":["MouseEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"movementX","type":"attribute","url":"#dom-mouseevent-movementx"},
"#dom-mouseevent-movementy": {"export":true,"for_":["MouseEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"movementY","type":"attribute","url":"#dom-mouseevent-movementy"},
"#dom-mouseevent-screenx": {"export":true,"for_":["MouseEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"screenX","type":"attribute","url":"#dom-mouseevent-screenx"},
"#dom-mouseevent-screeny": {"export":true,"for_":["MouseEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"screenY","type":"attribute","url":"#dom-mouseevent-screeny"},
"#dom-textevent-data": {"export":true,"for_":["TextEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"data","type":"attribute","url":"#dom-textevent-data"},
"#dom-textevent-inittextevent": {"export":true,"for_":["TextEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"initTextEvent(type, bubbles, cancelable, view, data)","type":"method","url":"#dom-textevent-inittextevent"},
"#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles": {"export":true,"for_":["TextEvent/initTextEvent(type)","TextEvent/initTextEvent(type, bubbles)","TextEvent/initTextEvent(type, bubbles, cancelable)","TextEvent/initTextEvent(type, bubbles, cancelable, view)","TextEvent/initTextEvent(type, bubbles, cancelable, view, data)"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"bubbles","type":"argument","url":"#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-bubbles"},
"#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable": {"export":true,"for_":["TextEvent/initTextEvent(type)","TextEvent/initTextEvent(type, bubbles)","TextEvent/initTextEvent(type, bubbles, cancelable)","TextEvent/initTextEvent(type, bubbles, cancelable, view)","TextEvent/initTextEvent(type, bubbles, cancelable, view, data)"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"cancelable","type":"argument","url":"#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-cancelable"},
"#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type": {"export":true,"for_":["TextEvent/initTextEvent(type)","TextEvent/initTextEvent(type, bubbles)","TextEvent/initTextEvent(type, bubbles, cancelable)","TextEvent/initTextEvent(type, bubbles, cancelable, view)","TextEvent/initTextEvent(type, bubbles, cancelable, view, data)"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"type","type":"argument","url":"#dom-textevent-inittextevent-type-bubbles-cancelable-view-data-type"},
"#dom-uievent-detail": {"export":true,"for_":["UIEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"detail","type":"attribute","url":"#dom-uievent-detail"},
"#dom-uievent-view": {"export":true,"for_":["UIEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"view","type":"attribute","url":"#dom-uievent-view"},
"#end-composition": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"end composition","type":"dfn","url":"#end-composition"},
"#enter-composition-mode": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"enter composition mode","type":"dfn","url":"#enter-composition-mode"},
"#exit-composition-mode": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"exit composition mode","type":"dfn","url":"#exit-composition-mode"},
"#fire-a-compositionevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"fire a compositionevent","type":"dfn","url":"#fire-a-compositionevent"},
"#fire-a-textevent①": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"fire a textevent","type":"dfn","url":"#fire-a-textevent\u2460"},
"#fire-an-inputevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"fire an inputevent","type":"dfn","url":"#fire-an-inputevent"},
"#fire-key-input-events": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"fire key input events","type":"dfn","url":"#fire-key-input-events"},
"#get-modifier-state": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"get modifier state","type":"dfn","url":"#get-modifier-state"},
"#handle-composition-key": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle composition key","type":"dfn","url":"#handle-composition-key"},
"#handle-native-copy": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle native copy","type":"dfn","url":"#handle-native-copy"},
"#handle-native-cut": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle native cut","type":"dfn","url":"#handle-native-cut"},
"#handle-native-key-down": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle native key down","type":"dfn","url":"#handle-native-key-down"},
"#handle-native-key-press": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle native key press","type":"dfn","url":"#handle-native-key-press"},
"#handle-native-key-up": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle native key up","type":"dfn","url":"#handle-native-key-up"},
"#handle-native-mouse-click": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle native mouse click","type":"dfn","url":"#handle-native-mouse-click"},
"#handle-native-mouse-double-click": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle native mouse double click","type":"dfn","url":"#handle-native-mouse-double-click"},
"#handle-native-mouse-down": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle native mouse down","type":"dfn","url":"#handle-native-mouse-down"},
"#handle-native-mouse-move": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle native mouse move","type":"dfn","url":"#handle-native-mouse-move"},
"#handle-native-mouse-up": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle native mouse up","type":"dfn","url":"#handle-native-mouse-up"},
"#handle-native-paste": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle native paste","type":"dfn","url":"#handle-native-paste"},
"#handle-post-browser-key": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle post browser key","type":"dfn","url":"#handle-post-browser-key"},
"#handle-pre-browser-key": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"handle pre browser key","type":"dfn","url":"#handle-pre-browser-key"},
"#hit-test": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"hit test","type":"dfn","url":"#hit-test"},
"#in-composition-flag": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"in composition flag","type":"dfn","url":"#in-composition-flag"},
"#initialize-a-compositionevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"initialize a compositionevent","type":"dfn","url":"#initialize-a-compositionevent"},
"#initialize-a-keyboardevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"initialize a keyboardevent","type":"dfn","url":"#initialize-a-keyboardevent"},
"#initialize-a-mouseevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"initialize a mouseevent","type":"dfn","url":"#initialize-a-mouseevent"},
"#initialize-a-pointerevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"initialize a pointerevent","type":"dfn","url":"#initialize-a-pointerevent"},
"#initialize-a-textevent①": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"initialize a textevent","type":"dfn","url":"#initialize-a-textevent\u2460"},
"#initialize-a-uievent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"initialize a uievent","type":"dfn","url":"#initialize-a-uievent"},
"#initialize-an-event": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"initialize an event","type":"dfn","url":"#initialize-an-event"},
"#initialize-an-inputevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"initialize an inputevent","type":"dfn","url":"#initialize-an-inputevent"},
"#initialize-cssom-attributes-for-mouseevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"initialize cssom attributes for mouseevent","type":"dfn","url":"#initialize-cssom-attributes-for-mouseevent"},
"#initialize-pointerlock-attributes-for-mouseevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"initialize pointerlock attributes for mouseevent","type":"dfn","url":"#initialize-pointerlock-attributes-for-mouseevent"},
"#key-modifier-state": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"key modifier state","type":"dfn","url":"#key-modifier-state"},
"#keyboard-lock-enable-flag": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"keyboard lock enable flag","type":"dfn","url":"#keyboard-lock-enable-flag"},
"#keyboard-lock-is-enabled": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"keyboard lock is enabled","type":"dfn","url":"#keyboard-lock-is-enabled"},
"#keyboardevent-alt-flag": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"alt flag","type":"dfn","url":"#keyboardevent-alt-flag"},
"#keyboardevent-altgraph-flag": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"altgraph flag","type":"dfn","url":"#keyboardevent-altgraph-flag"},
"#keyboardevent-capslock-flag": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"capslock flag","type":"dfn","url":"#keyboardevent-capslock-flag"},
"#keyboardevent-control-flag": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"control flag","type":"dfn","url":"#keyboardevent-control-flag"},
"#keyboardevent-meta-flag": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"meta flag","type":"dfn","url":"#keyboardevent-meta-flag"},
"#keyboardevent-numlock-flag": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"numlock flag","type":"dfn","url":"#keyboardevent-numlock-flag"},
"#keyboardevent-shift-flag": {"export":true,"for_":["KeyboardEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"shift flag","type":"dfn","url":"#keyboardevent-shift-flag"},
"#last-mouse-dom-path": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"last mouse dom path","type":"dfn","url":"#last-mouse-dom-path"},
"#last-mouse-element": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"last mouse element","type":"dfn","url":"#last-mouse-element"},
"#last-mouse-move": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"last mouse move","type":"dfn","url":"#last-mouse-move"},
"#maybe-send-pointerdown-event": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"maybe send pointerdown event","type":"dfn","url":"#maybe-send-pointerdown-event"},
"#maybe-send-pointerenter-event": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"maybe send pointerenter event","type":"dfn","url":"#maybe-send-pointerenter-event"},
"#maybe-send-pointerleave-event": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"maybe send pointerleave event","type":"dfn","url":"#maybe-send-pointerleave-event"},
"#maybe-send-pointermove-event": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"maybe send pointermove event","type":"dfn","url":"#maybe-send-pointermove-event"},
"#maybe-send-pointerout-event": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"maybe send pointerout event","type":"dfn","url":"#maybe-send-pointerout-event"},
"#maybe-send-pointerover-event": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"maybe send pointerover event","type":"dfn","url":"#maybe-send-pointerover-event"},
"#maybe-send-pointerup-event": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"maybe send pointerup event","type":"dfn","url":"#maybe-send-pointerup-event"},
"#maybe-show-context-menu": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"maybe show context menu","type":"dfn","url":"#maybe-show-context-menu"},
"#mouse-button-bitmask": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"mouse button bitmask","type":"dfn","url":"#mouse-button-bitmask"},
"#send-click-event": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"send click event","type":"dfn","url":"#send-click-event"},
"#set-event-modifiers": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"set event modifiers","type":"dfn","url":"#set-event-modifiers"},
"#set-keyboardevent-attributes": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"set keyboardevent attributes","type":"dfn","url":"#set-keyboardevent-attributes"},
"#set-mouseevent-attributes-from-native": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"set mouseevent attributes from native","type":"dfn","url":"#set-mouseevent-attributes-from-native"},
"#set-pointerlock-attributes-for-mousemove": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"set pointerlock attributes for mousemove","type":"dfn","url":"#set-pointerlock-attributes-for-mousemove"},
"#suppress-key-input-events-flag": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"suppress key input events flag","type":"dfn","url":"#suppress-key-input-events-flag"},
"#textevent①": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"TextEvent","type":"interface","url":"#textevent\u2460"},
"#uievent-due-to-user-interaction-flag": {"export":true,"for_":["UIEvent"],"level":"","normative":true,"shortname":"uievents-algo","spec":"uievents-algo","status":"local","text":"due to user interaction flag","type":"dfn","url":"#uievent-due-to-user-interaction-flag"},
"https://dom.spec.whatwg.org/#canceled-flag": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"canceled flag","type":"dfn","url":"https://dom.spec.whatwg.org/#canceled-flag"},
"https://dom.spec.whatwg.org/#composed-flag": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"composed flag","type":"dfn","url":"https://dom.spec.whatwg.org/#composed-flag"},
"https://dom.spec.whatwg.org/#concept-event-dispatch": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"dispatch","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-event-dispatch"},
"https://dom.spec.whatwg.org/#concept-node-document": {"export":true,"for_":["Node"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"node document","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-node-document"},
"https://dom.spec.whatwg.org/#dispatch-flag": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"dispatch flag","type":"dfn","url":"https://dom.spec.whatwg.org/#dispatch-flag"},
"https://dom.spec.whatwg.org/#dom-event-composed": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"composed","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-event-composed"},
"https://dom.spec.whatwg.org/#dom-event-currenttarget": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"currentTarget","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-event-currenttarget"},
"https://dom.spec.whatwg.org/#dom-event-defaultprevented": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"defaultPrevented","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-event-defaultprevented"},
"https://dom.spec.whatwg.org/#dom-event-eventphase": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"eventPhase","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-event-eventphase"},
"https://dom.spec.whatwg.org/#dom-event-istrusted": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"isTrusted","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-event-istrusted"},
"https://dom.spec.whatwg.org/#dom-event-none": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"NONE","type":"const","url":"https://dom.spec.whatwg.org/#dom-event-none"},
"https://dom.spec.whatwg.org/#dom-event-target": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"target","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-event-target"},
"https://dom.spec.whatwg.org/#dom-event-timestamp": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"timeStamp","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-event-timestamp"},
"https://dom.spec.whatwg.org/#element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"Element","type":"interface","url":"https://dom.spec.whatwg.org/#element"},
"https://dom.spec.whatwg.org/#event": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"Event","type":"interface","url":"https://dom.spec.whatwg.org/#event"},
"https://dom.spec.whatwg.org/#eventtarget": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"EventTarget","type":"interface","url":"https://dom.spec.whatwg.org/#eventtarget"},
"https://dom.spec.whatwg.org/#in-passive-listener-flag": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"in passive listener flag","type":"dfn","url":"https://dom.spec.whatwg.org/#in-passive-listener-flag"},
"https://dom.spec.whatwg.org/#initialized-flag": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"initialized flag","type":"dfn","url":"https://dom.spec.whatwg.org/#initialized-flag"},
"https://dom.spec.whatwg.org/#stop-immediate-propagation-flag": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"stop immediate propagation flag","type":"dfn","url":"https://dom.spec.whatwg.org/#stop-immediate-propagation-flag"},
"https://dom.spec.whatwg.org/#stop-propagation-flag": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"stop propagation flag","type":"dfn","url":"https://dom.spec.whatwg.org/#stop-propagation-flag"},
"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-offsetx": {"export":true,"for_":["MouseEvent"],"level":"1","normative":true,"shortname":"cssom-view","spec":"cssom-view-1","status":"current","text":"offsetX","type":"attribute","url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-offsetx"},
"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-offsety": {"export":true,"for_":["MouseEvent"],"level":"1","normative":true,"shortname":"cssom-view","spec":"cssom-view-1","status":"current","text":"offsetY","type":"attribute","url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-offsety"},
"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-pagex": {"export":true,"for_":["MouseEvent"],"level":"1","normative":true,"shortname":"cssom-view","spec":"cssom-view-1","status":"current","text":"pageX","type":"attribute","url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-pagex"},
"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-pagey": {"export":true,"for_":["MouseEvent"],"level":"1","normative":true,"shortname":"cssom-view","spec":"cssom-view-1","status":"current","text":"pageY","type":"attribute","url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-pagey"},
"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-x": {"export":true,"for_":["MouseEvent"],"level":"1","normative":true,"shortname":"cssom-view","spec":"cssom-view-1","status":"current","text":"x","type":"attribute","url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-x"},
"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-y": {"export":true,"for_":["MouseEvent"],"level":"1","normative":true,"shortname":"cssom-view","spec":"cssom-view-1","status":"current","text":"y","type":"attribute","url":"https://drafts.csswg.org/cssom-view-1/#dom-mouseevent-y"},
"https://html.spec.whatwg.org/#click-focusable": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"click focusable","type":"dfn","url":"https://html.spec.whatwg.org/#click-focusable"},
"https://html.spec.whatwg.org/#focusable-area": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"focusable area","type":"dfn","url":"https://html.spec.whatwg.org/#focusable-area"},
"https://html.spec.whatwg.org/#focusing-steps": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"focusing steps","type":"dfn","url":"https://html.spec.whatwg.org/#focusing-steps"},
"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"Window","type":"interface","url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"},
"https://w3c.github.io/pointerevents/#dom-pointerevent": {"export":true,"for_":[],"level":"3","normative":true,"shortname":"pointerevents","spec":"pointerevents3","status":"current","text":"PointerEvent","type":"interface","url":"https://w3c.github.io/pointerevents/#dom-pointerevent"},
"https://w3c.github.io/uievents/#compositionevent": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"uievents","spec":"uievents","status":"current","text":"CompositionEvent","type":"interface","url":"https://w3c.github.io/uievents/#compositionevent"},
"https://w3c.github.io/uievents/#dom-compositionevent-data": {"export":true,"for_":["CompositionEvent"],"level":"1","normative":true,"shortname":"uievents","spec":"uievents","status":"current","text":"data","type":"attribute","url":"https://w3c.github.io/uievents/#dom-compositionevent-data"},
"https://w3c.github.io/uievents/#dom-inputevent-data": {"export":true,"for_":["InputEvent"],"level":"1","normative":true,"shortname":"uievents","spec":"uievents","status":"current","text":"data","type":"attribute","url":"https://w3c.github.io/uievents/#dom-inputevent-data"},
"https://w3c.github.io/uievents/#dom-keyboardevent-charcode": {"export":true,"for_":["KeyboardEvent"],"level":"1","normative":true,"shortname":"uievents","spec":"uievents","status":"current","text":"charCode","type":"attribute","url":"https://w3c.github.io/uievents/#dom-keyboardevent-charcode"},
"https://w3c.github.io/uievents/#inputevent": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"uievents","spec":"uievents","status":"current","text":"InputEvent","type":"interface","url":"https://w3c.github.io/uievents/#inputevent"},
"https://w3c.github.io/uievents/#keyboardevent": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"uievents","spec":"uievents","status":"current","text":"KeyboardEvent","type":"interface","url":"https://w3c.github.io/uievents/#keyboardevent"},
"https://w3c.github.io/uievents/#mouseevent": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"uievents","spec":"uievents","status":"current","text":"MouseEvent","type":"interface","url":"https://w3c.github.io/uievents/#mouseevent"},
"https://w3c.github.io/uievents/#uievent": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"uievents","spec":"uievents","status":"current","text":"UIEvent","type":"interface","url":"https://w3c.github.io/uievents/#uievent"},
"https://webidl.spec.whatwg.org/#Exposed": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"Exposed","type":"extended-attribute","url":"https://webidl.spec.whatwg.org/#Exposed"},
"https://webidl.spec.whatwg.org/#idl-DOMString": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"DOMString","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-DOMString"},
"https://webidl.spec.whatwg.org/#idl-boolean": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"boolean","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-boolean"},
"https://webidl.spec.whatwg.org/#idl-undefined": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"undefined","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-undefined"},
"https://webidl.spec.whatwg.org/#this": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"this","type":"dfn","url":"https://webidl.spec.whatwg.org/#this"},
"https://www.w3.org/TR/CSS2/visuren.html#viewport": {"export":true,"for_":[],"level":"","normative":true,"shortname":"css2","spec":"css2","status":"anchor-block","text":"viewport","type":"dfn","url":"https://www.w3.org/TR/CSS2/visuren.html#viewport"},
"https://www.w3.org/TR/cssom-view-1/#dom-document-elementfrompoint": {"export":true,"for_":[],"level":"","normative":true,"shortname":"cssom-view","spec":"cssom-view","status":"anchor-block","text":"elementsfrompoint","type":"dfn","url":"https://www.w3.org/TR/cssom-view-1/#dom-document-elementfrompoint"},
"https://www.w3.org/TR/uievents-key/#keys-modifier": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents-key","spec":"uievents-key","status":"anchor-block","text":"modifier key","type":"dfn","url":"https://www.w3.org/TR/uievents-key/#keys-modifier"},
"https://www.w3.org/TR/uievents/#compositionend": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents","spec":"uievents","status":"anchor-block","text":"compositionend","type":"dfn","url":"https://www.w3.org/TR/uievents/#compositionend"},
"https://www.w3.org/TR/uievents/#compositionstart": {"export":true,"for_":[],"level":"","normative":true,"shortname":"uievents","spec":"uievents","status":"anchor-block","text":"compositionstart","type":"dfn","url":"https://www.w3.org/TR/uievents/#compositionstart"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.text != linkText) {
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.text)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const ref = refsData[url];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getRootLevelAbsolutePosition(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getRootLevelAbsolutePosition(el) {
    const boundsRect = el.getBoundingClientRect();
    let xPos = 0;
    let yPos = 0;

    while (el) {
        let xScroll = el.scrollLeft;
        let yScroll = el.scrollTop;

        // Ignore scrolling of body.
        if (el.tagName === "BODY") {
            xScroll = 0;
            yScroll = 0;
        }
        xPos += (el.offsetLeft - xScroll + el.clientLeft);
        yPos += (el.offsetTop - yScroll + el.clientTop);

        el = el.offsetParent;
    }
    return {
        left: xPos,
        top: yPos,
        right: xPos + boundsRect.width,
        bottom: yPos + boundsRect.height,
    };
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mouseover", e=>{
        let link = e.target.closest("a");
        if(link) showRefHint(link);
    });
    document.body.addEventListener("focus", e=>{
        let link = e.target.closest("a");
        if(link) showRefHint(link);
    });

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all link panels.
        hideAllRefHints();
    });
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>
<script>/* Boilerplate: script-var-click-highlighting */
"use strict";
{
/*
Color-choosing design:

* Colors are ordered by goodness.
* On clicking a var, give it the earliest color
    with the lowest usage in the algorithm.
* On re-clicking, re-use the var's most recent color
    if that's not currently being used elsewhere.
*/

const COLOR_COUNT = 7;

document.addEventListener("click", e=>{
    if(e.target.nodeName == "VAR") {
        highlightSameAlgoVars(e.target);
    }
});

function highlightSameAlgoVars(v) {
    // Find the algorithm container.
    let algoContainer = findAlgoContainer(v);

    // Not highlighting document-global vars,
    // too likely to be unrelated.
    if(algoContainer == null) return;

    const varName = nameFromVar(v);
    if(!v.hasAttribute("data-var-color")) {
        const newColor = chooseHighlightColor(algoContainer, v);
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.setAttribute("data-var-color", newColor);
                el.setAttribute("data-var-last-color", newColor);
            }
        }
    } else {
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.removeAttribute("data-var-color");
            }
        }
    }
}
function findAlgoContainer(el) {
    while(el != document.body) {
        if(el.hasAttribute("data-algorithm")) return el;
        el = el.parentNode;
    }
    return null;
}
function nameFromVar(el) {
    return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
}
function colorCountsFromContainer(container) {
    const namesFromColor = Array.from({length:COLOR_COUNT}, x=>new Set());
    for(let v of container.querySelectorAll("var[data-var-color]")) {
        let color = +v.getAttribute("data-var-color");
        namesFromColor[color].add(nameFromVar(v));
    }

    return namesFromColor.map(x=>x.size);
}
function leastUsedColor(colors) {
    // Find the earliest color with the lowest count.
    let minCount = Infinity;
    let minColor = null;
    for(var i = 0; i < colors.length; i++) {
        if(colors[i] < minCount) {
            minColor = i;
            minCount = colors[i];
        }
    }
    return minColor;
}
function chooseHighlightColor(container, v) {
    const colorCounts = colorCountsFromContainer(container);
    if(v.hasAttribute("data-var-last-color")) {
        let color = +v.getAttribute("data-var-last-color");
        if(colorCounts[color] == 0) return color;
    }
    return leastUsedColor(colorCounts);
}
}
</script>